<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upgrade Canva Pro - Penawaran Spesial!</title>
    <link rel="icon" type="image/svg+xml" href="https://public.canva.site/logo/media/dfb96cc174513093cd6ed61489ccb750.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>

    <!-- === KODE FACEBOOK PIXEL DIMULAI DI SINI === -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '630583642253416');
      fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=630583642253416&ev=PageView&noscript=1"
    /></noscript>
    <!-- === AKHIR DARI KODE FACEBOOK PIXEL === -->

    <style>
        :root {
            /* Canva Color Palette */
            --canva-purple: #8c4dff;
            --canva-purple-dark: #6e3acc;
            --canva-purple-light: #f3eefc;
            --canva-teal: #00c4cc;
            --canva-teal-dark: #00a1a8;
            --canva-gradient: linear-gradient(135deg, var(--canva-purple) 0%, var(--canva-teal) 100%);
            
            /* Grey Palette (Neutral) */
            --grey-50: #f8f9fa;
            --grey-100: #f1f3f4;
            --grey-200: #e8eaed;
            --grey-300: #dadce0;
            --grey-500: #9aa0a6;
            --grey-600: #5f6368;
            --grey-700: #3c4043;
            --grey-900: #202124;

            /* Other Colors */
            --color-green: #137333;
            --color-red: #d93025;
            
            /* Shadows */
            --shadow-1: 0 1px 2px 0 rgba(60,64,67,.3), 0 1px 3px 1px rgba(60,64,67,.15);
            --shadow-2: 0 1px 2px 0 rgba(60,64,67,.3), 0 2px 6px 2px rgba(60,64,67,.15);
            --shadow-3: 0 4px 8px 3px rgba(60,64,67,.15), 0 1px 3px rgba(60,64,67,.3);
        }

        /* Base Typography */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #ffffff; /* Enforced white theme */
            color: var(--grey-700);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            color: var(--grey-900);
        }
        
        .text-canva-purple { color: var(--canva-purple); }
        .bg-canva-purple { background-color: var(--canva-purple); }

        /* Material Design Inspired Components */
        .material-card {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: var(--shadow-1);
            transition: box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--grey-200);
        }
        .material-card:hover { box-shadow: var(--shadow-2); }
        .material-card-elevated { box-shadow: var(--shadow-2); }

        /* Form Inputs */
        .form-input {
            border: 2px solid var(--grey-300);
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 8px;
            padding: 14px 12px;
            width: 100%;
            background-color: #ffffff;
            font-size: 16px;
            color: var(--grey-900);
        }
        .form-input:focus {
            border-color: var(--canva-purple);
            background-color: #ffffff;
            outline: none;
            box-shadow: 0 0 0 1px var(--canva-purple);
        }
        .form-input::placeholder { color: var(--grey-500); }

        /* Buttons */
        .cta-button {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 24px;
            padding: 12px 28px;
            font-size: 15px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            width: 100%;
            border: none;
            min-height: 46px;
        }
        .purple-button {
            background-color: var(--canva-purple);
            color: white;
            box-shadow: var(--shadow-1);
        }
        .purple-button:hover {
            background-color: var(--canva-purple-dark);
            box-shadow: var(--shadow-2);
            transform: translateY(-1px);
        }
        .purple-button:active {
            transform: translateY(0);
            box-shadow: var(--shadow-1);
        }
        .cta-button:disabled {
            background-color: var(--grey-300);
            color: var(--grey-500);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Modal Styling */
        .modal {
            display: none; position: fixed; z-index: 1000;
            left: 0; top: 0; width: 100%; height: 100%;
            overflow: auto; background-color: rgba(32, 33, 36, 0.7);
            justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: #ffffff; margin: auto; padding: 28px;
            width: 90%; max-width: 480px; border-radius: 16px;
            box-shadow: var(--shadow-3); text-align: center; position: relative;
            animation: modalSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        @keyframes modalSlideIn {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .modal-content h3 {
            color: var(--grey-900); margin-bottom: 12px;
            font-size: 18px; font-weight: 600;
        }
        .modal-content p {
            color: var(--grey-600); margin-bottom: 20px;
            line-height: 1.6; font-size: 14px;
        }
        .modal-ok-button {
            background-color: var(--canva-purple); color: white;
            padding: 10px 28px; border: none; border-radius: 24px;
            cursor: pointer; font-size: 14px; font-weight: 500;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1); min-height: 36px;
        }
        .modal-ok-button:hover {
            background-color: var(--canva-purple-dark);
            box-shadow: var(--shadow-1);
        }

        /* Testimonial Section */
        .testimonial-image {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer; border-radius: 12px; overflow: hidden;
        }
        .testimonial-image:hover {
            transform: scale(1.02);
            box-shadow: var(--shadow-2);
        }

        /* Notification Toast */
        .notif-box {
            position: fixed; top: 24px; left: 50%;
            transform: translateX(-50%); background-color: var(--grey-900);
            color: #ffffff; border-radius: 8px; box-shadow: var(--shadow-3);
            padding: 16px 24px; display: none; align-items: center;
            gap: 12px; width: auto; max-width: 400px; z-index: 1000;
            opacity: 0; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .notif-box.show {
            display: flex; opacity: 1;
            animation: slideInAndOut 5s ease-in-out forwards;
        }
        @keyframes slideInAndOut {
            0%, 100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
            10%, 90% { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
        .notif-icon-wrapper { color: var(--canva-teal); font-size: 20px; flex-shrink: 0; }
        .notif-message { font-size: 14px; line-height: 1.4; }
        .notif-message strong { font-weight: 500; }
        .notif-time { font-size: 12px; color: rgba(255, 255, 255, 0.7); margin-top: 2px; }

        /* FAQ Section */
        .faq-item { border-bottom: 1px solid var(--grey-200); }
        .faq-item:last-child { border-bottom: none; }
        .faq-item:hover { background-color: var(--grey-50); }
        .faq-item summary {
            font-weight: 600; font-size: 15px; color: var(--grey-900);
            padding: 16px 12px; cursor: pointer; list-style: none;
            display: flex; justify-content: space-between; align-items: center;
        }
        .faq-item summary::-webkit-details-marker { display: none; }
        .faq-item summary::after {
            content: '\f078'; font-family: 'Font Awesome 6 Free'; font-weight: 900;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--grey-600); font-size: 14px;
        }
        .faq-item[open] summary::after { transform: rotate(180deg); }
        .faq-content {
            padding: 0 12px 16px 12px; color: var(--grey-600);
            line-height: 1.6; font-size: 14px;
        }
        .faq-item[open] summary { color: var(--canva-purple); }

        /* Segmented Control (Updated for 4 items) */
        .segmented-control {
            display: flex; position: relative; background-color: var(--grey-100);
            border-radius: 12px; padding: 4px; width: 100%;
            box-shadow: inset 0 1px 2px rgba(60, 64, 67, 0.1);
        }
        .segmented-control .package-radio {
            position: absolute; opacity: 0; width: 0; height: 0;
        }
        .segmented-control .package-label {
            flex: 1; text-align: center; padding: 10px 8px; cursor: pointer;
            z-index: 2; transition: color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--grey-600); font-size: 13px; font-weight: 600;
            line-height: 1.2; border-radius: 8px;
        }
        .segmented-control .package-radio:checked + .package-label {
            color: var(--grey-900);
        }
        .segmented-control-pill {
            position: absolute; top: 4px; bottom: 4px;
            width: calc((100% - 8px) / 4); /* Adjusted for 4 items */
            background-color: #ffffff; border-radius: 8px;
            box-shadow: var(--shadow-1); z-index: 1;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .segmented-control .package-radio#pkg-1:checked ~ .segmented-control-pill { transform: translateX(0%); }
        .segmented-control .package-radio#pkg-2:checked ~ .segmented-control-pill { transform: translateX(100%); }
        .segmented-control .package-radio#pkg-3:checked ~ .segmented-control-pill { transform: translateX(200%); }
        .segmented-control .package-radio#pkg-4:checked ~ .segmented-control-pill { transform: translateX(300%); }

        /* Product Info Display */
        #product-info-form-top, #features-before-form {
            transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .product-info-card {
            background: var(--canva-purple-light);
            border: 1px solid var(--grey-200);
            border-radius: 16px; padding: 20px;
        }

        /* Payment Method Styles */
        .payment-radio { position: absolute; opacity: 0; width: 0; height: 0; }
        .payment-label {
            display: flex; align-items: center; padding: 12px;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer; border-radius: 12px; /* Increased border-radius */
            margin: 2px;
        }
        .payment-label:hover { background-color: var(--grey-50); }
        .payment-radio:checked + .payment-label {
            background-color: var(--canva-purple-light);
            box-shadow: inset 0 0 0 2px var(--canva-purple);
        }
        .payment-logo-container {
            width: 64px;
            height: 40px;
            background-color: #ffffff;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            padding: 4px;
            border: 1px solid var(--grey-200, #e8eaed);
            flex-shrink: 0;
        }
        .form-payment-logo-container {
            width: 48px;
            height: 32px;
            background-color: #ffffff;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            padding: 4px;
            border: 1px solid var(--grey-200, #e8eaed);
            flex-shrink: 0;
        }
        .payment-logo {
            max-height: 100%;
            max-width: 100%;
            object-fit: contain;
        }
        .custom-radio-button {
            height: 20px; width: 20px; border: 2px solid var(--grey-300);
            border-radius: 50%; display: flex; align-items: center;
            justify-content: center; transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0; margin-left: auto;
        }
        .custom-radio-button .dot {
            height: 8px; width: 8px; border-radius: 50%;
            background-color: transparent;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .payment-radio:checked + .payment-label .custom-radio-button { border-color: var(--canva-purple); }
        .payment-radio:checked + .payment-label .custom-radio-button .dot { background-color: var(--canva-purple); }

        /* Payment Instruction Layout */
        .payment-header {
            background: var(--canva-gradient);
            color: #fff; text-align: center; position: sticky;
            top: 0; z-index: 999;
        }
        .payment-card {
            background-color: #ffffff; border: 1px solid var(--grey-200);
            border-radius: 12px; padding: 16px; margin-top: 12px;
            box-shadow: var(--shadow-1);
        }
        .copy-button-text {
            background: none; border: none; color: var(--canva-purple);
            font-weight: 500; cursor: pointer; padding: 8px;
            border-radius: 4px; transition: background-color 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .copy-button-text:hover { background-color: var(--canva-purple-light); }
        .confirm-button-outlined {
            width: 100%; padding: 12px 24px; border: 2px solid var(--canva-purple);
            color: var(--canva-purple); background-color: transparent;
            border-radius: 24px; font-weight: 500; cursor: pointer;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1); min-height: 48px;
        }
        .confirm-button-outlined:hover {
            background-color: var(--canva-purple-light);
            box-shadow: var(--shadow-1);
        }
        .payment-accordion { border-bottom: 1px solid var(--grey-200); }
        .payment-accordion:last-child { border-bottom: none; }
        .payment-accordion summary {
            font-weight: 500; padding: 14px 0; cursor: pointer;
            list-style: none; display: flex; justify-content: space-between;
            align-items: center;
        }
        .payment-accordion summary::-webkit-details-marker { display: none; }
        .payment-accordion summary::after {
            content: '\f078'; font-family: 'Font Awesome 6 Free'; font-weight: 900;
            transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--grey-600);
        }
        .payment-accordion[open] summary::after { transform: rotate(180deg); }
        .payment-accordion-content {
            padding-bottom: 16px; color: var(--grey-600); line-height: 1.6;
        }
        .payment-accordion-content ol {
            list-style-type: decimal; padding-left: 20px; font-size: 14px;
        }

        /* Countdown Timer Styles */
        .payment-header { padding: 1rem; }
        .payment-header h2 { font-size: 1.125rem; font-weight: 500; color: #ffffff; }
        .countdown-timer { display: flex; justify-content: center; align-items: center; gap: 0.5rem; margin-top: 0.5rem; }
        .countdown-item { display: flex; align-items: center; gap: 0.25rem; }
        .countdown-number {
            background-color: rgba(255,255,255,0.2);
            color: white; padding: 0.25rem 0.5rem; border-radius: 6px;
            font-weight: 600; font-size: 1.1rem; text-align: center;
        }
        @media (max-width: 768px) {
            .payment-header { padding: 0.875rem 1rem; }
            .payment-header h2 { font-size: 1.0625rem; }
            .countdown-timer { margin-top: 0.25rem; }
            .countdown-number { font-size: 0.875rem; padding: 0.15rem 0.4rem; }
            .countdown-item { font-size: 0.75rem; }
        }

        /* Details Modal (Bottom Sheet) */
        #detailsModal { align-items: flex-end; }
        .details-modal-content {
            background-color: #ffffff; width: 100%; max-width: 100%;
            border-radius: 20px 20px 0 0; box-shadow: var(--shadow-3);
            text-align: left; transform: translateY(100%);
        }
        .details-modal-content.is-open { animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        .details-modal-content.is-closing { animation: slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes slideDown { from { transform: translateY(0); } to { transform: translateY(100%); } }
        .details-modal-header {
            padding: 20px 24px; border-bottom: 1px solid var(--grey-200);
            display: flex; justify-content: space-between; align-items: center;
        }
        .details-modal-header h3 { font-size: 18px; font-weight: 600; color: var(--grey-900); }
        .details-modal-close {
            font-size: 24px; font-weight: 400; color: var(--grey-600);
            cursor: pointer; background: none; border: none; padding: 8px;
            border-radius: 50%; transition: background-color 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .details-modal-close:hover { background-color: var(--grey-100); }
        .details-modal-body {
            padding: 20px 24px 32px 24px; max-height: 60vh; overflow-y: auto;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .notif-box {
                left: 16px; right: 16px; top: 16px;
                transform: translateX(0); width: calc(100% - 32px); max-width: none;
            }
            @keyframes slideInAndOut {
                0%, 100% { opacity: 0; transform: translateY(-20px); }
                10%, 90% { opacity: 1; transform: translateY(0); }
            }
            .material-card { border-radius: 16px; margin: 0 4px; }
            .form-input { font-size: 16px; /* Prevent zoom on iOS */ }
        }

        /* Image Modal */
        .modal-image-wrapper { display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .modal-content-image {
            margin: auto; display: block; width: auto; max-width: 90%;
            max-height: 80vh; animation: zoomIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 8px;
            will-change: transform, opacity; /* Performance improvement */
        }
        .close-image-modal-button {
            margin-top: 20px; color: #ffffff; background-color: rgba(0, 0, 0, 0.4);
            border: none; padding: 12px 24px; border-radius: 24px;
            font-size: 14px; font-weight: 500; cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .close-image-modal-button:hover { background-color: rgba(0, 0, 0, 0.6); }
        .modal-nav {
            cursor: pointer; position: absolute; top: 50%; width: auto;
            padding: 20px; margin-top: -22px; color: white; font-weight: bold;
            font-size: 20px; transition: 0.3s; border-radius: 50%;
            user-select: none; -webkit-user-select: none;
            background-color: rgba(0, 0, 0, 0.6); display: none;
            z-index: 10; /* Ensure buttons are on top */
        }
        .modal-nav.prev { left: 20px; }
        .modal-nav.next { right: 20px; }
        .modal-nav:hover { background-color: rgba(0, 0, 0, 0.8); transform: scale(1.1); }
        @keyframes zoomIn { from { transform: scale(0); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* Feature Icons */
        .feature-icon { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .feature-icon:hover { transform: scale(1.1); }

        /* Security Badge */
        .security-badge {
            background: var(--canva-teal); color: white;
            padding: 6px 12px; border-radius: 20px; font-size: 10px;
            font-weight: 500; display: inline-flex; align-items: center; gap: 6px;
        }
        
        /* Smooth Scrolling */
        html { scroll-behavior: smooth; }
    </style>
</head>
<body class="antialiased">

    <div id="payment-instruction-container">
        <!-- Konten akan di-generate oleh JavaScript -->
    </div>
    
    <div class="p-3 sm:p-4 lg:p-8">
        <div id="main-content-container">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-x-12 gap-y-8 max-w-7xl mx-auto">
                <!-- Kolom Kiri: Form & Pembayaran -->
                <div class="lg:col-span-1 material-card p-5 md:p-8">
                    <!-- Header Keamanan -->
                    <div class="grid grid-cols-2 gap-2 text-center border-b border-gray-200 pb-4 mb-6">
                        <div class="flex">
                            <div class="security-badge w-full justify-center">
                                <i class="fas fa-shield-alt text-xs mr-1"></i>
                                TRANSAKSI AMAN
                            </div>
                        </div>
                        <div class="flex">
                            <div class="security-badge w-full justify-center" style="background: var(--canva-purple);">
                                <i class="fas fa-hand-holding-usd text-xs mr-1"></i>
                                GARANSI UANG KEMBALI
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pemilihan Paket (Segmented Control) -->
                    <div class="mb-6">
                        <h2 class="text-lg font-bold mb-4 text-gray-800">1. Pilih Paket Anda</h2>
                        <div id="package-selection">
                            <div class="segmented-control">
                                <input type="radio" id="pkg-1" name="package" value="satuBulan" class="package-radio" checked>
                                <label for="pkg-1" class="package-label">1 Bulan</label>
    
                                <input type="radio" id="pkg-2" name="package" value="enamBulan" class="package-radio">
                                <label for="pkg-2" class="package-label">6 Bulan</label>
    
                                <input type="radio" id="pkg-3" name="package" value="satuTahun" class="package-radio">
                                <label for="pkg-3" class="package-label">1 Tahun</label>

                                <input type="radio" id="pkg-4" name="package" value="lifetime" class="package-radio">
                                <label for="pkg-4" class="package-label">Lifetime</label>
    
                                <div class="segmented-control-pill"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Info Produk -->
                    <div id="product-info-form-top" class="mb-6"></div>

                    <!-- Fitur -->
                    <div id="features-before-form" class="mb-6"></div>

                    <!-- Form -->
                    <form id="orderForm">
                        <h2 class="text-lg font-bold mb-4 text-gray-800">2. Lengkapi Data</h2>
                        <div class="space-y-4">
                            <div>
                                <label for="nama" class="block text-sm font-medium mb-1 text-gray-700">Nama Anda <span class="text-red-500">*</span></label>
                                <input type="text" id="nama" name="nama" class="form-input" placeholder="Masukkan nama lengkap Anda">
                            </div>
                            <div>
                                <label for="whatsapp" class="block text-sm font-medium mb-1 text-gray-700">No. WhatsApp Anda <span class="text-red-500">*</span></label>
                                <input type="tel" id="whatsapp" name="whatsapp" class="form-input" placeholder="Contoh: 081234567890">
                            </div>
                            <div>
                                <label for="email" class="block text-sm font-medium mb-1 text-gray-700">Email Canva Anda <span class="text-red-500">*</span></label>
                                <input type="email" id="email" name="email" class="form-input" placeholder="Email yang terdaftar di Canva">
                            </div>
                        </div>
                        
                        <!-- Honeypot field for anti-spam -->
                        <input type="text" name="honeypot" style="display: none" tabindex="-1" autocomplete="off">

                        <!-- Metode Pembayaran -->
                        <div id="payment-method-selection" class="mt-8"></div>
                        
                        <!-- Rincian Pesanan -->
                        <div id="order-details-in-form" class="mt-8"></div>
                        
                        <button type="button" id="submit-btn" class="cta-button purple-button mt-8">
                            <i class="fas fa-shopping-cart mr-2"></i>
                            Beli Sekarang
                        </button>
                    </form>
                </div>

                <!-- Kolom Kanan: Testimoni, FAQ, Kebijakan -->
                <div class="lg:col-span-1 py-4 space-y-8">
                    <div id="testimonials-full"></div>
                    <div class="material-card p-5 md:p-6">
                        <div id="faq-full"></div>
                    </div>
                    <div class="material-card p-5 md:p-6">
                        <div id="policy-full"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer id="footer" class="text-center mt-12 text-gray-500 text-sm">
            <p>Copyright Â© <span id="currentYear">2025</span> Digital Store ID. Semua Hak Dilindungi.</p>
        </footer>
    </div>

    <!-- Modal for Info/Confirmation -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle"></h3>
            <p id="modalMessage"></p>
            <button class="modal-ok-button" onclick="closeInfoModal()">OK</button>
        </div>
    </div>

    <!-- Modal untuk Zoom Gambar -->
    <div id="imageModal" class="modal">
        <span class="modal-nav prev" onclick="showPrevImage()">&#10094;</span>
        <span class="modal-nav next" onclick="showNextImage()">&#10095;</span>
        <div class="modal-image-wrapper">
            <img class="modal-content-image" id="modalImage">
            <button class="close-image-modal-button" onclick="closeImageModal()">Tutup</button>
        </div>
    </div>
    
    <!-- Modal for Transaction Details -->
    <div id="detailsModal" class="modal">
        <div class="details-modal-content" id="detailsModalContent">
            <!-- Content will be injected by JS -->
        </div>
    </div>

    <!-- Notification Popup -->
    <div class="notif-box" id="notifBox">
        <div class="notif-icon-wrapper"><i class="far fa-check-circle"></i></div>
        <div class="notif-content-area">
             <div class="notif-message">
                 <div><strong class="notif-name">Nama Acak</strong> baru saja membeli!</div>
                 <div class="notif-time">beberapa detik lalu</div>
             </div>
        </div>
    </div>


    <script>
    // --- VALIDATION LOGIC ---
    const operatorPrefixes = {
        'Telkomsel': ['0811', '0812', '0813', '0821', '0822', '0823', '0851', '0852', '0853'],
        'by.U': ['0851'],
        'Indosat Ooredoo': ['0814', '0815', '0816', '0855', '0856', '0857', '0858'],
        'Tri (3)': ['0895', '0896', '0897', '0898', '0899'],
        'XL Axiata': ['0817', '0818', '0819', '0859', '0877', '0878', '0879'],
        'Live.On': ['0859'],
        'Axis': ['0831', '0832', '0833', '0838'],
        'Smartfren': ['0881', '0882', '0883', '0884', '0885', '0886', '0887', '0888', '0889']
    };
    const blacklistedNumbers = ['081234567890'];

    function isInvalidPattern(nomor) {
        if (blacklistedNumbers.includes(nomor)) return true;
        const numberPart = nomor.substring(2);
        if (/(\d)\1{4,}/.test(numberPart)) return true;
        for (let i = 0; i < numberPart.length - 4; i++) {
            const sub = numberPart.substring(i, i + 5);
            const isAscending = '0123456789'.includes(sub);
            const isDescending = '9876543210'.includes(sub);
            if (isAscending || isDescending) return true;
        }
        const uniqueDigits = new Set(numberPart.split(''));
        if (uniqueDigits.size < 4) return true;
        if (/(..)\1\1/.test(numberPart)) return true;
        return false;
    }

    function getOperatorFromNumber(nomor) {
        const prefix = nomor.substring(0, 4);
        for (const operator in operatorPrefixes) {
            if (operatorPrefixes[operator].includes(prefix)) {
                return operator;
            }
        }
        return null;
    }

    function validatePhoneNumber(nomorHp) {
        const genericError = { isValid: false, message: 'Silahkan isi dengan nomor yang benar' };

        if (nomorHp.length < 10) {
            return genericError;
        }

        const operator = getOperatorFromNumber(nomorHp);
        if (!operator) {
            return genericError;
        }

        const maxLength = operator === 'Tri (3)' ? 13 : 12;
        if (nomorHp.length > maxLength) {
            return genericError;
        }

        if (isInvalidPattern(nomorHp)) {
            return genericError;
        }

        return { isValid: true, message: 'Nomor valid.' };
    }
    document.addEventListener('DOMContentLoaded', function() {

        // --- ELEMENTS ---
        const elements = {
            mainContentContainer: document.getElementById('main-content-container'),
            paymentInstructionContainer: document.getElementById('payment-instruction-container'),
            footer: document.getElementById('footer'),
            currentYear: document.getElementById('currentYear'),
            productInfoFormTop: document.getElementById('product-info-form-top'),
            featuresBeforeForm: document.getElementById('features-before-form'),
            paymentMethodSelection: document.getElementById('payment-method-selection'),
            orderDetailsInForm: document.getElementById('order-details-in-form'),
            testimonialsFull: document.getElementById('testimonials-full'),
            faqFull: document.getElementById('faq-full'),
            policyFull: document.getElementById('policy-full'),
            orderForm: document.getElementById('orderForm'),
            submitBtn: document.getElementById('submit-btn'),
            notifBox: document.getElementById('notifBox'),
            notifName: document.querySelector('#notifBox .notif-name'),
            detailsModal: document.getElementById('detailsModal'),
            detailsModalContent: document.getElementById('detailsModalContent'),
        };

        // --- CONFIGURATION ---
        const uniqueCode = Math.floor(Math.random() * (500 - 100 + 1)) + 100;
        let countdownInterval;
        let expiryTime;
        let currentOrderDetails = {};
        
        const allTestimonials = [
            "https://s6.imgcdn.dev/YIh45V.png", "https://s6.imgcdn.dev/YIhuYh.png",
            "https://s6.imgcdn.dev/YIhCOK.png", "https://s6.imgcdn.dev/YIhIgo.png",
            "https://s6.imgcdn.dev/YIhQQO.png", "https://s6.imgcdn.dev/YIhiSn.png",
            "https://s6.imgcdn.dev/YIhkeg.png", "https://s6.imgcdn.dev/YIhscv.png",
            "https://s6.imgcdn.dev/YIhyaN.png", "https://s6.imgcdn.dev/YIh5tq.png",
            "https://s6.imgcdn.dev/YIhPYB.png", "https://s6.imgcdn.dev/YIhTKu.png"
        ];

        const canvaFeatures = [
            "<strong>Jutaan Template Premium:</strong> Akses tak terbatas ke seluruh koleksi template profesional Canva.",
            "<strong>Hapus Latar Belakang Foto:</strong> Hapus background gambar dengan satu klik, sempurna untuk foto produk.",
            "<strong>Magic Resize:</strong> Ubah ukuran desain Anda secara otomatis untuk berbagai platform (IG Post, Story, FB Cover, dll).",
            "<strong>Brand Kit:</strong> Simpan logo, warna, dan font merek Anda untuk konsistensi desain yang mudah.",
            "<strong>100+ Juta Stok Foto & Video:</strong> Gunakan aset premium tanpa batas untuk proyek desain Anda.",
            "<strong>Content Planner:</strong> Jadwalkan postingan media sosial Anda langsung dari Canva.",
            "<strong>Penyimpanan Cloud 1TB:</strong> Simpan semua aset dan desain Anda dengan aman di cloud.",
            "<strong>Aktivasi Cepat & Resmi:</strong> Proses upgrade akun Anda melalui undangan tim resmi.",
            "<strong>Tanpa Gonta-Ganti Tim:</strong> Akun Anda akan berada di satu tim yang stabil selama masa aktif paket, tanpa perlu pindah-pindah."
        ];

        const packages = {
            satuBulan: {
                id: 'satuBulan',
                name: "Canva Pro 1 Bulan",
                price: 29000,
                title: "CANVA PRO",
                priceDisplay: `Rp29.000`,
                logo: 'https://public.canva.site/logo/media/dfb96cc174513093cd6ed61489ccb750.svg',
                description: "Akses penuh fitur Canva Pro selama 1 bulan.",
                features: canvaFeatures,
                testimonials: allTestimonials
            },
            enamBulan: {
                id: 'enamBulan',
                name: "Canva Pro 6 Bulan",
                price: 59000,
                title: "CANVA PRO",
                priceDisplay: `Rp59.000`,
                logo: 'https://public.canva.site/logo/media/dfb96cc174513093cd6ed61489ccb750.svg',
                description: "Lebih hemat dengan paket 6 bulan.",
                features: canvaFeatures,
                testimonials: allTestimonials
            },
            satuTahun: {
                id: 'satuTahun',
                name: "Canva Pro 1 Tahun",
                price: 79000,
                title: "CANVA PRO",
                priceDisplay: `Rp79.000`,
                logo: 'https://public.canva.site/logo/media/dfb96cc174513093cd6ed61489ccb750.svg',
                description: "Paket terbaik untuk penggunaan jangka panjang.",
                features: canvaFeatures,
                testimonials: allTestimonials
            },
            lifetime: {
                id: 'lifetime',
                name: "Canva Pro Lifetime",
                price: 99000,
                title: "CANVA PRO",
                priceDisplay: `Rp99.000`,
                logo: 'https://public.canva.site/logo/media/dfb96cc174513093cd6ed61489ccb750.svg',
                description: "Sekali bayar untuk akses Canva Pro selamanya.",
                features: canvaFeatures,
                testimonials: allTestimonials
            }
        };

        let currentPackageId = 'satuBulan'; // Default package
        
        const paymentAccounts = {
            qris: { displayName: 'QRIS', accountHolder: 'Epay', number: '00020101021126610016ID.CO.SHOPEE.WWW01189360091800223157700208223157700303UMI51440014ID.CO.QRIS.WWW0215ID10254270621910303UMI5204481453033605802ID5904Epay6013JAKARTA PUSAT61051061062070703A0163042F15', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Logo_QRIS.svg/163px-Logo_QRIS.svg.png', type: 'qris', category: 'QRIS' },
            cimb: { displayName: 'Cimb Niaga', accountHolder: 'Octo Pay - 6289510639366', number: '6289510639366', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/CIMB_Niaga_logo.svg/330px-CIMB_Niaga_logo.svg.png', type: 'va', category: 'Bank Transfer' },
            bca_va: { displayName: 'BCA Virtual Account', accountHolder: 'Epayment', number: '39358089510639366', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/330px-Bank_Central_Asia.svg.png', type: 'va', category: 'Bank Transfer' },
            gopay: { displayName: 'Gopay', accountHolder: 'Gopay 6289510639366', number: '089510639366', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Gopay_logo.svg/320px-Gopay_logo.svg.png', type: 'ewallet', category: 'E-Wallet' },
            dana: { displayName: 'DANA', accountHolder: 'DNID089510639366', number: '089510639366', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Logo_dana_blue.svg/330px-Logo_dana_blue.svg.png', type: 'ewallet', category: 'E-Wallet' },
            ovo: { displayName: 'OVO', accountHolder: 'OVO Epayment', number: '089510639366', logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Logo_ovo_purple.svg/330px-Logo_ovo_purple.svg.png', type: 'ewallet', category: 'E-Wallet' }
        };

        // --- TEMPLATE FUNCTIONS ---
        const getProductInfoHTML = (pkg) => `
        <div class="product-info-card">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                <div class="text-center mb-4 md:mb-0 flex-grow">
                    <div class="flex justify-center"><img alt="Logo ${pkg.name}" class="h-12 w-auto" src="${pkg.logo}"></div>
                    <h1 class="text-2xl font-bold text-gray-800 mt-3">${pkg.title}</h1>
                    <p class="text-md text-gray-600 mt-1">${pkg.description}</p>
                </div>
                <div class="text-center md:text-right mt-4 md:mt-0 md:pl-6">
                    <div class="text-4xl font-bold text-canva-purple">${pkg.priceDisplay}</div>
                    <div class="mt-2">
                        <span class="inline-block bg-purple-100 text-purple-800 text-xs px-3 py-1 rounded-full">
                            <i class="fas fa-star mr-1"></i>
                            Akses Fitur Pro
                        </span>
                    </div>
                </div>
            </div>
        </div>`;

        const getFeaturesHTML = (pkg) => {
            const colors = ['text-purple-500', 'text-teal-500', 'text-pink-500', 'text-blue-500', 'text-red-500', 'text-indigo-500', 'text-yellow-500', 'text-green-500', 'text-orange-500', 'text-cyan-500'];
            return `<div class="material-card-elevated p-4 md:p-6 rounded-2xl">
                <h3 class="text-xl font-bold mb-4 text-gray-800 text-center">Yang Anda Dapatkan:</h3>
                <ul class="space-y-3">${pkg.features.map((f, index) => `<li class="flex items-start"><i class="fas fa-check-circle ${colors[index % colors.length]} mt-1 mr-3 text-lg feature-icon"></i><span class="text-gray-600 text-sm leading-relaxed">${f}</span></li>`).join('')}</ul>
            </div>`;
        }
        
        const getPaymentMethodsHTML = (accounts) => {
            const groupedAccounts = {};
            for (const key in accounts) {
                const account = accounts[key];
                if (!groupedAccounts[account.category]) {
                    groupedAccounts[account.category] = [];
                }
                groupedAccounts[account.category].push({ key, ...account });
            }

            let html = `<h2 class="text-lg font-bold mb-4 text-gray-800">3. Pilih Metode Pembayaran</h2>`;
            const categoryOrder = ['QRIS', 'Bank Transfer', 'E-Wallet'];

            for (const category of categoryOrder) {
                if (groupedAccounts[category]) {
                    html += `<h3 class="text-md font-semibold text-gray-700 mt-6 mb-2">${category}</h3>`;
                    html += `<div class="material-card rounded-xl payment-group">`;

                    groupedAccounts[category].forEach((account, index) => {
                        const isFirst = index === 0 && category === 'QRIS';
                        const isLast = index === groupedAccounts[category].length - 1;
                        const borderClass = isLast ? '' : 'border-b border-gray-200';
                        html += `
                            <div class="${borderClass}">
                                <input type="radio" id="${account.key}" name="payment-method" value="${account.key}" class="payment-radio" ${isFirst ? 'checked' : ''}>
                                <label for="${account.key}" class="payment-label">
                                    <div class="form-payment-logo-container">
                                        <img src="${account.logo}" alt="Logo ${account.displayName}" class="payment-logo">
                                    </div>
                                    <span class="font-medium text-gray-800 flex-grow text-sm">${account.displayName}</span>
                                    <span class="custom-radio-button"><span class="dot"></span></span>
                                </label>
                            </div>
                        `;
                    });
                    html += `</div>`;
                }
            }

            html += `
                <div class="bg-gray-50 p-3 mt-4 rounded-xl text-center text-xs text-gray-600">
                    <i class="fas fa-shield-alt text-green-600 mr-2"></i>
                    Pembayaran aman dan terenkripsi.
                </div>
            `;
            return html;
        };

        const getOrderDetailsHTML = (pkg, totalPrice) => `
            <div class="mt-8 pt-6 border-t border-gray-200">
                 <h3 class="text-lg font-bold mb-4 text-gray-800">Rincian Pesanan</h3>
                 <div class="material-card-elevated p-4 rounded-2xl space-y-3 text-gray-600">
                      <div class="flex justify-between items-center">
                           <span class="text-sm">${pkg.name}</span>
                           <div class="text-right">
                                <span class="font-semibold text-gray-800 text-md">${formatCurrency(pkg.price)}</span>
                           </div>
                      </div>
                      <div class="flex justify-between">
                           <span class="text-xs">Kode Unik</span>
                           <span class="font-medium text-gray-800 text-sm">${formatCurrency(uniqueCode)}</span>
                      </div>
                      <hr class="my-2 border-gray-200">
                      <div class="flex justify-between font-bold text-lg">
                           <span>Total</span>
                           <span class="text-canva-purple">${formatCurrency(totalPrice)}</span>
                      </div>
                 </div>
            </div>`;

        const getTestimonialsHTML = (pkg) => {
            let imagesHTML = pkg.testimonials.map((url, index) => `
                <img src="${url}" alt="Testimoni Pelanggan ${index + 1}" class="testimonial-image w-full h-auto object-cover aspect-[3/4]" loading="lazy" onclick="openImageModal(event, ${index})" onerror="this.onerror=null;this.src='https://placehold.co/300x400/e2e8f0/4a5568?text=Gagal\\nMuat';">
            `).join('');

            return `
            <div class="material-card p-4 md:p-6 rounded-2xl">
                <h2 class="text-2xl font-bold text-center mb-4 text-gray-800">Testimoni Pelanggan</h2>
                <p class="text-center text-gray-600 text-sm mb-6">Ribuan pelanggan telah merasakan kemudahan desain dengan Canva Pro.</p>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3">
                    ${imagesHTML}
                </div>
            </div>`;
        }

        const getFaqHTML = () => `
            <div>
                <h3 class="text-2xl font-bold mb-4 text-center text-gray-800">Pertanyaan Umum (FAQ)</h3>
                <div class="space-y-1">
                    <details class="faq-item">
                        <summary>Bagaimana proses aktivasinya?</summary>
                        <div class="faq-content">Sangat mudah. Setelah pembayaran, kami akan mengirimkan undangan (invitation) ke email Canva Anda untuk bergabung dengan Tim Pro kami. Anda hanya perlu menerima undangan tersebut, dan akun Anda akan otomatis ter-upgrade ke Pro.</div>
                    </details>
                    <details class="faq-item">
                        <summary>Apakah ini aman dan legal?</summary>
                        <div class="faq-content">Tentu saja. Metode yang kami gunakan adalah 100% legal melalui fitur Canva for Teams. Kami tidak pernah meminta password Anda, hanya alamat email saja. Privasi desain Anda sepenuhnya terjamin.</div>
                    </details>
                    <details class="faq-item">
                        <summary>Apakah saya menggunakan akun pribadi saya?</summary>
                        <div class="faq-content">Ya, upgrade dilakukan langsung pada akun Canva yang sudah Anda miliki. Semua desain, folder, dan aset yang sudah ada akan tetap aman dan bisa diakses.</div>
                    </details>
                    <details class="faq-item">
                        <summary>Apakah timnya akan sering berganti?</summary>
                        <div class="faq-content">Tidak. Kami menjamin akun Anda akan berada di dalam satu tim yang sama selama durasi paket yang Anda pilih. Anda tidak perlu khawatir harus memindahkan desain atau kehilangan akses secara tiba-tiba.</div>
                    </details>
                    <details class="faq-item">
                        <summary>Apa bedanya dengan langganan langsung di Canva?</summary>
                        <div class="faq-content">Secara fitur, tidak ada bedanya. Anda mendapatkan semua fitur Canva Pro. Perbedaannya adalah kami menawarkan harga yang jauh lebih terjangkau melalui lisensi tim.</div>
                    </details>
                    <details class="faq-item">
                        <summary>Berapa lama proses aktivasinya?</summary>
                        <div class="faq-content">Prosesnya sangat cepat. Setelah Anda melakukan konfirmasi pembayaran, undangan akan dikirim dan aktivasi biasanya selesai dalam waktu 5-15 menit (maksimal 1x24 jam).</div>
                    </details>
                    <details class="faq-item">
                        <summary>Apakah ada garansi?</summary>
                        <div class="faq-content">Kami memberikan garansi penuh selama durasi paket yang Anda pilih. Jika terjadi masalah pada akun Pro Anda yang disebabkan oleh sistem kami, kami akan memperbaikinya atau memberikan garansi uang kembali.</div>
                    </details>
                </div>
            </div>
        `;
        
        const getPolicyHTML = () => `
            <div>
                <h3 class="text-2xl font-bold mb-4 text-center text-gray-800">Syarat & Ketentuan</h3>
                <div class="grid md:grid-cols-1 gap-6 text-sm text-gray-600">
                    <div>
                        <p class="mb-4 text-sm leading-relaxed">Layanan ini adalah untuk upgrade akun Canva Pro melalui sistem tim. Dilarang menggunakan akun untuk aktivitas yang melanggar kebijakan Canva. Garansi berlaku sesuai durasi paket yang dibeli.</p>
                    </div>
                </div>
            </div>
        `;

        // --- FUNCTIONS ---
        function formatCurrency(value) {
            return `Rp${value.toLocaleString('id-ID', { minimumFractionDigits: 0 })}`;
        }

        function getIndonesianTimezone() {
            const offset = new Date().getTimezoneOffset() / -60;
            if (offset === 7) return 'WIB';
            if (offset === 8) return 'WITA';
            if (offset === 9) return 'WIT';
            return `GMT${offset > 0 ? '+' : ''}${offset}`;
        }

        function updateDisplay() {
            const pkg = packages[currentPackageId];
            const totalPrice = pkg.price + uniqueCode;

            const infoContainer = elements.productInfoFormTop;
            const featuresContainer = elements.featuresBeforeForm;

            infoContainer.style.opacity = '0';
            featuresContainer.style.opacity = '0';

            setTimeout(() => {
                infoContainer.innerHTML = getProductInfoHTML(pkg);
                featuresContainer.innerHTML = getFeaturesHTML(pkg);
                elements.paymentMethodSelection.innerHTML = getPaymentMethodsHTML(paymentAccounts);
                elements.orderDetailsInForm.innerHTML = getOrderDetailsHTML(pkg, totalPrice);
                elements.testimonialsFull.innerHTML = getTestimonialsHTML(pkg);
                elements.faqFull.innerHTML = getFaqHTML();
                elements.policyFull.innerHTML = getPolicyHTML();
                infoContainer.style.opacity = '1';
                featuresContainer.style.opacity = '1';
            }, 300);
        }

        function generateWaLink(formData, pkg, totalPrice, paymentMethodName, paymentId) {
            const pesanWA = `Halo, saya ingin konfirmasi pembayaran untuk pesanan:\n\n` +
                          `*ID Pembayaran:* ${paymentId}\n` +
                          `*Paket:* ${pkg.name}\n` +
                          `*Metode Pembayaran:* ${paymentMethodName}\n` +
                          `*Nama:* ${formData.get('nama')}\n` +
                          `*No. WhatsApp:* ${formData.get('whatsapp')}\n` +
                          `*Email Canva:* ${formData.get('email')}\n` +
                          `*Total Transfer:* ${formatCurrency(totalPrice)}\n\n` +
                          `Saya sudah melakukan transfer. Mohon untuk segera diproses. Terima kasih.`;
            return `https://wa.me/6285602152097?text=${encodeURIComponent(pesanWA)}`;
        }

        function showPaymentInstructions(formData, pkg, totalPrice, paymentAccount, paymentId, paymentMethodKey) {
            window.scrollTo(0, 0);
            
            currentOrderDetails = {
                pkg, totalPrice, paymentId,
                nama: formData.get('nama'),
                whatsapp: formData.get('whatsapp')
            };

            elements.mainContentContainer.parentElement.style.display = 'none';
            elements.footer.style.display = 'none';
            
            const waLink = generateWaLink(formData, pkg, totalPrice, paymentAccount.displayName, paymentId);
            
            let accountLabel;
            switch (paymentMethodKey) {
                case 'cimb':
                    accountLabel = 'Nomor Rekening';
                    break;
                case 'bca_va':
                    accountLabel = 'Nomor Virtual Account';
                    break;
                case 'gopay':
                case 'dana':
                case 'ovo':
                    accountLabel = 'Nomor E-Wallet';
                    break;
                default:
                    accountLabel = 'Nomor Pembayaran';
            }

            let instructionAccordionHTML = '';
            let paymentDetailsBlock = '';
            let paymentDeadlineFormatted = '';

            expiryTime = new Date(new Date().getTime() + 24 * 60 * 60 * 1000);
            
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const datePart = expiryTime.toLocaleDateString('id-ID', dateOptions);
            const timeOptions = { hour: '2-digit', minute: '2-digit', hour12: false };
            const timePart = expiryTime.toLocaleTimeString('id-ID', timeOptions).replace(/\./g, ':');
            paymentDeadlineFormatted = `${datePart} pukul ${timePart} (${getIndonesianTimezone()})`;

            if (paymentMethodKey === 'qris') {
                paymentDetailsBlock = `
                    <div class="text-center">
                        <div id="qrcodeContainer" class="bg-white p-3 rounded-xl border-2 border-gray-200 w-full max-w-[250px] h-auto mx-auto my-4 material-card-elevated">
                            <div id="qrcode" class="flex justify-center items-center"></div>
                        </div>
                        <button id="downloadQrisButton" class="cta-button purple-button max-w-xs mx-auto">
                            <i class="fas fa-download mr-2"></i> Unduh QRIS
                        </button>
                        <p class="text-center text-xs text-gray-600 mt-3">Pindai QR Code di atas menggunakan aplikasi perbankan atau e-wallet Anda.</p>
                    </div>`;
            } else {
                 paymentDetailsBlock = `
                    <div class="mt-4">
                        <p class="text-xs text-gray-500 mb-1">${accountLabel}</p>
                        <div class="flex justify-between items-center bg-gray-50 p-3 rounded-lg">
                            <p class="text-xl font-bold text-gray-800 tracking-wider">${paymentAccount.number}</p>
                            <button onclick="copyToClipboard('${paymentAccount.number}', '${accountLabel}')" class="copy-button-text">
                                <i class="far fa-copy mr-1"></i> Salin
                            </button>
                        </div>
                    </div>`;
            }

            // Payment Instructions (Accordion)
            switch (paymentMethodKey) {
                case 'qris': instructionAccordionHTML = `<details class="payment-accordion" open><summary>Cara Bayar via QRIS</summary><div class="payment-accordion-content"><ol class="space-y-3"><li>Buka aplikasi m-banking atau e-wallet Anda.</li><li>Pilih menu <strong>Bayar</strong> atau <strong>Scan QRIS</strong>.</li><li>Pindai kode QR di atas.</li><li>Pastikan nama merchant dan nominal pembayaran sudah sesuai.</li><li>Masukkan PIN Anda untuk menyelesaikan transaksi.</li></ol></div></details>`; break;
                case 'bca_va': instructionAccordionHTML = `<details class="payment-accordion"><summary>BCA Mobile</summary><div class="payment-accordion-content"><ol class="space-y-2"><li>Buka BCA Mobile, pilih <strong>m-Transfer</strong> > <strong>BCA Virtual Account</strong>.</li><li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li><li>Masukkan nominal transfer sesuai total tagihan.</li><li>Periksa detail transaksi, lalu masukkan PIN m-BCA.</li></ol></div></details>`; break;
                default: instructionAccordionHTML = `<details class="payment-accordion" open><summary>Instruksi Umum</summary><div class="payment-accordion-content"><ol class="space-y-2"><li>Buka aplikasi perbankan atau e-wallet Anda.</li><li>Pilih menu transfer.</li><li>Masukkan detail pembayaran yang tertera.</li><li>Pastikan nominal transfer sesuai dengan total pembayaran hingga digit terakhir.</li><li>Selesaikan transaksi dan simpan bukti pembayaran.</li></ol></div></details>`;
            }

            const paymentViewHTML = `
                <div class="payment-header">
                    <h2>Selesaikan Pembayaran</h2>
                    <div class="countdown-timer" id="countdown-timer-display"></div>
                </div>
                <div class="max-w-lg mx-auto">
                    <div class="p-2 sm:p-4">
                        <div class="payment-card">
                            <h3 class="font-bold text-lg mb-1">Ringkasan Transaksi</h3>
                            <div class="flex justify-between items-center mt-2 text-xs text-gray-600">
                                <span>Nomor Invoice: <strong>${paymentId}</strong></span>
                                <a href="#" onclick="showDetailsModal(event)" class="font-semibold text-canva-purple">Lihat detail</a>
                            </div>
                            <hr class="my-4">
                            <p class="text-xs text-gray-600 mb-1">Total Pembayaran</p>
                            <div class="flex items-center justify-between">
                                <p class="text-2xl font-bold text-canva-purple">${formatCurrency(totalPrice)}</p>
                                <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="copy-button-text">
                                    <i class="far fa-copy mr-1"></i> Salin
                                </button>
                            </div>
                        </div>
                        <div class="payment-card">
                            <h3 class="font-bold text-lg mb-3">Silakan Bayar ke</h3>
                            <div class="flex justify-between items-start mt-3">
                                <div>
                                    <p class="text-sm text-gray-500">${paymentAccount.displayName}</p>
                                    <p class="font-semibold text-gray-800 text-md">${paymentAccount.accountHolder}</p>
                                </div>
                                <div class="payment-logo-container">
                                    <img src="${paymentAccount.logo}" alt="Logo ${paymentAccount.displayName}" class="payment-logo">
                                </div>
                            </div>
                            ${paymentDetailsBlock}
                            <div class="mt-6">
                                <p class="text-xs text-gray-500 mb-1">Bayar Sebelum</p>
                                <p class="font-semibold text-gray-800 text-sm">${paymentDeadlineFormatted}</p>
                            </div>
                            <a href="${waLink}" target="_blank" class="block mt-6">
                               <button class="confirm-button-outlined">
                                   <i class="fab fa-whatsapp mr-2"></i> Konfirmasi Pembayaran
                               </button>
                            </a>
                        </div>
                        <div class="payment-card">
                            <h3 class="font-bold text-lg mb-2">Cara Membayar</h3>
                            <div class="mt-2">${instructionAccordionHTML}</div>
                        </div>
                    </div>
                </div>
            `;
            elements.paymentInstructionContainer.innerHTML = paymentViewHTML;
            startCountdown();

            if (paymentMethodKey === 'qris') {
                setTimeout(() => {
                    const qrcodeContainer = document.getElementById('qrcode');
                    if(qrcodeContainer) {
                        try {
                            const qrisStatic = paymentAccount.number;
                            const qrisDinamis = createDynamicQrisString(qrisStatic, { nominal: totalPrice });
                            qrcodeContainer.innerHTML = '';
                            QRCode.toCanvas(qrisDinamis, { width: 250, margin: 1, errorCorrectionLevel: 'H' }, (err, canvas) => {
                                if (err) { throw err; }
                                canvas.style.width = "100%"; canvas.style.height = "auto"; canvas.style.borderRadius = "8px";
                                qrcodeContainer.appendChild(canvas);
                                document.getElementById('downloadQrisButton').addEventListener('click', () => {
                                    const link = document.createElement('a');
                                    link.download = `QRIS-${paymentId}.png`;
                                    link.href = canvas.toDataURL("image/png");
                                    link.click();
                                });
                            });
                        } catch (e) {
                            console.error("QRIS Generation Error:", e.message);
                            qrcodeContainer.innerHTML = `<p class="text-red-500 text-sm">Gagal membuat QR Code.</p>`;
                        }
                    }
                }, 100);
            }
        }

        async function handleFormSubmit() {
            // 1. Mengambil semua data dari form
            const formData = new FormData(elements.orderForm);
            const nama = formData.get('nama').trim();
            const whatsapp = formData.get('whatsapp').trim();
            const email = formData.get('email').trim();
            const paymentMethodKey = formData.get('payment-method');
        
            // Validasi input dasar
            if (!nama || !whatsapp || !email || !paymentMethodKey) {
                showInfoModal('Data Belum Lengkap', 'Mohon lengkapi semua data yang diperlukan sebelum melanjutkan.');
                return;
            }

            // --- New Validation Rules ---
            if (!email.endsWith('@gmail.com')) {
                showInfoModal('Email Tidak Valid', 'Harap gunakan alamat email Gmail yang valid (diakhiri dengan @gmail.com).');
                return;
            }

            const phoneValidationResult = validatePhoneNumber(whatsapp);
            if (!phoneValidationResult.isValid) {
                showInfoModal('Nomor WhatsApp Tidak Valid', phoneValidationResult.message);
                return;
            }
        
            // Menonaktifkan tombol untuk mencegah klik ganda
            elements.submitBtn.disabled = true;
            elements.submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Memproses...';
        
            // 2. Menyiapkan detail pesanan
            const pkg = packages[currentPackageId];
            const totalPrice = pkg.price + uniqueCode;
            const paymentAccount = paymentAccounts[paymentMethodKey];
            const now = new Date();
            const paymentId = `INV-CNV-${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}${String(totalPrice).slice(-3)}`;
        
            let submissionSuccess = false;
            try {
                // Construct the follow-up message with bolding
                let paymentDetailsForWa = `\n*- Metode:* ${paymentAccount.displayName}`;
                // Hapus nomor/data QRIS dari pesan WA
                if (paymentMethodKey !== 'qris') {
                    paymentDetailsForWa += `\n*- Nomor:* ${paymentAccount.number}`;
                }
                paymentDetailsForWa += (paymentAccount.accountHolder ? `\n*- Atas Nama:* ${paymentAccount.accountHolder}` : ``);
        
                const followUpMessage = `Halo kak ${nama},\n\nTerima kasih telah memesan *${pkg.name}*.\n\nBerikut adalah rincian pembayaran untuk pesanan Anda:\n- Nomor Invoice: ${paymentId}\n- Total Pembayaran: *${formatCurrency(totalPrice)}*\n\nMohon segera selesaikan pembayaran Anda. Rinciannya adalah sebagai berikut:${paymentDetailsForWa}\n\n*Penting:* Mohon transfer sesuai dengan jumlah total di atas (termasuk kode unik) agar pesanan Anda dapat kami proses secara otomatis.\n\nSetelah transfer, silakan balas pesan ini untuk konfirmasi.\n\nTerima kasih`;
                
                // Format WhatsApp number
                const formattedWhatsapp = whatsapp.startsWith('0') ? '62' + whatsapp.substring(1) : whatsapp;
                const followUpLink = `https://wa.me/${formattedWhatsapp}?text=${encodeURIComponent(followUpMessage)}`;
        
                const formDataForStaticForms = {
                    apiKey: 'sf_195b5fj92dge8l9b391mng1g',
                    replyTo: email,
                    honeypot: formData.get('honeypot'),
                    name: nama,
                    email: email,
                    whatsapp: whatsapp,
                    '$Nomor Invoice': paymentId,
                    '$Produk': pkg.name,
                    '$Metode Pembayaran': paymentAccount.displayName,
                    '$Total Transfer': formatCurrency(totalPrice),
                    '$Link Follow Up WA': followUpLink // Add the follow-up link
                };
        
                const response = await fetch('https://api.staticforms.xyz/submit', {
                    method: 'POST',
                    body: JSON.stringify(formDataForStaticForms),
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (response.ok) {
                    submissionSuccess = true;
                } else {
                    console.error("Static Forms server error:", response.status, await response.text());
                }
        
            } catch (e) {
                console.error("Network error during form submission:", e);
            }
        
            // 6. Menampilkan halaman selanjutnya berdasarkan hasil pengiriman
            if (submissionSuccess) {
                // Jika berhasil, tampilkan halaman instruksi pembayaran
                showPaymentInstructions(formData, pkg, totalPrice, paymentAccount, paymentId, paymentMethodKey);
            } else {
                // Jika gagal, tampilkan pesan error dan aktifkan kembali tombol
                showInfoModal('Pengiriman Gagal', 'Maaf, terjadi kesalahan saat mengirim data Anda. Silakan coba lagi.');
                elements.submitBtn.disabled = false;
                elements.submitBtn.innerHTML = '<i class="fas fa-shopping-cart mr-2"></i> Beli Sekarang';
            }
        }
        
        function startCountdown() {
            const countdownElement = document.getElementById('countdown-timer-display');
            if (!countdownElement || !expiryTime) return;

            const interval = setInterval(() => {
                const now = new Date().getTime();
                const distance = expiryTime - now;

                if (distance < 0) {
                    clearInterval(interval);
                    countdownElement.innerHTML = "Waktu Habis";
                    return;
                }

                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                countdownElement.innerHTML = `
                    <div class="countdown-item"><span class="countdown-number">${String(hours).padStart(2, '0')}</span> Jam</div>
                    <div class="countdown-item"><span class="countdown-number">${String(minutes).padStart(2, '0')}</span> Menit</div>
                    <div class="countdown-item"><span class="countdown-number">${String(seconds).padStart(2, '0')}</span> Detik</div>
                `;
            }, 1000);
        }

        // --- NOTIFICATION FUNCTIONS ---
        const FIRST_NAMES = [ "Budi", "Ayu", "Rahmat", "Citra", "Bayu", "Lina", "Wulan", "Adi", "Farhan", "Hendra", "Nana", "Joko", "Mega", "Gilang", "Sari", "Dedi", "Eka", "Teguh", "Putri", "Andi" ];
        function getRandomElement(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
        function generateRandomName() { return `${getRandomElement(FIRST_NAMES)}`; }
        
        function showNextNotification() {
            if (!elements.notifBox || !elements.notifName) return;
            elements.notifName.textContent = generateRandomName();
            elements.notifBox.classList.remove('show');
            void elements.notifBox.offsetWidth; // Trigger reflow
            elements.notifBox.classList.add('show');
        }

        function scheduleNextNotification() {
            const randomDelay = Math.floor(Math.random() * 10000) + 8000;
            setTimeout(() => {
                showNextNotification();
                scheduleNextNotification();
            }, randomDelay);
        }

        // --- INITIALIZATION ---
        elements.currentYear.textContent = new Date().getFullYear();
        elements.submitBtn.addEventListener('click', handleFormSubmit);

        document.querySelectorAll('input[name="package"]').forEach(radio => {
            radio.addEventListener('change', (event) => {
                currentPackageId = event.target.value;
                updateDisplay();
            });
        });

        updateDisplay();
        
        if (elements.notifBox && elements.notifName) {
            setTimeout(scheduleNextNotification, 6000);
        }
        
        // --- DETAILS MODAL LOGIC ---
        function getDetailsModalHTML(details) {
            const { pkg, totalPrice, paymentId, nama, whatsapp } = details;
            return `
                <div class="details-modal-header">
                    <h3>Ringkasan Transaksi</h3>
                    <button class="details-modal-close" onclick="closeDetailsModal()">&times;</button>
                </div>
                <div class="details-modal-body">
                    <p class="text-sm text-gray-500 mb-6">Nomor Invoice: <strong>${paymentId}</strong></p>
                    <div class="text-center mb-8">
                        <p class="text-sm text-gray-600 mb-2">Total Pembayaran</p>
                        <div class="flex items-center justify-center">
                            <p class="text-4xl font-bold text-canva-purple">${formatCurrency(totalPrice)}</p>
                            <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="copy-button-text"><i class="far fa-copy"></i></button>
                        </div>
                    </div>
                    <div class="space-y-4 border-t border-b border-gray-200 py-6 mb-6">
                        <div>
                            <div class="flex justify-between text-base">
                                <span>${pkg.name}</span>
                                <span class="font-semibold text-gray-800">${formatCurrency(pkg.price)}</span>
                            </div>
                        </div>
                         <div class="flex justify-between text-sm">
                            <span class="text-gray-500">Kode Unik</span>
                            <span class="font-medium">${formatCurrency(uniqueCode)}</span>
                        </div>
                    </div>
                    <div class="space-y-3 mb-8">
                        <div class="flex justify-between font-bold text-xl">
                            <span>Total Pembayaran</span>
                            <span class="text-canva-purple">${formatCurrency(totalPrice)}</span>
                        </div>
                    </div>
                    <div class="border-t border-gray-200 pt-6">
                        <h4 class="font-semibold mb-4">Informasi Pelanggan</h4>
                        <div class="grid grid-cols-2 gap-6">
                            <div>
                                <p class="text-gray-500 text-sm mb-1">Nama</p>
                                <p class="font-medium">${nama}</p>
                            </div>
                            <div>
                                <p class="text-gray-500 text-sm mb-1">Nomor Telepon</p>
                                <p class="font-medium">${whatsapp}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        window.showDetailsModal = function(event) {
            event.preventDefault();
            elements.detailsModalContent.innerHTML = getDetailsModalHTML(currentOrderDetails);
            elements.detailsModal.style.display = 'flex';
            elements.detailsModalContent.classList.remove('is-closing');
            elements.detailsModalContent.classList.add('is-open');
        }

        window.closeDetailsModal = function() {
            elements.detailsModalContent.classList.remove('is-open');
            elements.detailsModalContent.classList.add('is-closing');
            setTimeout(() => {
                elements.detailsModal.style.display = 'none';
            }, 300);
        }
    });

    // --- GLOBAL HELPER FUNCTIONS ---
    const infoModal = document.getElementById('infoModal');
    function showInfoModal(title, message) {
        if (!infoModal) return;
        infoModal.querySelector('#modalTitle').textContent = title;
        infoModal.querySelector('#modalMessage').textContent = message;
        infoModal.style.display = 'flex';
    }
    function closeInfoModal() {
        if (!infoModal) return;
        infoModal.style.display = 'none';
    }

    window.onclick = function(event) {
        if (event.target == infoModal) { closeInfoModal(); }
        if (event.target == document.getElementById('detailsModal')) { closeDetailsModal(); }
        if (event.target == document.getElementById('imageModal')) { closeImageModal(); }
    }

    function copyToClipboard(text, entityName) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            showInfoModal('Berhasil Disalin!', `${entityName} telah disalin ke clipboard.`);
        } catch (err) {
            showInfoModal('Gagal!', 'Gagal menyalin. Silakan coba secara manual.');
        }
        document.body.removeChild(textArea);
    }

    // --- QRIS LOGIC ---
    function toCRC16(input) {
        let crc = 0xFFFF;
        for (let i = 0; i < input.length; i++) {
            crc ^= input.charCodeAt(i) << 8;
            for (let j = 0; j < 8; j++) {
                crc = crc & 0x8000 ? (crc << 1) ^ 0x1021 : crc << 1;
            }
        }
        return (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
    }

    function createDynamicQrisString(qris, { nominal }) {
        if (!qris || nominal === undefined) throw new Error('Parameter tidak lengkap.');
        let qrisModified = qris.slice(0, -4).replace("010211", "010212");
        const nominalStr = String(Math.round(nominal));
        const amountLength = nominalStr.length.toString().padStart(2, '0');
        const amountPart = "54" + amountLength + nominalStr;
        if (!qrisModified.includes("5802ID")) throw new Error("Format QRIS tidak dikenali.");
        let finalQris = qrisModified.replace("5802ID", amountPart + "5802ID");
        const crc = toCRC16(finalQris);
        return finalQris + crc;
    }
    
    // --- Image Modal Functions ---
    const imageModal = document.getElementById('imageModal');
    const modalImg = document.getElementById("modalImage");
    let currentImageIndex;
    const testimonialImages = [
        "https://s6.imgcdn.dev/YIh45V.png", "https://s6.imgcdn.dev/YIhuYh.png",
        "https://s6.imgcdn.dev/YIhCOK.png", "https://s6.imgcdn.dev/YIhIgo.png",
        "https://s6.imgcdn.dev/YIhQQO.png", "https://s6.imgcdn.dev/YIhiSn.png",
        "https://s6.imgcdn.dev/YIhkeg.png", "https://s6.imgcdn.dev/YIhscv.png",
        "https://s6.imgcdn.dev/YIhyaN.png", "https://s6.imgcdn.dev/YIh5tq.png",
        "https://s6.imgcdn.dev/YIhPYB.png", "https://s6.imgcdn.dev/YIhTKu.png"
    ];

    window.openImageModal = function(event, index) {
        event.stopPropagation();
        imageModal.style.display = "flex";
        showImage(index);
    }
    window.closeImageModal = function() { imageModal.style.display = "none"; }
    function showImage(index) {
        if (index >= testimonialImages.length || index < 0) return;
        currentImageIndex = index;
        modalImg.src = testimonialImages[index];
        document.querySelector('.modal-nav.prev').style.display = (index > 0) ? 'block' : 'none';
        document.querySelector('.modal-nav.next').style.display = (index < testimonialImages.length - 1) ? 'block' : 'none';
    }
    window.showNextImage = function() { showImage(currentImageIndex + 1); }
    window.showPrevImage = function() { showImage(currentImageIndex - 1); }

    document.addEventListener('keydown', function(event) {
        if (imageModal.style.display === 'flex') {
            if (event.key === 'ArrowRight') showNextImage();
            else if (event.key === 'ArrowLeft') showPrevImage();
            else if (event.key === 'Escape') closeImageModal();
        }
    });

    </script>

</body>
</html>
