<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upgrade Google Drive & Photos Unlimited - Penawaran Spesial!</title>
    <link rel="icon" type="image/png"
        href="https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Google_Drive_icon_%282020%29.svg/330px-Google_Drive_icon_%282020%29.svg.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>

    <!-- === KODE FACEBOOK PIXEL DIMULAI DI SINI === -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                    n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '630583642253416');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=630583642253416&ev=PageView&noscript=1" /></noscript>
    <!-- === AKHIR DARI KODE FACEBOOK PIXEL === -->

    <style>
        :root {
            /* Vibrant Apple-Style Palette */
            --theme-primary: #007aff; /* Apple Blue */
            --theme-primary-hover: #005ecb;
            --theme-background: #f8f9fa;
            --theme-surface: #ffffff;
            --theme-on-surface: #3c4043;
            --theme-on-surface-variant: #5f6368;
            --theme-outline: #dadce0;
            --theme-outline-variant: #e8eaed;

            /* Custom Apple Colors */
            --apple-blue: #007aff;
            --apple-green: #34c759;
            --apple-yellow: #ffcc00;
            --apple-red: #ff3b30;

            /* Shadows */
            --shadow-1: 0 1px 2px 0 rgba(60,64,67,.3), 0 1px 3px 1px rgba(60,64,67,.15);
            --shadow-2: 0 1px 2px 0 rgba(60,64,67,.3), 0 2px 6px 2px rgba(60,64,67,.15);
            --shadow-3: 0 4px 8px 3px rgba(60,64,67,.15), 0 1px 3px rgba(60,64,67,.3);
        }
        /* Google Sans Typography (can be kept or changed to SF Pro) */
        body {
            font-family: 'Google Sans', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--theme-background);
            color: var(--theme-on-surface);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .google-sans {
            font-family: 'Google Sans', sans-serif;
        }
        /* Enhanced Material Design Components */
        .material-card {
            background: var(--theme-surface);
            border-radius: 12px;
            box-shadow: var(--shadow-1);
            transition: box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--theme-outline);
        }
        .material-card:hover {
            box-shadow: var(--shadow-2);
        }
        .material-card-elevated {
            box-shadow: var(--shadow-2);
        }
        /* Enhanced Form Inputs */
        .form-input {
            border: 2px solid var(--theme-outline);
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 8px;
            padding: 10px 12px;
            width: 100%;
            background-color: var(--theme-surface);
            font-size: 16px;
            font-family: 'Roboto', sans-serif;
            color: var(--theme-on-surface);
        }
        .form-input:focus {
            border-color: var(--theme-primary);
            background-color: var(--theme-surface);
            outline: none;
            box-shadow: 0 0 0 1px var(--theme-primary);
        }
        .form-input::placeholder {
            color: var(--theme-on-surface-variant);
        }
        /* Enhanced Buttons */
        .cta-button {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 24px;
            padding: 12px 28px;
            font-size: 15px;
            font-weight: 500;
            font-family: 'Google Sans', sans-serif;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            width: 100%;
            border: none;
            text-transform: none;
            letter-spacing: 0.25px;
            min-height: 46px;
        }
        .blue-button {
            background-color: var(--theme-primary);
            color: white;
            box-shadow: var(--shadow-1);
        }
        .blue-button:hover {
            background-color: var(--theme-primary-hover);
            box-shadow: var(--shadow-2);
            transform: translateY(-1px);
        }
        .blue-button:active {
            transform: translateY(0);
            box-shadow: var(--shadow-1);
        }
        .red-button {
            background-color: var(--apple-red);
            color: white;
            box-shadow: var(--shadow-1);
        }
        .red-button:hover {
            background-color: #D93025; /* Darker red */
            box-shadow: var(--shadow-2);
        }
        .cta-button:disabled {
            background-color: var(--theme-outline-variant);
            color: var(--theme-on-surface-variant);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        /* Enhanced Modal Styling */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.85);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: var(--theme-surface);
            margin: auto;
            padding: 28px;
            width: 90%;
            max-width: 480px;
            border-radius: 16px;
            box-shadow: var(--shadow-3);
            text-align: center;
            position: relative;
            animation: modalSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        .modal-content h3 {
            color: var(--theme-on-surface);
            margin-bottom: 12px;
            font-size: 18px;
            font-weight: 500;
            font-family: 'Google Sans', sans-serif;
        }
        .modal-content p {
            color: var(--theme-on-surface-variant);
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 14px;
        }
        .modal-ok-button {
            background-color: var(--theme-primary);
            color: white;
            padding: 10px 28px;
            border: none;
            border-radius: 24px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            font-family: 'Google Sans', sans-serif;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 36px;
        }
        .modal-ok-button:hover {
            background-color: var(--theme-primary-hover);
            box-shadow: var(--shadow-1);
        }
        /* === START: Auto-Scrolling Testimonial Carousel Styles === */
        @keyframes scroll {
            from { transform: translateX(0); }
            to { transform: translateX(-100%); }
        }
        .testimonial-carousel-container {
            display: flex;
            overflow: hidden;
            position: relative;
            width: 100%;
            -webkit-mask-image: linear-gradient(to right, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 5%, rgba(0,0,0,1) 95%, rgba(0,0,0,0) 100%);
            mask-image: linear-gradient(to right, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 5%, rgba(0,0,0,1) 95%, rgba(0,0,0,0) 100%);
        }
        .testimonial-track {
            flex-shrink: 0;
            display: flex;
            justify-content: flex-start; /* Aligns items to the start */
            min-width: 100%;
            animation: scroll 100s linear infinite;
        }
        .testimonial-carousel-container:hover .testimonial-track {
            animation-play-state: paused;
        }
        .testimonial-slide {
            flex-shrink: 0;
            width: 40vw; /* Responsive width for slides */
            max-width: 380px; /* Max width to prevent them getting too large */
            padding: 0 6px; /* Creates 12px space between images */
        }
        .testimonial-image {
            width: 100%;
            height: auto;
            object-fit: cover;
            aspect-ratio: 4 / 3;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .testimonial-image:hover {
            transform: scale(1.03);
            box-shadow: var(--shadow-2);
        }
        /* === END: Auto-Scrolling Testimonial Carousel Styles === */

        /* Enhanced Notification Toast */
        .notif-box {
            position: fixed;
            top: 24px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #3c4043; /* Dark grey for toast */
            color: #ffffff;
            border-radius: 8px;
            box-shadow: var(--shadow-3);
            padding: 16px 24px;
            display: none;
            align-items: center;
            gap: 12px;
            width: auto;
            max-width: 400px;
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Roboto', sans-serif;
        }
        .notif-box.show {
            display: flex;
            opacity: 1;
            animation: slideInAndOut 5s ease-in-out forwards;
        }
        @keyframes slideInAndOut {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            10% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
            90% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
        }
        .notif-icon-wrapper {
            color: var(--apple-green);
            font-size: 20px;
            flex-shrink: 0;
        }
        .notif-message {
            font-size: 14px;
            line-height: 1.4;
        }
        .notif-message strong {
            font-weight: 500;
        }
        .notif-time {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 2px;
        }
        /* Enhanced FAQ Section */
        .faq-item {
            border-bottom: 1px solid var(--theme-outline);
            transition: background-color 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .faq-item:last-child {
            border-bottom: none;
        }
        .faq-item:hover {
            background-color: var(--theme-background);
        }
        .faq-item summary {
            font-weight: 500;
            font-size: 15px;
            color: var(--theme-on-surface);
            padding: 16px 12px;
            cursor: pointer;
            list-style: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Google Sans', sans-serif;
        }
        .faq-item summary::-webkit-details-marker {
            display: none;
        }
        .faq-item summary::after {
            content: '\f078';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--theme-on-surface-variant);
            font-size: 14px;
        }
        .faq-item[open] summary::after {
            transform: rotate(180deg);
        }
        .faq-content {
            padding: 0 12px 16px 12px;
            color: var(--theme-on-surface-variant);
            line-height: 1.6;
            font-size: 14px;
        }
        .faq-item[open] summary {
            color: var(--theme-primary);
        }
        /* This rule prevents a double-border issue on card-style accordions */
        .faq-item.rounded-lg {
            border-bottom: none;
        }
        /* Compact styles for the main info/help FAQ section */
        #info-section-full .faq-item summary {
            padding: 12px 10px;
            font-size: 14px;
        }
        #info-section-full .faq-content {
            padding: 4px 10px 12px 10px;
            font-size: 13px;
        }
        #info-section-full .faq-item {
            border-bottom: 1px solid var(--theme-outline-variant);
        }

        /* Enhanced Segmented Control */
        .segmented-control {
            display: flex;
            position: relative;
            background-color: var(--theme-outline-variant);
            border-radius: 12px;
            padding: 4px;
            width: 100%;
            box-shadow: inset 0 1px 2px rgba(60, 64, 67, 0.1);
        }
        .segmented-control .package-radio {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        .segmented-control .package-label {
            flex: 1;
            text-align: center;
            padding: 10px 8px;
            cursor: pointer;
            z-index: 2;
            transition: color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--theme-on-surface-variant);
            font-size: 13px;
            font-weight: 500;
            line-height: 1.2;
            font-family: 'Google Sans', sans-serif;
            border-radius: 8px;
        }
        .segmented-control .package-radio:checked + .package-label {
            color: #ffffff;
        }
        .segmented-control-pill {
            position: absolute;
            top: 4px;
            bottom: 4px;
            width: calc((100% - 8px) / 2);
            background-color: var(--theme-primary);
            border-radius: 8px;
            box-shadow: var(--shadow-1);
            z-index: 1;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .segmented-control .package-radio#pkg-yearly:checked ~ .segmented-control-pill {
            transform: translateX(0%);
        }
        .segmented-control .package-radio#pkg-lifetime:checked ~ .segmented-control-pill {
            transform: translateX(100%);
        }
        .segmented-control .package-radio#product-google:checked ~ .segmented-control-pill {
            transform: translateX(0%);
        }
        .segmented-control .package-radio#product-icloud:checked ~ .segmented-control-pill {
            transform: translateX(100%);
        }
        /* Enhanced Product Info Display */
        #product-info-form-top {
            transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .product-info-card {
            background: #ffffff;
            border: 1px solid var(--theme-outline);
            border-radius: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .product-info-card:hover {
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.08);
        }
        /* Enhanced Payment Method Styles */
        .payment-radio {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        .payment-label {
            display: flex;
            align-items: center;
            padding: 12px;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border-radius: 12px;
            margin: 2px;
        }
        .payment-label:hover {
            background-color: var(--theme-background);
        }
        .payment-radio:checked + .payment-label {
            background-color: #e8f0fe; /* Light blue */
            box-shadow: inset 0 0 0 2px var(--theme-primary);
        }
        .payment-logo-container {
            width: 48px;
            height: 32px;
            background-color: #ffffff;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            padding: 4px;
            border: 1px solid var(--theme-outline, #dadce0);
            flex-shrink: 0;
        }
        .form-payment-logo-container {
            width: 48px;
            height: 32px;
            background-color: #ffffff;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            padding: 4px;
            border: 1px solid var(--theme-outline, #dadce0);
            flex-shrink: 0;
        }
        .payment-logo {
            max-height: 100%;
            max-width: 100%;
            object-fit: contain;
        }
        .custom-radio-button {
            height: 20px;
            width: 20px;
            border: 2px solid var(--theme-outline);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
            margin-left: auto;
        }
        .custom-radio-button .dot {
            height: 8px;
            width: 8px;
            border-radius: 50%;
            background-color: transparent;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .payment-radio:checked + .payment-label .custom-radio-button {
            border-color: var(--theme-primary);
        }
        .payment-radio:checked + .payment-label .custom-radio-button .dot {
            background-color: var(--theme-primary);
        }
        /* Enhanced Payment Instruction Layout */
        .payment-header {
            background: linear-gradient(135deg, #202124 0%, #3c4043 100%);
            color: #fff;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 999;
        }
        .payment-card {
            background-color: var(--theme-surface);
            border: 1px solid var(--theme-outline);
            border-radius: 12px;
            padding: 16px;
            margin-top: 12px;
            box-shadow: var(--shadow-1);
        }
        .copy-button-text {
            background: none;
            border: none;
            color: var(--theme-primary);
            font-weight: 500;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .copy-button-text:hover {
            background-color: #e8f0fe;
        }
        .confirm-button-outlined {
            width: 100%;
            padding: 12px 24px;
            border: 2px solid var(--theme-primary);
            color: var(--theme-primary);
            background-color: transparent;
            border-radius: 24px;
            font-weight: 500;
            font-family: 'Google Sans', sans-serif;
            cursor: pointer;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 48px;
        }
        .confirm-button-outlined:hover {
            background-color: #e8f0fe;
            box-shadow: var(--shadow-1);
        }
        .payment-accordion {
            border-bottom: 1px solid var(--theme-outline);
        }
        .payment-accordion:last-child {
            border-bottom: none;
        }
        .payment-accordion summary {
            font-weight: 500;
            padding: 14px 0;
            cursor: pointer;
            list-style: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Google Sans', sans-serif;
        }
        .payment-accordion summary::-webkit-details-marker {
            display: none;
        }
        .payment-accordion summary::after {
            content: '\f078';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--theme-on-surface-variant);
        }
        .payment-accordion[open] summary::after {
            transform: rotate(180deg);
        }
        .payment-accordion-content {
            padding-bottom: 16px;
            color: var(--theme-on-surface-variant);
            line-height: 1.6;
        }
        .payment-accordion-content ol {
            list-style-type: decimal;
            padding-left: 20px;
            font-size: 14px;
        }
        /* === START: User Requested Styles === */
        /* Ukuran untuk desktop dan tablet */
        .payment-header {
            padding: 1rem; /* 16px */
        }
        .payment-header h2 {
            font-size: 1.125rem; /* 18px */
            font-weight: 500;
            font-family: 'Google Sans', sans-serif;
            color: #ffffff; /* Ditambahkan agar teks terlihat */
        }
        .countdown-timer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        .countdown-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        .countdown-number {
            background-color: var(--apple-red);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1.1rem; /* 17.6px */
            font-family: 'Google Sans', sans-serif;
            text-align: center;
        }
        /* Penyesuaian ukuran untuk layar mobile (di bawah 768px) */
        @media (max-width: 768px) {
            .payment-header {
                padding: 0.875rem 1rem; /* 14px */
            }
            .payment-header h2 {
                font-size: 1.0625rem; /* 17px */
            }
            .countdown-timer {
                margin-top: 0.25rem;
            }
            .countdown-number {
                font-size: 0.875rem; /* 14px */
                padding: 0.15rem 0.4rem;
            }
            .countdown-item {
                font-size: 0.75rem; /* 12px */
            }
        }
        /* === END: User Requested Styles === */

        /* Enhanced Details Modal (Bottom Sheet) */
        #detailsModal {
            align-items: flex-end;
        }
        .details-modal-content {
            background-color: var(--theme-surface);
            width: 100%;
            max-width: 100%;
            border-radius: 20px 20px 0 0;
            box-shadow: var(--shadow-3);
            text-align: left;
            transform: translateY(100%);
        }
        .details-modal-content.is-open {
            animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        .details-modal-content.is-closing {
            animation: slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        @keyframes slideUp {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }
        @keyframes slideDown {
            from {
                transform: translateY(0);
            }
            to {
                transform: translateY(100%);
            }
        }
        .details-modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--theme-outline);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .details-modal-header h3 {
            font-size: 18px;
            font-weight: 500;
            color: var(--theme-on-surface);
            font-family: 'Google Sans', sans-serif;
        }
        .details-modal-close {
            font-size: 24px;
            font-weight: 400;
            color: var(--theme-on-surface-variant);
            cursor: pointer;
            background: none;
            border: none;
            padding: 8px;
            border-radius: 50%;
            transition: background-color 0.15s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .details-modal-close:hover {
            background-color: var(--theme-outline-variant);
        }
        .details-modal-body {
            padding: 20px 24px 32px 24px;
            max-height: 60vh;
            overflow-y: auto;
        }
        /* Enhanced Mobile Responsiveness */
        @media (max-width: 768px) {
            .notif-box {
                left: 16px;
                right: 16px;
                top: 16px;
                transform: translateX(0);
                width: calc(100% - 32px);
                max-width: none;
            }
            @keyframes slideInAndOut {
                0% {
                    opacity: 0;
                    transform: translateY(-20px);
                }
                10% {
                    opacity: 1;
                    transform: translateY(0);
                }
                90% {
                    opacity: 1;
                    transform: translateY(0);
                }
                100% {
                    opacity: 0;
                    transform: translateY(-20px);
                }
            }
            .material-card {
                border-radius: 16px;
                margin: 0 4px;
            }
            .form-input {
                font-size: 16px; /* Prevent zoom on iOS */
            }
        }
        /* Enhanced Image Modal */
        .modal-image-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .modal-content-image {
            margin: auto;
            display: block;
            width: auto;
            max-width: 90%;
            max-height: 80vh;
            animation: zoomIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 8px;
        }
        .close-image-modal-button {
            margin-top: 20px;
            color: #ffffff;
            background-color: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 12px 24px;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 500;
            font-family: 'Google Sans', sans-serif;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .close-image-modal-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }
        .modal-nav {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: 44px;
            height: 44px;
            margin-top: -22px;
            color: white;
            font-weight: bold;
            font-size: 24px;
            transition: 0.3s ease;
            border-radius: 50%;
            user-select: none;
            -webkit-user-select: none;
            background-color: rgba(0, 0, 0, 0.5);
            display: none; /* Hidden by default */
            justify-content: center;
            align-items: center;
        }
        .modal-nav.prev {
            left: 20px;
        }
        .modal-nav.next {
            right: 20px;
        }
        .modal-nav:hover {
            background-color: rgba(0, 0, 0, 0.7);
            transform: scale(1.1);
        }
        @keyframes zoomIn {
            from {
                transform: scale(0);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }
        /* Enhanced Feature Icons */
        .feature-icon {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .feature-icon:hover {
            transform: scale(1.1);
        }
        /* Enhanced Security Badge */
        .security-badge {
            background: #e8f0fe;
            color: #1557b0;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 10px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        /* Enhanced Typography */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Google Sans', sans-serif;
            color: var(--theme-on-surface);
        }
        .text-apple-blue {
            color: var(--apple-blue);
        }
        .text-apple-green {
            color: var(--apple-green);
        }
        .bg-apple-blue {
            background-color: var(--apple-blue);
        }
        /* Smooth Scrolling */
        html {
            scroll-behavior: smooth;
        }
        /* Loading States */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }
        .spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="antialiased">

    <div id="payment-instruction-container">
        <!-- Konten akan di-generate oleh JavaScript -->
    </div>
    <!-- Spacing adjustments for mobile and desktop -->
    <div class="p-1 sm:p-4 lg:p-8">
        <div id="main-content-container">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-x-12 gap-y-8 max-w-7xl mx-auto">
                <!-- Kolom Kiri: Form & Pembayaran -->
                <div class="lg:col-span-1 material-card p-5 md:p-8">
                    <!-- Header Keamanan -->
                    <div class="grid grid-cols-2 gap-3 text-center border-b border-m3-outline-variant pb-4 mb-4">
                        <div class="flex">
                            <div class="security-badge w-full justify-center">
                                <i class="fas fa-shield-alt text-xs mr-1"></i>
                                TRANSAKSI AMAN
                            </div>
                        </div>
                        <div class="flex">
                            <div class="security-badge w-full justify-center"
                                style="background: var(--theme-primary); color: white;">
                                <i class="fas fa-hand-holding-usd text-xs mr-1"></i>
                                GARANSI UANG KEMBALI
                            </div>
                        </div>
                    </div>

                    <!-- Product Selection -->
                    <div class="my-4">
                        <h2 class="text-lg font-bold mb-3 google-sans">Pilih Produk Anda</h2>
                        <div id="product-selection">
                            <div class="segmented-control">
                                <input type="radio" id="product-google" name="product" value="google"
                                    class="package-radio" checked>
                                <label for="product-google" class="package-label">Bundling Google 2TB</label>
                                <input type="radio" id="product-icloud" name="product" value="icloud"
                                    class="package-radio">
                                <label for="product-icloud" class="package-label">iCloud+ 2TB</label>
                                <div class="segmented-control-pill"></div>
                            </div>
                        </div>
                    </div>
                    <!-- Info Produk -->
                    <div id="product-info-form-top" class="mb-4"></div>

                    <!-- NEW: Accordion for Details -->
                    <div id="details-accordion-container" class="mb-4"></div>

                    <!-- Form -->
                    <form id="orderForm">
                        <h2 class="text-lg font-bold mb-3 google-sans">Lengkapi Data</h2>
                        <div class="space-y-4">
                            <div>
                                <input type="text" id="nama" name="nama" class="form-input" placeholder="Nama Anda *">
                            </div>
                            <div>
                                <input type="tel" id="whatsapp" name="whatsapp" class="form-input"
                                    placeholder="No. WhatsApp Anda *">
                            </div>
                            <div>
                                <input type="email" id="email" name="email" class="form-input"
                                    placeholder="Email Anda *">
                            </div>
                        </div>

                        <!-- Honeypot field for anti-spam -->
                        <input type="text" name="honeypot" style="display: none" tabindex="-1" autocomplete="off">

                        <!-- Hidden input for sheet name -->
                        <input type="hidden" name="sheetName" value="upstorage">

                        <!-- Metode Pembayaran -->
                        <div id="payment-method-selection" class="mt-4"></div>

                        <!-- Rincian Pesanan -->
                        <div id="order-details-in-form" class="mt-0"></div>

                        <button type="button" id="submit-btn" class="cta-button blue-button mt-4">
                            <i class="fas fa-shopping-cart mr-2"></i>
                            Beli Sekarang
                        </button>
                    </form>
                </div>

                <!-- Kolom Kanan: Testimoni, FAQ, Kebijakan -->
                <div class="lg:col-span-1 py-4 space-y-4">
                    <div id="testimonials-full"></div>
                    <div class="material-card p-5 md:p-6">
                        <div id="info-section-full"></div>
                    </div>
                </div>
            </div>
        </div>

        <footer id="footer" class="text-center mt-8 text-m3-on-surface-variant text-sm">
            <p>Copyright Â© <span id="currentYear">2025</span> InDrive ID. Semua Hak Dilindungi.</p>
        </footer>
    </div>

    <!-- Modal for Info/Confirmation -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle"></h3>
            <p id="modalMessage"></p>
            <button class="modal-ok-button" onclick="closeInfoModal()">OK</button>
        </div>
    </div>

    <!-- Modal untuk Zoom Gambar -->
    <div id="imageModal" class="modal">
        <span class="modal-nav prev" onclick="showPrevImage()">&#10094;</span>
        <span class="modal-nav next" onclick="showNextImage()">&#10095;</span>
        <div class="modal-image-wrapper">
            <img class="modal-content-image" id="modalImage">
            <button class="close-image-modal-button" onclick="closeImageModal()">Tutup</button>
        </div>
    </div>

    <!-- NEW: Modal for Transaction Details -->
    <div id="detailsModal" class="modal">
        <div class="details-modal-content" id="detailsModalContent">
            <!-- Content will be injected by JS -->
        </div>
    </div>

    <!-- Notification Popup -->
    <div class="notif-box" id="notifBox">
        <div class="notif-icon-wrapper"><i class="far fa-check-circle"></i></div>
        <div class="notif-content-area">
            <div class="notif-message">
                <div><strong class="notif-name">Nama Acak</strong> baru saja membeli!</div>
                <div class="notif-time">beberapa detik lalu</div>
            </div>
        </div>
    </div>


    <script>
        // --- VALIDATION LOGIC ---
        const operatorPrefixes = {
            'Telkomsel': ['0811', '0812', '0813', '0821', '0822', '0823', '0851', '0852', '0853'],
            'by.U': ['0851'],
            'Indosat Ooredoo': ['0814', '0815', '0816', '0855', '0856', '0857', '0858'],
            'Tri (3)': ['0895', '0896', '0897', '0898', '0899'],
            'XL Axiata': ['0817', '0818', '0819', '0859', '0877', '0878', '0879'],
            'Live.On': ['0859'],
            'Axis': ['0831', '0832', '0833', '0838'],
            'Smartfren': ['0881', '0882', '0883', '0884', '0885', '0886', '0887', '0888', '0889']
        };
        const blacklistedNumbers = ['081234567890'];

        function isInvalidPattern(nomor) {
            if (blacklistedNumbers.includes(nomor)) return true;
            const numberPart = nomor.substring(2);
            if (/(\d)\1{4,}/.test(numberPart)) return true;
            for (let i = 0; i < numberPart.length - 4; i++) {
                const sub = numberPart.substring(i, i + 5);
                const isAscending = '0123456789'.includes(sub);
                const isDescending = '9876543210'.includes(sub);
                if (isAscending || isDescending) return true;
            }
            const uniqueDigits = new Set(numberPart.split(''));
            if (uniqueDigits.size < 4) return true;
            if (/(..)\1\1/.test(numberPart)) return true;
            return false;
        }

        function getOperatorFromNumber(nomor) {
            const prefix = nomor.substring(0, 4);
            for (const operator in operatorPrefixes) {
                if (operatorPrefixes[operator].includes(prefix)) {
                    return operator;
                }
            }
            return null;
        }

        function validatePhoneNumber(nomorHp) {
            const genericError = { isValid: false, message: 'Silahkan isi dengan nomor yang benar' };

            if (nomorHp.length < 10) {
                return genericError;
            }

            const operator = getOperatorFromNumber(nomorHp);
            if (!operator) {
                return genericError;
            }

            const maxLength = operator === 'Tri (3)' ? 13 : 12;
            if (nomorHp.length > maxLength) {
                return genericError;
            }

            if (isInvalidPattern(nomorHp)) {
                return genericError;
            }

            return { isValid: true, message: 'Nomor valid.' };
        }

        document.addEventListener('DOMContentLoaded', function () {

            // --- ELEMENTS ---
            const elements = {
                mainContentContainer: document.getElementById('main-content-container'),
                paymentInstructionContainer: document.getElementById('payment-instruction-container'),
                footer: document.getElementById('footer'),
                currentYear: document.getElementById('currentYear'),
                productInfoFormTop: document.getElementById('product-info-form-top'),
                detailsAccordionContainer: document.getElementById('details-accordion-container'), // NEW
                paymentMethodSelection: document.getElementById('payment-method-selection'),
                orderDetailsInForm: document.getElementById('order-details-in-form'),
                testimonialsFull: document.getElementById('testimonials-full'),
                infoSectionFull: document.getElementById('info-section-full'),
                orderForm: document.getElementById('orderForm'),
                submitBtn: document.getElementById('submit-btn'),
                notifBox: document.getElementById('notifBox'),
                notifName: document.querySelector('#notifBox .notif-name'),
                detailsModal: document.getElementById('detailsModal'),
                detailsModalContent: document.getElementById('detailsModalContent'),
            };

            // --- CONFIGURATION ---
            const uniqueCode = Math.floor(Math.random() * (500 - 100 + 1)) + 100;
            let countdownInterval;
            let expiryTime;
            let currentOrderDetails = {};

            const products = {
                google: {
                    id: 'google',
                    name: "Bundling Google 2TB",
                    price: 250000,
                    normalPrice: 999000,
                    title: "Bundling 2TB: Drive, Photos, Gmail",
                    priceDisplay: `Rp250.000`,
                    logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Google_Drive_icon_%282020%29.svg/330px-Google_Drive_icon_%282020%29.svg.png',
                    description: "Kapasitas 2TB untuk Drive, Photos, dan Gmail seumur hidup.",
                    paymentTerm: "Sekali Bayar Seumur Hidup",
                    features: [
                        "<strong>Kapasitas 2TB:</strong> Nikmati penyimpanan raksasa 2TB yang terbagi untuk Google Drive, Google Photos, dan Gmail.",
                        "<strong>Akses File Di Mana Saja:</strong> Buka dan edit file Anda dari komputer, tablet, atau smartphone.",
                        "<strong>Satu Solusi Terintegrasi:</strong> Semua kebutuhan penyimpanan Anda dalam satu paket hemat.",
                        "<strong>Keamanan Kelas Dunia:</strong> File Anda dilindungi oleh infrastruktur keamanan canggih dari Google.",
                        "<strong>Berbagi & Kolaborasi Mudah:</strong> Bagikan file dan folder dengan mudah, serta bekerja bersama secara real-time.",
                        "<strong>Sekali Bayar Seumur Hidup:</strong> Tanpa biaya langganan bulanan atau tahunan.",
                        "<strong>Gunakan Akun Pribadi Anda:</strong> Upgrade dilakukan langsung pada akun Google yang sudah Anda miliki.",
                        "<strong>100% Aman & Bergaransi:</strong> Produk asli dengan jaminan privasi penuh."
                    ],
                    faq: [
                        { q: "Apakah ini benar-benar unlimited dan seumur hidup?", a: "Ya, benar. Anda akan mendapatkan penyimpanan tanpa batas untuk Google Drive dengan sistem pembayaran sekali untuk selamanya. Tidak ada biaya bulanan atau tahunan tersembunyi." },
                        { q: "Bagaimana proses upgrade untuk Google Drive?", a: "Prosesnya otomatis dan terintegrasi dengan akun Google Anda. Setelah pembayaran, penyimpanan pada Google Drive Anda akan langsung ter-upgrade menjadi unlimited. Anda tidak perlu melakukan apa-apa lagi dan bisa langsung menikmati kapasitas tanpa batas di akun pribadi Anda." },
                        { q: "Apakah ini aman dan legal?", a: "Tentu saja. Metode yang kami gunakan adalah sah melalui fitur Google Workspace. Kami tidak pernah meminta password Anda (untuk upgrade Drive) dan privasi file Anda 100% terjamin. Anda memiliki kontrol penuh atas data Anda." },
                        { q: "Apa bedanya dengan langganan Google One?", a: "Google One adalah layanan langganan resmi dari Google dengan kuota terbatas (misal 2TB) dan biaya bulanan/tahunan. Produk kami memberikan Anda penyimpanan&nbsp;unlimited&nbsp;dengan sistem&nbsp;sekali bayar untuk selamanya, melalui metode upgrade langsung pada akun Anda." },
                        { q: "Bisakah saya memindahkan file lama saya?", a: "Tentu bisa. Karena upgrade ini langsung diterapkan pada akun Google Drive pribadi Anda, semua file lama Anda akan tetap ada di tempatnya dan secara otomatis menjadi bagian dari penyimpanan unlimited yang baru. Anda tidak perlu memindahkan file atau folder apa pun." },
                        { q: "Berapa lama proses aktivasinya?", a: "Prosesnya sangat cepat. Setelah Anda melakukan konfirmasi pembayaran, aktivasi biasanya selesai dalam waktu 5-15 menit, maksimal 1x24 jam." },
                        { q: "Apakah ada garansi?", a: "Kami memberikan garansi uang kembali penuh jika proses upgrade gagal karena kesalahan dari pihak kami. Kami juga memberikan garansi layanan seumur hidup. Namun, garansi tidak berlaku jika akun Anda dibatasi oleh Google karena melanggar kebijakan mereka (misalnya menyimpan file ilegal seperti software bajakan, film/musik tanpa lisensi, konten pornografi, menyebarkan virus/malware, dll)." }
                    ],
                    testimonials: [
                        "https://pixvid.org/images/2025/11/04/kS2aB.jpg",
                        "https://pixvid.org/images/2025/11/04/kSBPf.jpg",
                        "https://pixvid.org/images/2025/11/04/kSBrm.jpg",
                        "https://pixvid.org/images/2025/11/04/kSBoz.jpg",
                        "https://pixvid.org/images/2025/11/04/kSBXl.jpg",
                        "https://pixvid.org/images/2025/11/04/kSNUY.jpg",
                        "https://pixvid.org/images/2025/11/04/kSNlo.jpg",
                        "https://pixvid.org/images/2025/11/04/kSN6d.jpg",
                        "https://pixvid.org/images/2025/11/04/kSNsb.jpg",
                        "https://pixvid.org/images/2025/11/04/kScmN.jpg",
                        "https://pixvid.org/images/2025/11/04/kSchv.jpg",
                        "https://pixvid.org/images/2025/11/04/kSc95.jpg",
                        "https://pixvid.org/images/2025/11/04/kScN7.jpg"
                    ]
                },
                icloud: {
                    id: 'icloud',
                    name: "iCloud+ 2TB",
                    price: 350000,
                    normalPrice: 450000,
                    title: "iCloud+ 2TB",
                    priceDisplay: `Rp350.000`,
                    logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/ICloud_logo.svg/320px-ICloud_logo.svg.png',
                    description: "Penyimpanan 2TB & fitur premium iCloud+ untuk 1 tahun.",
                    paymentTerm: "Langganan untuk 1 Tahun",
                    features: [
                        "<strong>Kapasitas 2TB:</strong> Simpan semua foto, video, file, dan backup perangkat Anda dengan aman.",
                        "<strong>Relai Pribadi iCloud:</strong> Jelajahi web dengan lebih aman dan pribadi di Safari.",
                        "<strong>Sembunyikan Email Saya:</strong> Buat alamat email acak untuk menjaga kerahasiaan email pribadi Anda.",
                        "<strong>Domain Email Khusus:</strong> Personalisasi alamat email iCloud Anda dengan domain sendiri.",
                        "<strong>Video Aman HomeKit:</strong> Simpan rekaman kamera keamanan rumah Anda dengan enkripsi end-to-end.",
                        "<strong>Gunakan Email Pribadi Anda:</strong> Upgrade dilakukan langsung pada akun Apple ID (iCloud) pribadi Anda.",
                        "<strong>100% Aman & Bergaransi:</strong> Proses legal melalui fitur Apple One Premier, privasi terjamin."
                    ],
                    faq: [
                        { q: "Apakah ini benar-benar 2TB?", a: "Ya, Anda akan mendapatkan kapasitas 2TB. Kami menawarkan paket berlangganan selama 1 tahun. Paket ini menggunakan email pribadi Anda." },
                        { q: "Bagaimana proses upgrade iCloud+ ini?", a: "Prosesnya sangat mudah. Kami akan mengundang email (Apple ID) Anda untuk bergabung ke dalam langganan Apple One Premier kami. Setelah Anda menerima undangan, kapasitas iCloud Anda akan otomatis menjadi 2TB beserta semua fitur iCloud+." },
                        { q: "Apakah ini aman dan legal?", a: "Tentu saja. Metode yang kami gunakan 100% legal melalui fitur Apple Family Sharing. Kami tidak pernah meminta password Apple ID Anda. Privasi data dan file Anda sepenuhnya terjamin karena setiap anggota keluarga memiliki penyimpanan pribadi yang tidak bisa diakses oleh anggota lain." },
                        { q: "Apa bedanya dengan langganan iCloud+ langsung ke Apple?", a: "Langganan langsung ke Apple memerlukan pembayaran bulanan atau tahunan yang berulang. Dengan paket kami, Anda bisa mendapatkan harga yang jauh lebih murah." },
                        { q: "Apakah file lama saya akan hilang?", a: "Tidak akan. Karena upgrade ini diterapkan pada akun Apple ID pribadi Anda, semua file dan data lama Anda akan tetap aman di tempatnya dan secara otomatis menjadi bagian dari penyimpanan 2TB yang baru." },
                        { q: "Berapa lama proses aktivasinya?", a: "Prosesnya sangat cepat. Setelah Anda melakukan konfirmasi pembayaran, undangan akan kami kirimkan dan aktivasi biasanya selesai dalam waktu 5-15 menit." },
                        { q: "Apakah ada garansi?", a: "Kami memberikan garansi uang kembali penuh jika proses upgrade gagal karena kesalahan dari pihak kami. Garansi tidak berlaku jika akun Anda dibatasi oleh Apple karena melanggar kebijakan mereka (misalnya menyimpan file ilegal, dll)." }
                    ],
                    testimonials: [
                        "https://pixvid.org/images/2025/10/24/kEZMJ.jpg",
                        "https://pixvid.org/images/2025/10/24/kEZcj.jpg",
                        "https://pixvid.org/images/2025/10/24/kEgWD.jpg",
                        "https://pixvid.org/images/2025/10/24/kEgFp.jpg",
                        "https://pixvid.org/images/2025/10/24/kEgxI.jpg",
                        "https://pixvid.org/images/2025/10/24/kEgL0.jpg",
                        "https://pixvid.org/images/2025/10/24/kEzzW.jpg",
                        "https://pixvid.org/images/2025/10/24/kEzuR.jpg",
                        "https://pixvid.org/images/2025/10/24/kEzGt.jpg",
                        "https://pixvid.org/images/2025/10/24/kEzfK.jpg",
                        "https://pixvid.org/images/2025/10/24/kE7Hy.jpg",
                        "https://pixvid.org/images/2025/10/24/kE7KG.jpg",
                        "https://pixvid.org/images/2025/10/24/kE7as.jpg",
                        "https://pixvid.org/images/2025/10/24/kEHPL.jpg",
                        "https://pixvid.org/images/2025/10/24/kEHrU.jpg",
                        "https://pixvid.org/images/2025/10/24/kEHoZ.jpg",
                        "https://pixvid.org/images/2025/10/24/kEHXr.jpg",
                        "https://pixvid.org/images/2025/10/24/kEQUw.jpg",
                        "https://pixvid.org/images/2025/10/24/kEQlE.jpg",
                        "https://pixvid.org/images/2025/10/24/kEQ69.jpg",
                        "https://pixvid.org/images/2025/10/24/kEQsS.jpg",
                        "https://pixvid.org/images/2025/10/24/kERm2.jpg",
                        "https://pixvid.org/images/2025/10/24/kERhV.jpg",
                        "https://pixvid.org/images/2025/10/24/kER9k.jpg",
                        "https://pixvid.org/images/2025/10/24/kERNg.jpg",
                        "https://pixvid.org/images/2025/10/24/kErCO.jpg",
                        "https://pixvid.org/images/2025/10/24/kErwF.jpg",
                        "https://pixvid.org/images/2025/10/24/kErdn.jpg",
                        "https://pixvid.org/images/2025/10/24/kEr3M.jpg",
                        "https://pixvid.org/images/2025/10/24/kEOZa.jpg",
                        "https://pixvid.org/images/2025/10/24/kEOYB.jpg",
                        "https://pixvid.org/images/2025/10/24/kEOAf.jpg",
                        "https://pixvid.org/images/2025/10/24/kEOVm.jpg",
                        "https://pixvid.org/images/2025/10/24/kEl7z.jpg",
                        "https://pixvid.org/images/2025/10/24/kElJl.jpg"
                    ]
                }
            };

            let currentProductId = 'google'; // Produk default yang dipilih

            // Event listener for product selection
            document.querySelectorAll('input[name="product"]').forEach(radio => {
                radio.addEventListener('change', (event) => {
                    currentProductId = event.target.value;
                    updateDisplay();
                });
            });

            // --- UPDATED PAYMENT ACCOUNTS ---
            const paymentAccounts = {
                qris: {
                    displayName: 'QRIS',
                    accountHolder: 'Epay',
                    number: '00020101021126610016ID.CO.SHOPEE.WWW01189360091800223157700208223157700303UMI51440014ID.CO.QRIS.WWW0215ID10254270621910303UMI5204481453033605802ID5904Epay6013JAKARTA PUSAT61051061062070703A0163042F15',
                    logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Logo_QRIS.svg/163px-Logo_QRIS.svg.png',
                    type: 'qris',
                },
                cimb: {
                    displayName: 'Cimb Niaga',
                    accountHolder: 'Octo Pay - 6289510639366',
                    number: '6289510639366',
                    logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/CIMB_Niaga_logo.svg/330px-CIMB_Niaga_logo.svg.png',
                    type: 'va',
                },
                bca_va: {
                    displayName: 'BCA Virtual Account',
                    accountHolder: 'Epayment',
                    number: '39358089510639366',
                    logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/330px-Bank_Central_Asia.svg.png',
                    type: 'va',
                },
                gopay: {
                    displayName: 'Gopay',
                    accountHolder: 'Gopay 6289510639366',
                    number: '089510639366',
                    logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Gopay_logo.svg/320px-Gopay_logo.svg.png',
                    type: 'ewallet',
                },
                dana: {
                    displayName: 'DANA',
                    accountHolder: 'DNID089510639366',
                    number: '089510639366',
                    logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Logo_dana_blue.svg/330px-Logo_dana_blue.svg.png',
                    type: 'ewallet',
                },
                ovo: {
                    displayName: 'OVO',
                    accountHolder: 'OVO Epayment',
                    number: '089510639366',
                    logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Logo_ovo_purple.svg/330px-Logo_ovo_purple.svg.png',
                    type: 'ewallet',
                }
            };

            // --- TEMPLATE FUNCTIONS ---
            const getProductInfoHTML = (pkg) => {
                const discount = Math.round(((pkg.normalPrice - pkg.price) / pkg.normalPrice) * 100);
                return `
            <div class="product-info-card flex h-full bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-200 hover:shadow-md transition-all">
                <!-- Left Stripe -->
                <div class="w-2 bg-gradient-to-b from-[#007aff] to-[#005ecb]"></div>
                
                <div class="p-6 flex flex-col flex-grow relative">
                    <div class="absolute top-4 right-4">
                        <span class="px-2 py-1 bg-blue-50 text-blue-700 text-xs font-bold rounded-md">
                            -${discount}%
                        </span>
                    </div>

                    <div class="flex items-center gap-4 mb-4">
                        <img alt="Logo ${pkg.name}" class="w-12 h-12 object-contain" src="${pkg.logo}">
                        <div>
                            <h1 class="text-lg font-bold text-gray-900 leading-tight">${pkg.title}</h1>
                            <p class="text-xs text-gray-500">Official Upgrade</p>
                        </div>
                    </div>
                    
                    <p class="text-sm text-gray-600 mb-4 flex-grow">${pkg.description}</p>
                    
                    <div class="flex items-end justify-between mt-auto">
                        <div>
                            <p class="text-xs text-gray-400 mb-0.5">Harga Normal</p>
                            <p class="text-sm text-gray-400 line-through decoration-red-400">${formatCurrency(pkg.normalPrice)}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-2xl font-bold text-[#007aff]">${formatCurrency(pkg.price)}</p>
                            <p class="text-[10px] text-gray-500">${pkg.paymentTerm}</p>
                        </div>
                    </div>
                </div>
            </div>`;
            }

            // --- NEW: getDetailsAccordionHTML ---
            const getDetailsAccordionHTML = (pkg) => {
                const colors = ['text-blue-500', 'text-green-500', 'text-yellow-500', 'text-red-500'];
                const featuresHTML = `<ul class="space-y-3">${pkg.features.map((f, index) => `<li class="flex items-start"><i class="fas fa-check-circle ${colors[index % colors.length]} mt-1 mr-3 text-lg feature-icon"></i><span class="text-theme-on-surface-variant text-sm leading-relaxed">${f}</span></li>`).join('')}</ul>`;

                const policyHTML = `
                <p class="mb-4 text-sm leading-relaxed">Dengan menggunakan layanan ini, Anda setuju untuk terikat pada S&K kami. Layanan ini adalah pembayaran satu kali untuk manfaat seumur hidup, tunduk pada kebijakan Google yang berlaku.</p>
                <ul class="list-disc list-inside space-y-2 text-sm">
                    <li>Layanan untuk penggunaan wajar dan tidak melanggar hukum.</li>
                    <li>Garansi penuh jika upgrade gagal karena kesalahan kami.</li>
                    <li>Garansi tidak mencakup pemblokiran akun akibat pelanggaran oleh pengguna.</li>
                    <li>Perubahan kebijakan Google di masa depan berada di luar kendali kami.</li>
                </ul>`;

                return `
                <details class="faq-item">
                    <summary>Detail Deskripsi</summary>
                    <div class="faq-content">${featuresHTML}</div>
                </details>
                <details class="faq-item">
                    <summary>Informasi Penting</summary>
                    <div class="faq-content">${policyHTML}</div>
                </details>
            `;
            }

            // --- MODIFIED: getPaymentMethodsHTML ---
            const getPaymentMethodsHTML = (accounts) => {
                let html = `
                <div class="bg-yellow-50 border border-yellow-200 text-yellow-800 text-xs rounded-lg p-3 mb-4 text-center">
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    <strong>Penting:</strong> Pastikan No. WhatsApp & Email Anda sudah benar untuk proses upgrade penyimpanan anda.
                </div>
                <h2 class="text-lg font-bold mb-4 text-gray-800 google-sans">Metode Pembayaran</h2>`;
                html += `<div class="payment-group">`;

                Object.entries(accounts).forEach(([key, account], index) => {
                    const borderClass = index === 0 ? '' : 'border-t border-gray-200';
                    html += `
                    <div class="${borderClass}">
                        <input type="radio" id="${key}" name="payment-method" value="${key}" class="payment-radio" ${index === 0 ? 'checked' : ''}>
                        <label for="${key}" class="payment-label">
                            <div class="form-payment-logo-container">
                                <img src="${account.logo}" alt="Logo ${account.displayName}" class="payment-logo">
                            </div>
                            <span class="font-medium text-gray-800 flex-grow google-sans text-sm">${account.displayName}</span>
                            <span class="custom-radio-button"><span class="dot"></span></span>
                        </label>
                    </div>
                `;
                });

                html += `</div>`;
                html += `
                <div class="bg-gray-50 p-3 mt-4 rounded-xl text-center text-xs text-gray-600">
                    <i class="fas fa-shield-alt text-green-600 mr-2"></i>
                    Pembayaran aman dan terenkripsi.
                </div>
            `;
                return html;
            };


            const getOrderDetailsHTML = (pkg, totalPrice) => {
                return `
            <div class="mt-0 pt-2 border-m3-outline-variant">
                 <h3 class="text-lg font-bold mb-4 google-sans">Rincian Pesanan</h3>
                 <div class="space-y-3 text-m3-on-surface-variant">
                     <div class="flex justify-between items-center">
                         <span class="text-sm">${pkg.name}</span>
                         <div class="text-right">
                             <span class="font-semibold text-m3-on-surface text-md">${formatCurrency(pkg.price)}</span>
                         </div>
                     </div>
                     <div class="flex justify-between">
                         <span class="text-xs">Kode Unik</span>
                         <span class="font-medium text-m3-on-surface text-sm">${formatCurrency(uniqueCode)}</span>
                     </div>
                     <hr class="my-2 border-m3-outline-variant">
                     <div class="flex justify-between font-bold text-lg text-m3-on-surface google-sans">
                         <span>Total</span>
                         <span class="text-google-blue">${formatCurrency(totalPrice)}</span>
                     </div>
                 </div>
            </div>`;
            }

            // --- MODIFIED: getTestimonialsHTML for Carousel ---
            const getTestimonialsHTML = (pkg) => {
                const images = pkg.testimonials;

                // Create the HTML for a single set of images
                const singleTrackHTML = images.map((url, index) => `
                <div class="testimonial-slide">
                    <img src="${url}" alt="Testimoni Pelanggan ${index + 1}" class="testimonial-image" onclick="openImageModal(event, ${index})" onerror="this.onerror=null;this.src='https://placehold.co/300x400/e2e8f0/4a5568?text=Gagal\nMuat';">
                </div>
            `).join('');

                return `
            <div class="material-card p-3 md:p-4 rounded-2xl">
                <h2 class="text-xl font-bold text-center mb-2 google-sans">Testimoni Pelanggan</h2>
                <p class="text-center text-m3-on-surface-variant text-xs mb-4">Ribuan pelanggan telah merasakan manfaat penyimpanan unlimited</p>
                <div class="testimonial-carousel-container" id="carousel-wrapper">
                    <div class="testimonial-track">
                        ${singleTrackHTML}
                    </div>
                    <div class="testimonial-track" aria-hidden="true">
                        ${singleTrackHTML}
                    </div>
                </div>
            </div>`;
            }

            // --- NEW: Combined Info Section (FAQ + Policy) ---
            const getInfoSectionHTML = (product) => {
                let faqItemsHTML = product.faq.map(item => `
                <details class="faq-item">
                    <summary>${item.q}</summary>
                    <div class="faq-content">${item.a}</div>
                </details>
            `).join('');

                return `
                <h3 class="text-2xl font-bold mb-4 text-center google-sans">Informasi & Bantuan</h3>
                <div class="space-y-0">${faqItemsHTML}</div>
            `;
            };


            // --- FUNCTIONS ---
            function formatCurrency(value) {
                return `Rp${value.toLocaleString('id-ID', { minimumFractionDigits: 0 })}`;
            }

            function getIndonesianTimezone() {
                const offset = new Date().getTimezoneOffset() / -60;
                if (offset === 7) return 'WIB';
                if (offset === 8) return 'WITA';
                if (offset === 9) return 'WIT';
                const sign = offset > 0 ? '+' : '-';
                const hours = Math.abs(Math.floor(offset));
                return `GMT${sign}${String(hours).padStart(2, '0')}:00`;
            }

            function updateDisplay() {
                const product = products[currentProductId];
                const totalPrice = product.price + uniqueCode;

                // Update info produk
                elements.productInfoFormTop.innerHTML = getProductInfoHTML(product);

                // Update detail fitur
                elements.detailsAccordionContainer.innerHTML = getDetailsAccordionHTML(product);

                // Update metode pembayaran
                elements.paymentMethodSelection.innerHTML = getPaymentMethodsHTML(paymentAccounts);

                // Update rincian pesanan
                elements.orderDetailsInForm.innerHTML = getOrderDetailsHTML(product, totalPrice);

                // Update testimoni
                elements.testimonialsFull.innerHTML = getTestimonialsHTML(product);

                // Update FAQ
                elements.infoSectionFull.innerHTML = getInfoSectionHTML(product);
            }


            function generateWaLink(formData, product, totalPrice, paymentMethodName, paymentId) {
                const emailLabel = currentProductId === 'google' ? '*Email Google:*' : '*Email (Apple ID):*';
                const detailPesanan = `${emailLabel} ${formData.get('email')}\n`;
                const pesanWA = `Halo, saya ingin konfirmasi pembayaran untuk pesanan:\n\n` +
                    `*ID Pembayaran:* ${paymentId}\n` +
                    `*Produk:* ${product.name}\n` +
                    `*Metode Pembayaran:* ${paymentMethodName}\n` +
                    `*Nama:* ${formData.get('nama')}\n` +
                    `*No. WhatsApp:* ${formData.get('whatsapp')}\n` +
                    detailPesanan +
                    `*Total Transfer:* ${formatCurrency(totalPrice)}\n\n` +
                    `Saya sudah melakukan transfer. Mohon untuk segera diproses. Terima kasih.`;
                return `https://wa.me/6285602152097?text=${encodeURIComponent(pesanWA)}`;
            }

            function showPaymentInstructions(formData, pkg, totalPrice, paymentAccount, paymentId, paymentMethodKey) {
                window.scrollTo(0, 0); // Scroll to top

                // --- FB Pixel Event Removed ---

                // Store details for the modal
                currentOrderDetails = {
                    pkg,
                    totalPrice,
                    paymentId,
                    nama: formData.get('nama'),
                    whatsapp: formData.get('whatsapp')
                };


                elements.mainContentContainer.parentElement.style.display = 'none';
                elements.footer.style.display = 'none';

                const waLink = generateWaLink(formData, pkg, totalPrice, paymentAccount.displayName, paymentId);

                let accountLabel = 'Nomor Virtual Account';
                let instructionAccordionHTML = '';
                let paymentDetailsBlock = '';
                let paymentDeadlineFormatted = '';

                // Set expiry time (e.g., 24 hours from now)
                expiryTime = new Date(new Date().getTime() + 24 * 60 * 60 * 1000);

                const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                const datePart = expiryTime.toLocaleDateString('id-ID', dateOptions);
                const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
                const timePart = expiryTime.toLocaleTimeString('id-ID', timeOptions).replace(/\./g, ':');
                const timezoneString = `(${getIndonesianTimezone()})`;
                paymentDeadlineFormatted = `${datePart} pukul ${timePart} ${timezoneString}`;


                if (paymentMethodKey === 'qris') {
                    paymentDetailsBlock = `
                    <div class="text-center">
                        <div id="qrcodeContainer" class="bg-white p-3 rounded-xl border-2 border-gray-200 w-full max-w-[250px] h-auto mx-auto my-4 material-card-elevated">
                            <div id="qrcode" class="flex justify-center items-center"></div>
                        </div>
                        <button id="downloadQrisButton" class="cta-button blue-button max-w-xs mx-auto">
                            <i class="fas fa-download mr-2"></i>
                            Unduh QRIS
                        </button>
                        <p class="text-center text-xs text-gray-600 mt-3">Pindai QR Code di atas menggunakan aplikasi perbankan atau e-wallet Anda.</p>
                    </div>
                `;
                } else {
                    paymentDetailsBlock = `
                    <div class="mt-4">
                        <p class="text-xs text-gray-500 mb-1">${accountLabel}</p>
                        <div class="flex justify-between items-center bg-gray-50 p-3 rounded-lg">
                            <p class="text-xl font-bold text-gray-800 tracking-wider google-sans">${paymentAccount.number}</p>
                            <button onclick="copyToClipboard('${paymentAccount.number}', '${accountLabel}')" class="copy-button-text">
                                <i class="far fa-copy mr-1"></i>
                                Salin
                            </button>
                        </div>
                    </div>
                `;
                }

                // --- UPDATED: Detailed Payment Instructions ---
                switch (paymentMethodKey) {
                    case 'qris':
                        instructionAccordionHTML = `
                        <details class="payment-accordion" open><summary>Cara Bayar via QRIS</summary><div class="payment-accordion-content"><ol class="space-y-3">
                            <li>Buka aplikasi perbankan (m-banking) atau e-wallet Anda (GoPay, OVO, DANA, dll).</li>
                            <li>Pilih menu <strong>Bayar</strong>, <strong>Scan QR</strong>, atau <strong>QRIS</strong>.</li>
                            <li>Pindai (scan) kode QR yang ditampilkan di atas.</li>
                            <li>Pastikan nama merchant dan nominal pembayaran sudah sesuai.</li>
                            <li>Masukkan PIN Anda untuk menyelesaikan transaksi.</li>
                            <li>Simpan bukti pembayaran.</li>
                        </ol></div></details>
                    `;
                        break;
                    case 'bca_va':
                        instructionAccordionHTML = `
                        <details class="payment-accordion"><summary>myBCA</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi myBCA dan login.</li>
                            <li>Pilih menu <strong>Transfer</strong>, lalu pilih <strong>Virtual Account</strong>.</li>
                            <li>Pilih <strong>Tujuan Baru</strong>.</li>
                            <li>Masukkan nomor Virtual Account: <strong>${paymentAccount.number}</strong>.</li>
                            <li>Pilih sumber dana yang akan digunakan.</li>
                            <li>Masukkan nominal jika diminta.</li>
                            <li>Periksa detail transaksi, lalu tekan <strong>Lanjut</strong>.</li>
                            <li>Masukkan PIN untuk menyelesaikan transaksi.</li>
                        </ol></div></details>
                        <details class="payment-accordion"><summary>BCA Mobile</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi BCA Mobile dan login.</li>
                            <li>Pilih menu <strong>m-Transfer</strong>, lalu pilih <strong>BCA Virtual Account</strong>.</li>
                            <li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li>
                            <li>Masukkan nominal jika diminta.</li>
                            <li>Periksa nama penerima, lalu tekan <strong>OK</strong>.</li>
                            <li>Masukkan PIN m-BCA untuk menyelesaikan transaksi.</li>
                        </ol></div></details>
                        <details class="payment-accordion"><summary>KlikBCA</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka situs KlikBCA dan login.</li>
                            <li>Pilih menu <strong>Transfer Dana</strong>, lalu pilih <strong>Transfer ke BCA Virtual Account</strong>.</li>
                            <li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li>
                            <li>Masukkan nominal transfer.</li>
                            <li>Tekan <strong>Lanjutkan</strong>, lalu masukkan kode KeyBCA Appli 1.</li>
                            <li>Tekan <strong>Kirim</strong> untuk menyelesaikan transaksi.</li>
                        </ol></div></details>
                        <details class="payment-accordion"><summary>ATM BCA</summary><div class="payment-accordion-content"><ol class="space-y-2">
                           <li>Masukkan kartu ATM BCA dan PIN.</li>
                           <li>Pilih menu <strong>Transaksi Lainnya</strong>.</li>
                           <li>Pilih <strong>Transfer</strong>.</li>
                           <li>Pilih <strong>Ke Rekening BCA Virtual Account</strong>.</li>
                           <li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li>
                           <li>Masukkan nominal jika diminta, lalu konfirmasi.</li>
                        </ol></div></details>
                    `;
                        break;
                    case 'cimb':
                        instructionAccordionHTML = `
                        <details class="payment-accordion"><summary>OCTO Mobile</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi OCTO Mobile dan login.</li>
                            <li>Pilih menu <strong>Transfer</strong>, lalu pilih <strong>Rekening CIMB Niaga</strong>.</li>
                            <li>Masukkan nomor rekening <strong>${paymentAccount.number}</strong>.</li>
                            <li>Pilih sumber dana yang akan digunakan.</li>
                            <li>Tekan <strong>Next</strong>.</li>
                            <li>Periksa nama penerima dan jumlah nominal.</li>
                            <li>Tekan <strong>Konfirmasi</strong>, lalu masukkan dua digit PIN acak yang diminta.</li>
                        </ol></div></details>
                        <details class="payment-accordion"><summary>Transfer dari Bank Lain</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi mobile banking bank pengirim dan login.</li>
                            <li>Pilih menu <strong>Transfer Antar Bank</strong> atau <strong>Transfer ke Bank Lain</strong>.</li>
                            <li>Pilih bank tujuan <strong>CIMB Niaga</strong> dengan kode bank <strong>022</strong>.</li>
                            <li>Masukkan nomor rekening <strong>${paymentAccount.number}</strong>.</li>
                            <li>Masukkan nominal transfer sesuai kebutuhan.</li>
                            <li>Periksa nama penerima, lalu konfirmasi.</li>
                            <li>Masukkan PIN atau kode otentikasi untuk menyelesaikan transaksi.</li>
                        </ol></div></details>
                    `;
                        break;
                    case 'gopay':
                        instructionAccordionHTML = `
                        <details class="payment-accordion"><summary>Aplikasi Gojek (GoPay)</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi Gojek dan login.</li>
                            <li>Tekan menu <strong>Bayar</strong> atau <strong>Transfer</strong>.</li>
                            <li>Pilih <strong>Ke Sesama GoPay</strong> atau <strong>Transfer ke Orang Lain</strong>.</li>
                            <li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li>
                            <li>Masukkan nominal yang akan dikirim.</li>
                            <li>Periksa nama penerima, lalu tekan <strong>Konfirmasi & Bayar</strong>.</li>
                            <li>Masukkan PIN GoPay untuk menyelesaikan transfer.</li>
                        </ol></div></details>
                    `;
                        break;
                    case 'dana':
                        instructionAccordionHTML = `
                        <details class="payment-accordion"><summary>Aplikasi DANA</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi DANA dan login.</li>
                            <li>Tekan menu <strong>Kirim</strong>.</li>
                            <li>Pilih <strong>Kirim ke Nomor HP</strong>.</li>
                            <li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li>
                            <li>Tekan <strong>Lanjut</strong>.</li>
                            <li>Masukkan nominal yang akan dikirim.</li>
                            <li>Pilih sumber dana yang tersedia.</li>
                            <li>Tekan <strong>Kirim Dana</strong>.</li>
                            <li>Masukkan PIN DANA untuk menyelesaikan transaksi.</li>
                        </ol></div></details>
                    `;
                        break;
                    case 'ovo':
                        instructionAccordionHTML = `
                        <details class="payment-accordion"><summary>Aplikasi OVO</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi OVO dan login.</li>
                            <li>Pilih menu <strong>Transfer</strong>.</li>
                            <li>Pilih <strong>Ke Sesama OVO</strong>.</li>
                            <li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li>
                            <li>Masukkan nominal transfer.</li>
                            <li>Tekan <strong>Lanjutkan</strong>.</li>
                            <li>Periksa nama penerima.</li>
                            <li>Tekan <strong>Transfer</strong> untuk menyelesaikan pengiriman dana.</li>
                        </ol></div></details>
                    `;
                        break;
                    default:
                        instructionAccordionHTML = `
                        <details class="payment-accordion"><summary>Instruksi Umum</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi perbankan atau e-wallet Anda.</li>
                            <li>Pilih menu transfer atau pembayaran.</li>
                            <li>Masukkan detail pembayaran yang tertera di atas.</li>
                            <li>Pastikan nominal transfer sesuai dengan total pembayaran hingga digit terakhir.</li>
                            <li>Selesaikan transaksi dan simpan bukti pembayaran Anda.</li>
                        </ol></div></details>
                      `;
                }

                const paymentViewHTML = `
                <div class="payment-header">
                    <h2 class="google-sans">Selesaikan Pembayaran</h2>
                    <div class="countdown-timer" id="countdown-timer-display"></div>
                </div>
                <div class="max-w-lg mx-auto">
                    <div class="p-2 sm:p-4">
                        <div class="payment-card">
                            <h3 class="font-bold text-lg google-sans mb-1">Ringkasan Transaksi</h3>
                            <div class="flex justify-between items-center mt-2 text-xs text-gray-600">
                                <span>Nomor Invoice: <strong>${paymentId}</strong></span>
                                <a href="#" onclick="window.showDetailsModal(event)" class="font-semibold text-google-blue">Lihat detail</a>
                            </div>
                            <hr class="my-4">
                            <p class="text-xs text-gray-600 mb-1">Total Pembayaran</p>
                            <div class="flex items-center justify-between">
                                <p class="text-2xl font-bold text-google-blue google-sans">${formatCurrency(totalPrice)}</p>
                                <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="copy-button-text">
                                    <i class="far fa-copy mr-1"></i>
                                    Salin
                                </button>
                            </div>
                        </div>
                        <div class="payment-card">
                            <h3 class="font-bold text-lg google-sans mb-3">Silahkan Bayar ke</h3>
                            <div class="flex justify-between items-start mt-3">
                                <div>
                                    <p class="text-sm text-gray-500">${paymentAccount.displayName}</p>
                                    <p class="font-semibold text-gray-800 text-md">${paymentAccount.accountHolder}</p>
                                </div>
                                <div class="payment-logo-container">
                                    <img src="${paymentAccount.logo}" alt="Logo ${paymentAccount.displayName}" class="payment-logo">
                                </div>
                            </div>
                            ${paymentDetailsBlock}
                            <div class="mt-6">
                                <p class="text-xs text-gray-500 mb-1">Bayar Sebelum</p>
                                <p class="font-semibold text-gray-800 text-sm">${paymentDeadlineFormatted}</p>
                            </div>
                            <a href="${waLink}" target="_blank" class="block mt-6">
                               <button class="confirm-button-outlined">
                                   <i class="fab fa-whatsapp mr-2"></i>
                                   Konfirmasi Pembayaran
                               </button>
                            </a>
                        </div>
                        <div class="payment-card">
                            <h3 class="font-bold text-lg google-sans mb-2">Cara Membayar</h3>
                            <div class="mt-2">
                                ${instructionAccordionHTML}
                            </div>
                        </div>
                    </div>
                </div>
            `;
                elements.paymentInstructionContainer.innerHTML = paymentViewHTML;
                startCountdown();

                // Generate QR Code if applicable
                if (paymentMethodKey === 'qris') {
                    setTimeout(() => {
                        const qrcodeContainer = document.getElementById('qrcode');
                        if (qrcodeContainer) {
                            try {
                                const qrisStatic = paymentAccount.number;
                                const qrisDinamis = createDynamicQrisString(qrisStatic, { nominal: totalPrice });
                                qrcodeContainer.innerHTML = ''; // Clear previous QR
                                QRCode.toCanvas(qrisDinamis, {
                                    width: 250, margin: 1, errorCorrectionLevel: 'H'
                                }, (err, canvas) => {
                                    if (err) { throw err; }
                                    canvas.style.width = "100%";
                                    canvas.style.height = "auto";
                                    canvas.style.borderRadius = "8px";
                                    qrcodeContainer.appendChild(canvas);

                                    // Add download functionality
                                    document.getElementById('downloadQrisButton').addEventListener('click', () => {
                                        const link = document.createElement('a');
                                        link.download = `QRIS-${paymentId}.png`;
                                        link.href = canvas.toDataURL("image/png");
                                        link.click();
                                    });
                                });
                            } catch (e) {
                                console.error("QRIS Generation Error:", e.message);
                                qrcodeContainer.innerHTML = `<p class="text-red-500 text-sm">Gagal membuat QR Code dinamis. Silakan coba lagi atau hubungi support.</p>`;
                            }
                        }
                    }, 100);
                }
            }

            async function handleFormSubmit() {
                const formData = new FormData(elements.orderForm);
                const nama = formData.get('nama').trim();
                const whatsapp = formData.get('whatsapp').trim();
                const email = formData.get('email').trim();
                const paymentMethodKey = formData.get('payment-method');

                if (!nama || !whatsapp || !email || !paymentMethodKey) {
                    showInfoModal('Data Belum Lengkap', 'Mohon lengkapi semua data yang diperlukan sebelum melanjutkan.');
                    return;
                }

                if (!email.endsWith('@gmail.com') && !email.endsWith('@icloud.com')) {
                    showInfoModal('Email Tidak Valid', 'Harap gunakan alamat email Gmail atau iCloud yang valid.');
                    return;
                }

                const phoneValidationResult = validatePhoneNumber(whatsapp);
                if (!phoneValidationResult.isValid) {
                    showInfoModal('Nomor WhatsApp Tidak Valid', phoneValidationResult.message);
                    return;
                }

                elements.submitBtn.disabled = true;
                elements.submitBtn.innerHTML = '<i class="fas fa-spinner spinner mr-2"></i> Memproses...';

                const product = products[currentProductId];
                const totalPrice = product.price + uniqueCode;
                const paymentAccount = paymentAccounts[paymentMethodKey];
                const now = new Date();
                const paymentId = `INV-${product.id.toUpperCase()}-${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}${String(totalPrice).slice(-3)}`;

                const scriptURL = 'https://script.google.com/macros/s/AKfycbxhoV7ETEYfpe2O4idZQaqCjWMut4RKOJiQ8CF2wIGNDClsRO2IwgkEaGmJAKnM_k5-/exec';
                const dataToSend = {
                    nama: nama,
                    whatsapp: whatsapp,
                    email: email,
                    paket: product.name,
                    metodePembayaran: paymentAccount.displayName,
                    totalTransfer: `Rp${totalPrice.toLocaleString('id-ID')}`,
                    idPembayaran: paymentId,
                    nomorRekening: paymentAccount.number,
                    sheetName: formData.get('sheetName')
                };

                let submissionSuccess = false;
                try {
                    await fetch(scriptURL, {
                        method: 'POST',
                        mode: 'no-cors',
                        cache: 'no-cache',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(dataToSend)
                    });
                    submissionSuccess = true;
                } catch (error) {
                    console.error('Error submitting data:', error);
                    submissionSuccess = false;
                }

                elements.submitBtn.disabled = false;
                elements.submitBtn.innerHTML = '<i class="fas fa-shopping-cart mr-2"></i> Beli Sekarang';

                if (submissionSuccess) {
                    showPaymentInstructions(formData, product, totalPrice, paymentAccount, paymentId, paymentMethodKey);
                } else {
                    showInfoModal('Pengiriman Gagal', 'Maaf, terjadi kesalahan saat mengirim data Anda. Silakan coba lagi atau hubungi kami.');
                }
            }

            // --- NEW: Countdown Timer Function ---
            function startCountdown() {
                const countdownElement = document.getElementById('countdown-timer-display');
                if (!countdownElement || !expiryTime) return;

                const interval = setInterval(() => {
                    const now = new Date().getTime();
                    const distance = expiryTime - now;

                    if (distance < 0) {
                        clearInterval(interval);
                        countdownElement.innerHTML = "Waktu Habis";
                        return;
                    }

                    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                    countdownElement.innerHTML = `
                    <div class="countdown-item">
                        <span class="countdown-number">${String(hours).padStart(2, '0')}</span> Jam
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${String(minutes).padStart(2, '0')}</span> Menit
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${String(seconds).padStart(2, '0')}</span> Detik
                    </div>
                `;
                }, 1000);
            }

            // --- NOTIFICATION FUNCTIONS ---
            const FIRST_NAMES = ["Budi Santoso", "Ayu", "Rahmat", "Citra Dewi Kusuma", "Bayu Pratama", "Lina", "Wulan", "Adi", "Farhan Syahputra", "Hendra Wijaya", "Nana Puspita Dewi", "Joko", "Mega Sari", "Gilang Pramana Putra", "Sari", "Dedi", "Eka Suryani", "Teguh", "Putri Lestari Ayu", "Andi", "Bagus Wijaya", "Ilham Saputra Nugraha", "Rizal", "Mira Astuti", "Puspita", "Hari", "Tri Saputra", "Cahya Pratama", "Surya Darmawan Putra", "Wahyu Ramadhan", "Agus", "Indra Permana", "Linda", "Fajar Mahendra Saputra", "Yusuf", "Pramono Adi Nugroho", "Sinta Dewi", "Bima Pratama", "Dian", "Hasan Basri", "Nurul Aini", "Arif Budiman", "Feri", "Lukman Hakim", "Rangga", "Rini Anggraini Putri", "Tono", "Hadi Prasetyo", "Elisa Purnama", "Anisa Rahma", "Gunawan", "Melati", "Bagus Prasetyo Ramadhan", "Septi Amelia", "Cindy Amelia", "Windi Saputri", "Galih Pratama", "Evi", "Putra", "Slamet Riyadi", "Latif Hidayat", "Gita Puspita", "Darmawan", "Maya", "Erik Saputra Pratama", "Jani", "Jefri Maulana", "Bella Sari", "Maulana", "Novi Andriana Lestari", "Fajar Nugroho", "Taufik Hidayat", "Prasetyo", "Samsul", "Agung", "Endang", "Indah", "Hana Pertiwi", "Mirna", "Yulia", "Panca", "Niken", "Rio", "Adi Putra Ramadhan", "Ganda", "Wahida", "Robby Saputra", "Halim", "Firman Saputra", "Berlian Putra", "Ari", "Joko Setiawan", "Mustika", "Bahar", "Mega", "Erlangga", "Sofyan", "Doni", "Fatimah", "Dian Purnama Sari", "Rama", "Imam Saputra", "Johan", "Gusman", "Lintang", "Nabila", "Beni", "Purnama", "Murni", "Malik", "Nurlan", "Doni Saputra", "Lastri", "Berlinda", "Rasyid", "Tari", "Nia", "Tirta", "Juli Andriani", "Lutfi", "Suci", "Arman", "Yani", "Citra Ayu", "Harto", "Rangga Pratama", "Febrina", "Indra Gunawan Saputra", "Tomi", "Sutrisno", "Risma", "Jihan Ayu Pratiwi", "Lestari", "Dewi Kusuma", "Fahmi", "Rifki", "Wira", "Putra Wijaya", "Beni Setiawan", "Asep", "Gerry", "Prasetia", "Euis", "Latif", "Pajar", "Rahmat Hidayat", "Rudi", "Tika", "Danu", "Hesti", "Syahrul", "Anwar", "Miranti", "Nuraini", "Nurman", "Eman Kurnia", "Nirmala", "Hari Susanto", "Taufan", "Tono Prabowo", "Bayu Saputra Nugroho", "Darma", "Nurlaila", "Hafid", "Mustofa", "Elok", "Gunarto", "Novi", "Lasman", "Jamaludin", "Andi Wijaya Putra", "Herman", "Mila", "Wibowo", "Prayitno", "Adi Saputra", "Jamal", "Irfan", "Iskandar", "Yudha", "Lutris", "Samsul Hidayat", "Heru", "Bagus", "Rudianto", "Nanda Putri", "Laila Rahma", "Frans", "Hilda", "Cahya", "Rudi Pratama", "Setiawan", "Rangga Saputra", "Puspa", "Doni Prasetyo", "Nurul", "Febri", "Mega Sari Lestari", "Suyatno", "Tomiadi", "Fikri", "Lani", "Intan", "Johan Saputra", "Iwan", "Berliano", "Ilham", "Teddy", "Lani Puspita", "Eka Putri Andayani", "Hani", "Adi Wijaya", "Adit", "Dicky", "Gopal", "Pramono", "Gunadi", "Gilang", "Joko Prayitno Adi", "Mira", "Puspita Sari", "Maulana Hakim", "Putri Ayu Lestari", "Malik Prasetyo", "Toriq", "Joni", "Gilang Pratama", "Bagus Wijaya Putra", "Berlian", "Wandi", "Nurman Saputra", "Fajarudin", "Lutfi Pratama", "Citra", "Nanda", "Laras", "Tuti", "Yani Pratiwi", "Gusman Saputra", "Rangga Putra", "Prasetiawan", "Ismail", "Heri", "Adi Nugroho", "Putri", "Prasetyo Adi", "Dona", "Gani", "Jihan", "Puspita Dewi", "Rizal Maulana", "Mahendra", "Ayu Pratiwi", "Rangga Setiawan", "Lina Sari", "Fani", "Adi Wijaya Putra", "Sari Melati", "Andri", "Bima", "Teguh Santoso Adi", "Fajar", "Wulan Dewi", "Rama Pratama", "Nana", "Farhan", "Dion", "Melati Pertiwi", "Adi Putra", "Joko Santoso", "Doni Setiawan", "Lintang Pertiwi", "Septi", "Gopal Pramana", "Tomi Pratama", "Rio Nugraha", "Cindy", "Hafid Saputra", "Hendra", "Niken Lestari", "Rangga Nugroho", "Putri Ayu", "Sofyan Hidayat", "Robby", "Bima Saputra", "Indra", "Adi Kurniawan", "Nanda Saputra", "Gilang Saputra", "Wahyu", "Puspita Ayu", "Rudi Hartono", "Wulan Dewi Pertiwi", "Ayu Pratiwi Lestari", "Tono Adi", "Dedi Kurniawan", "Prasetyo Ramadhan", "Adi Setiawan", "Mira Lestari", "Farhan Syahputra Adi", "Nurul Hidayah", "Sari Anggraini", "Bayu", "Eman", "Putra Adi Nugroho", "Lestari Ayu", "Bambang", "Rangga Hidayat", "Mega Putri", "Adi Nugraha", "Anisa", "Siska", "Wandi Putra", "Fajar Saputra", "Gunawan Pratama", "Heri Setiawan", "Arif", "Ilham Nugroho", "Bagus Pratama", "Erlangga Putra", "Rian", "Pandu", "Tari Ayu", "Hendro", "Risma Ayu", "Adi Pratama", "Septi Ayu", "Bambang Santoso", "Lukman", "Gani Saputra", "Hasan", "Feri Kurniawan", "Tirta", "Bambang Prasetyo", "Pajar Saputra", "Arman Putra", "Murni Ayu", "Hafiz", "Euis Sari", "Bayu Nugroho", "Tomi Saputra", "Gerry Pratama", "Arif Prasetyo", "Johan Putra", "Hafid Nugraha", "Nabila Pertiwi", "Latif Saputra", "Ari Saputra", "Rio Saputra", "Tono Saputra", "Wandi Saputra", "Mahendra Putra", "Ilham Pratama", "Putri Dewi", "Adi Lestari", "Rangga Maulana", "Bayu Hidayat", "Fani Puspita", "Taufik", "Bagus Saputra", "Novi Puspita", "Rahmat Hidayatullah Putra", "Prayitno Saputra", "Adi Ramadhan", "Bayu Wijaya", "Gilang Nugraha", "Rangga Prasetyo", "Putra Purnama", "Wulan Pertiwi", "Adi Wijaya Ramadhan", "Budi", "Rian Pratama", "Samsul Nugroho", "Wahyu Saputra", "Teguh Prasetyo", "Fikri Nugraha", "Rizki Pratama"];

            function getRandomElement(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
            function generateRandomName() { return `${getRandomElement(FIRST_NAMES)}`; }

            function showNextNotification() {
                if (!elements.notifBox || !elements.notifName) return;
                elements.notifName.textContent = generateRandomName();
                elements.notifBox.classList.remove('show');
                void elements.notifBox.offsetWidth; // Trigger reflow
                elements.notifBox.classList.add('show');
            }

            function scheduleNextNotification() {
                const randomDelay = Math.floor(Math.random() * 10000) + 8000;
                setTimeout(() => {
                    showNextNotification();
                    scheduleNextNotification();
                }, randomDelay);
            }

            // --- INITIALIZATION ---
            elements.currentYear.textContent = new Date().getFullYear();
            elements.submitBtn.addEventListener('click', handleFormSubmit);



            updateDisplay();

            if (elements.notifBox && elements.notifName) {
                setTimeout(scheduleNextNotification, 6000);
            }

            // --- REVISED: DETAILS MODAL LOGIC ---
            function getDetailsModalHTML(details) {
                const { pkg, totalPrice, paymentId, nama, whatsapp } = details;
                return `
                <div class="details-modal-header">
                    <h3>Ringkasan Transaksi</h3>
                    <button class="details-modal-close" onclick="closeDetailsModal()">&times;</button>
                </div>
                <div class="details-modal-body">
                    <p class="text-sm text-gray-500 mb-6">Nomor Invoice: <strong>${paymentId}</strong></p>
                    <div class="text-center mb-8">
                        <p class="text-sm text-gray-600 mb-2">Total Pembayaran</p>
                        <div class="flex items-center justify-center">
                            <p class="text-4xl font-bold text-google-blue google-sans">${formatCurrency(totalPrice)}</p>
                            <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="copy-button-text">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    <div class="space-y-4 border-t border-b border-gray-200 py-6 mb-6">
                        <div>
                            <div class="flex justify-between text-base">
                                <span>${pkg.name}</span>
                                <span class="font-semibold text-gray-800">${formatCurrency(pkg.price)}</span>
                            </div>
                            <div class="flex justify-between text-sm text-gray-500 mt-1">
                                <span>1x ${formatCurrency(pkg.price)}</span>
                            </div>
                        </div>
                         <div class="flex justify-between text-sm">
                            <span class="text-gray-500">Kode Unik</span>
                            <span class="font-medium">${formatCurrency(uniqueCode)}</span>
                        </div>
                    </div>
                    <div class="space-y-3 mb-8">
                        <div class="flex justify-between text-base">
                            <span class="text-gray-600">Subtotal</span>
                            <span>${formatCurrency(totalPrice)}</span>
                        </div>
                        <div class="flex justify-between font-bold text-xl google-sans">
                            <span>Total Pembayaran</span>
                            <span class="text-google-blue">${formatCurrency(totalPrice)}</span>
                        </div>
                    </div>
                    <div class="border-t border-gray-200 pt-6">
                        <h4 class="font-semibold mb-4 google-sans">Informasi Pelanggan</h4>
                        <div class="grid grid-cols-2 gap-6">
                            <div>
                                <p class="text-gray-500 text-sm mb-1">Nama</p>
                                <p class="font-medium">${nama}</p>
                            </div>
                            <div>
                                <p class="text-gray-500 text-sm mb-1">Nomor Telepon</p>
                                <p class="font-medium">${whatsapp}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            }

            window.showDetailsModal = function (event) {
                event.preventDefault();
                elements.detailsModalContent.innerHTML = getDetailsModalHTML(currentOrderDetails);
                elements.detailsModal.style.display = 'flex';
                elements.detailsModalContent.classList.remove('is-closing');
                elements.detailsModalContent.classList.add('is-open');
            }

            window.closeDetailsModal = function () {
                elements.detailsModalContent.classList.remove('is-open');
                elements.detailsModalContent.classList.add('is-closing');
                setTimeout(() => {
                    elements.detailsModal.style.display = 'none';
                }, 300); // Match animation duration
            }


            window.closeDetailsModal = function () {
                elements.detailsModalContent.classList.remove('is-open');
                elements.detailsModalContent.classList.add('is-closing');
                setTimeout(() => {
                    elements.detailsModal.style.display = 'none';
                }, 300); // Match animation duration
            }

            // --- Image Modal Functions ---
            const imageModal = document.getElementById('imageModal');
            const modalImg = document.getElementById("modalImage");
            let currentImageIndex;

            window.openImageModal = function (event, index) {
                event.stopPropagation();
                imageModal.style.display = "flex"; // Gunakan flexbox untuk centering
                showImage(index);
            }

            window.closeImageModal = function () {
                imageModal.style.display = "none";
            }

            function showImage(index) {
                const currentProduct = products[currentProductId];
                if (!currentProduct || !currentProduct.testimonials) return;
                if (index >= currentProduct.testimonials.length || index < 0) {
                    return; // Keluar jika index di luar batas
                }
                currentImageIndex = index;
                modalImg.src = currentProduct.testimonials[index];

                // Perbarui visibilitas tombol navigasi
                const prevButton = document.querySelector('.modal-nav.prev');
                const nextButton = document.querySelector('.modal-nav.next');
                if (prevButton) prevButton.style.display = (index > 0) ? 'flex' : 'none';
                if (nextButton) nextButton.style.display = (index < currentProduct.testimonials.length - 1) ? 'flex' : 'none';
            }

            window.showNextImage = function () {
                showImage(currentImageIndex + 1);
            }

            window.showPrevImage = function () {
                showImage(currentImageIndex - 1);
            }

            document.addEventListener('keydown', function (event) {
                if (imageModal && imageModal.style.display === 'flex') {
                    if (event.key === 'ArrowRight') {
                        showNextImage();
                    } else if (event.key === 'ArrowLeft') {
                        showPrevImage();
                    } else if (event.key === 'Escape') {
                        closeImageModal();
                    }
                }
            });

            window.addEventListener('click', function (event) {
                if (event.target == elements.detailsModal) {
                    closeDetailsModal();
                }
                if (event.target == imageModal) {
                    closeImageModal();
                }
            });


        });

        // --- GLOBAL HELPER FUNCTIONS ---
        const infoModal = document.getElementById('infoModal');

        function showInfoModal(title, message) {
            if (!infoModal) return;
            infoModal.querySelector('#modalTitle').textContent = title;
            infoModal.querySelector('#modalMessage').textContent = message;
            infoModal.style.display = 'flex';
        }

        function closeInfoModal() {
            if (!infoModal) return;
            infoModal.style.display = 'none';
        }

        window.onclick = function (event) {
            if (event.target == infoModal) { closeInfoModal(); }
            // The other onclick handlers are now inside DOMContentLoaded
        }

        function copyToClipboard(text, entityName) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showInfoModal('Berhasil Disalin!', `${entityName} telah disalin ke clipboard.`);
            } catch (err) {
                showInfoModal('Gagal!', 'Gagal menyalin. Silakan coba secara manual.');
            }
            document.body.removeChild(textArea);
        }

        // --- UPDATED QRIS LOGIC ---
        function toCRC16(input) {
            let crc = 0xFFFF;
            for (let i = 0; i < input.length; i++) {
                crc ^= input.charCodeAt(i) << 8;
                for (let j = 0; j < 8; j++) {
                    crc = crc & 0x8000 ? (crc << 1) ^ 0x1021 : crc << 1;
                }
            }
            return (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
        }

        function createDynamicQrisString(qris, { nominal }) {
            if (!qris) throw new Error('Parameter "qris" (string QRIS statis) dibutuhkan.');
            if (nominal === undefined) throw new Error('Parameter "nominal" dibutuhkan.');

            let qrisModified = qris.slice(0, -4).replace("010211", "010212");
            const nominalStr = String(Math.round(nominal));
            const amountLength = nominalStr.length < 10 ? "0" + nominalStr.length : nominalStr.length.toString();
            const amountPart = "54" + amountLength + nominalStr;

            if (!qrisModified.includes("5802ID")) {
                throw new Error("Format string QRIS tidak dikenali (tidak ditemukan '5802ID').");
            }

            let finalQris = qrisModified.replace("5802ID", amountPart + "5802ID");
            const crc = toCRC16(finalQris);

            return finalQris + crc;
        }
    </script>
</body>
</html>
