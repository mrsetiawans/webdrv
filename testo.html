<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upgrade Google Drive & Photos Unlimited - Penawaran Spesial!</title>
    <link rel="icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Google_Drive_icon_%282020%29.svg/330px-Google_Drive_icon_%282020%29.svg.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;600;700&family=Roboto:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>

    <!-- === KODE FACEBOOK PIXEL DIMULAI DI SINI === -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '630583642253416');
      fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=630583642253416&ev=PageView&noscript=1"
    /></noscript>
    <!-- === AKHIR DARI KODE FACEBOOK PIXEL === -->

    <style>
        /* Google Material Design System */
        :root {
            /* Google Colors */
            --google-blue: #1a73e8;
            --google-blue-hover: #1557b0;
            --google-blue-light: #e8f0fe;
            --google-blue-dark: #174ea6;
            --google-grey-50: #fafafa;
            --google-grey-100: #f5f5f5;
            --google-grey-200: #e0e0e0;
            --google-grey-300: #bdbdbd;
            --google-grey-400: #9e9e9e;
            --google-grey-500: #757575;
            --google-grey-600: #616161;
            --google-grey-700: #424242;
            --google-grey-800: #303030;
            --google-grey-900: #202124;
            
            /* Google Shadows */
            --shadow-1: 0 1px 2px 0 rgba(60,64,67,.3), 0 1px 3px 1px rgba(60,64,67,.15);
            --shadow-2: 0 1px 2px 0 rgba(60,64,67,.3), 0 2px 6px 2px rgba(60,64,67,.15);
            --shadow-3: 0 4px 8px 3px rgba(60,64,67,.15), 0 1px 3px rgba(60,64,67,.3);
            --shadow-4: 0 8px 12px 6px rgba(60,64,67,.15), 0 4px 4px rgba(60,64,67,.3);
            
            /* Google Borders */
            --border-radius-small: 4px;
            --border-radius-medium: 8px;
            --border-radius-large: 12px;
            --border-radius-xl: 16px;
        }

        /* Typography - Google Sans */
        body {
            font-family: 'Google Sans', 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: #ffffff;
            color: var(--google-grey-900);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Google Material Design Animations */
        * {
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        /* Header dengan Google Style */
        .google-header {
            background: linear-gradient(135deg, #ffffff 0%, var(--google-grey-50) 100%);
            border-bottom: 1px solid var(--google-grey-200);
            padding: 16px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        /* Cards dengan Google Material Design */
        .google-card {
            background: #ffffff;
            border-radius: var(--border-radius-large);
            box-shadow: var(--shadow-1);
            border: 1px solid var(--google-grey-200);
            overflow: hidden;
            transition: box-shadow 0.3s cubic-bezier(0.4, 0.0, 0.2, 1), transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .google-card:hover {
            box-shadow: var(--shadow-2);
            transform: translateY(-2px);
        }

        /* Input Fields - Material Design */
        .google-input {
            width: 100%;
            padding: 16px;
            border: 2px solid var(--google-grey-300);
            border-radius: var(--border-radius-medium);
            background-color: #ffffff;
            font-size: 16px;
            font-family: 'Google Sans', sans-serif;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            outline: none;
        }

        .google-input:focus {
            border-color: var(--google-blue);
            box-shadow: 0 0 0 1px var(--google-blue);
            background-color: #ffffff;
        }

        .google-input:hover:not(:focus) {
            border-color: var(--google-grey-400);
        }

        /* Floating Labels */
        .input-group {
            position: relative;
            margin-bottom: 24px;
        }

        .floating-label {
            position: absolute;
            left: 16px;
            top: 16px;
            color: var(--google-grey-500);
            font-size: 16px;
            font-weight: 400;
            pointer-events: none;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            background: #ffffff;
            padding: 0 4px;
        }

        .google-input:focus + .floating-label,
        .google-input:not(:placeholder-shown) + .floating-label {
            top: -8px;
            left: 12px;
            font-size: 12px;
            color: var(--google-blue);
            font-weight: 500;
        }

        /* Google Buttons */
        .google-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border-radius: var(--border-radius-medium);
            font-family: 'Google Sans', sans-serif;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            border: none;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .google-btn-primary {
            background-color: var(--google-blue);
            color: #ffffff;
            box-shadow: var(--shadow-1);
        }

        .google-btn-primary:hover {
            background-color: var(--google-blue-hover);
            box-shadow: var(--shadow-2);
            transform: translateY(-1px);
        }

        .google-btn-primary:active {
            transform: translateY(0);
            box-shadow: var(--shadow-1);
        }

        .google-btn-outlined {
            background-color: transparent;
            color: var(--google-blue);
            border: 1px solid var(--google-grey-300);
        }

        .google-btn-outlined:hover {
            background-color: var(--google-blue-light);
            border-color: var(--google-blue);
        }

        /* Ripple Effect untuk Buttons */
        .google-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: width 0.6s, height 0.6s, top 0.6s, left 0.6s;
            transform: translate(-50%, -50%);
        }

        .google-btn:active::before {
            width: 300px;
            height: 300px;
        }

        /* Segmented Control - Google Style */
        .google-segmented {
            display: flex;
            background-color: var(--google-grey-100);
            border-radius: var(--border-radius-medium);
            padding: 4px;
            position: relative;
            box-shadow: inset 0 1px 2px rgba(60,64,67,.1);
        }

        .google-segmented input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .google-segmented label {
            flex: 1;
            text-align: center;
            padding: 12px 16px;
            cursor: pointer;
            z-index: 2;
            transition: color 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
            color: var(--google-grey-600);
            font-weight: 500;
            font-size: 14px;
            border-radius: var(--border-radius-small);
        }

        .google-segmented input[type="radio"]:checked + label {
            color: var(--google-blue);
        }

        .google-segmented-pill {
            position: absolute;
            top: 4px;
            bottom: 4px;
            width: calc((100% - 8px) / 3);
            background-color: #ffffff;
            border-radius: var(--border-radius-small);
            box-shadow: var(--shadow-1);
            z-index: 1;
            transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .google-segmented input#pkg-drive:checked ~ .google-segmented-pill {
            transform: translateX(0%);
        }
        .google-segmented input#pkg-photos:checked ~ .google-segmented-pill {
            transform: translateX(100%);
        }
        .google-segmented input#pkg-bundle:checked ~ .google-segmented-pill {
            transform: translateX(200%);
        }

        /* Product Info Card */
        .product-hero {
            background: linear-gradient(135deg, var(--google-blue-light) 0%, #ffffff 100%);
            border: 1px solid var(--google-grey-200);
            border-radius: var(--border-radius-large);
            padding: 32px;
            margin-bottom: 24px;
        }

        /* Feature List */
        .feature-list {
            background: var(--google-grey-50);
            border-radius: var(--border-radius-large);
            padding: 24px;
        }

        .feature-item {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            margin-bottom: 16px;
        }

        .feature-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* Payment Methods */
        .payment-option {
            border: 2px solid var(--google-grey-200);
            border-radius: var(--border-radius-medium);
            margin-bottom: 8px;
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .payment-option:hover {
            border-color: var(--google-grey-300);
            box-shadow: var(--shadow-1);
        }

        .payment-option input[type="radio"]:checked + label {
            background-color: var(--google-blue-light);
            border-color: var(--google-blue);
        }

        .payment-label {
            display: flex;
            align-items: center;
            padding: 16px;
            cursor: pointer;
            border-radius: var(--border-radius-medium);
        }

        /* Modal dengan Google Design */
        .google-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(32, 33, 36, 0.6);
            backdrop-filter: blur(4px);
            justify-content: center;
            align-items: center;
        }

        .google-modal-content {
            background-color: #ffffff;
            margin: auto;
            padding: 24px;
            width: 90%;
            max-width: 400px;
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-4);
            text-align: center;
            position: relative;
            animation: modalSlideIn 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* Testimonials Grid */
        .testimonial-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }

        .testimonial-item {
            border-radius: var(--border-radius-large);
            overflow: hidden;
            box-shadow: var(--shadow-1);
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            cursor: pointer;
        }

        .testimonial-item:hover {
            box-shadow: var(--shadow-3);
            transform: translateY(-4px) scale(1.02);
        }

        .testimonial-item img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* FAQ dengan Material Design */
        .faq-container {
            background: #ffffff;
            border-radius: var(--border-radius-large);
            overflow: hidden;
            box-shadow: var(--shadow-1);
        }

        .faq-item {
            border-bottom: 1px solid var(--google-grey-200);
        }

        .faq-item:last-child {
            border-bottom: none;
        }

        .faq-item summary {
            padding: 20px 24px;
            cursor: pointer;
            list-style: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 500;
            color: var(--google-grey-900);
            transition: all 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .faq-item summary:hover {
            background-color: var(--google-grey-50);
        }

        .faq-item[open] summary {
            color: var(--google-blue);
            background-color: var(--google-blue-light);
        }

        .faq-item summary::-webkit-details-marker {
            display: none;
        }

        .faq-item summary::after {
            content: '\f078';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
            color: var(--google-grey-500);
        }

        .faq-item[open] summary::after {
            transform: rotate(180deg);
            color: var(--google-blue);
        }

        .faq-content {
            padding: 0 24px 20px 24px;
            color: var(--google-grey-600);
            line-height: 1.6;
        }

        /* Notification Toast */
        .google-toast {
            position: fixed;
            top: 24px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--google-grey-800);
            color: #ffffff;
            border-radius: 24px;
            box-shadow: var(--shadow-3);
            padding: 12px 24px;
            display: none;
            align-items: center;
            gap: 12px;
            max-width: 400px;
            z-index: 1001;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .google-toast.show {
            display: flex;
            opacity: 1;
            animation: toastSlideIn 4s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        @keyframes toastSlideIn {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            10%, 90% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
        }

        /* Security Badges */
        .security-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            background: var(--google-grey-50);
            border: 1px solid var(--google-grey-200);
            border-radius: var(--border-radius-medium);
            font-size: 14px;
            font-weight: 500;
            color: var(--google-grey-700);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .google-card {
                margin: 16px;
                border-radius: var(--border-radius-medium);
            }
            
            .product-hero {
                padding: 24px;
                margin: 16px;
            }
            
            .testimonial-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
        }

        /* Loading States */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid var(--google-grey-300);
            border-top: 2px solid var(--google-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Additional Google-style enhancements */
        .price-display {
            font-family: 'Google Sans', sans-serif;
            font-weight: 600;
            color: var(--google-blue);
            font-size: 2.5rem;
        }

        .section-title {
            font-family: 'Google Sans', sans-serif;
            font-weight: 600;
            color: var(--google-grey-900);
            margin-bottom: 16px;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--google-grey-100);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--google-grey-400);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--google-grey-500);
        }

        /* Focus indicators */
        .google-btn:focus-visible,
        .google-input:focus-visible {
            outline: 2px solid var(--google-blue);
            outline-offset: 2px;
        }

        /* Payment instruction styles */
        .payment-header {
            background: linear-gradient(135deg, var(--google-grey-900) 0%, var(--google-grey-800) 100%);
            color: #ffffff;
            padding: 20px;
            text-align: center;
            border-radius: var(--border-radius-large) var(--border-radius-large) 0 0;
        }

        .countdown-timer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            margin-top: 12px;
        }

        .countdown-number {
            background-color: #ea4335;
            color: white;
            padding: 6px 12px;
            border-radius: var(--border-radius-small);
            font-weight: 600;
            font-size: 16px;
            font-family: 'Google Sans', sans-serif;
        }

        .payment-card {
            background: #ffffff;
            border: 1px solid var(--google-grey-200);
            border-radius: var(--border-radius-large);
            padding: 24px;
            margin-top: 16px;
            box-shadow: var(--shadow-1);
        }
    </style>
</head>
<body class="antialiased">
    <!-- Header Google Style -->
    <header class="google-header">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Google_Drive_icon_%282020%29.svg/330px-Google_Drive_icon_%282020%29.svg.png" alt="Google Drive" class="h-8 w-8">
                    <h1 class="text-xl font-semibold text-gray-900">Google Storage Upgrade</h1>
                </div>
                <div class="flex items-center gap-4">
                    <div class="security-badge">
                        <i class="fas fa-shield-alt text-green-500"></i>
                        <span>Secure & Verified</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div id="payment-instruction-container">
        <!-- Konten akan di-generate oleh JavaScript -->
    </div>
    
    <div class="min-h-screen bg-gray-50">
        <div id="main-content-container">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Kolom Kiri: Form & Pembayaran -->
                    <div class="lg:col-span-1">
                        <div class="google-card p-8">
                            <!-- Security Badges -->
                            <div class="grid grid-cols-2 gap-4 mb-8">
                                <div class="security-badge">
                                    <i class="fas fa-shield-alt text-green-500"></i>
                                    <span>TRANSAKSI AMAN</span>
                                </div>
                                <div class="security-badge">
                                    <i class="fas fa-hand-holding-usd text-blue-500"></i>
                                    <span>GARANSI UANG KEMBALI</span>
                                </div>
                            </div>
                            
                            <!-- Pemilihan Paket -->
                            <div class="mb-8">
                                <h2 class="section-title text-xl">1. Pilih Paket Anda</h2>
                                <div id="package-selection">
                                    <div class="google-segmented">
                                        <input type="radio" id="pkg-drive" name="package" value="drive" checked>
                                        <label for="pkg-drive">Google<br>Drive</label>
        
                                        <input type="radio" id="pkg-photos" name="package" value="photos">
                                        <label for="pkg-photos">Google<br>Photos</label>
        
                                        <input type="radio" id="pkg-bundle" name="package" value="bundle">
                                        <label for="pkg-bundle">Paket<br>Lengkap</label>
        
                                        <div class="google-segmented-pill"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Info Produk -->
                            <div id="product-info-form-top" class="mb-8"></div>

                            <!-- Fitur -->
                            <div id="features-before-form" class="mb-8"></div>

                            <!-- Form -->
                            <form id="orderForm">
                                <h2 class="section-title text-xl mb-6">2. Lengkapi Data</h2>
                                
                                <div class="input-group">
                                    <input type="text" id="nama" name="nama" class="google-input" placeholder=" " required>
                                    <label for="nama" class="floating-label">Nama Lengkap *</label>
                                </div>
                                
                                <div class="input-group">
                                    <input type="tel" id="whatsapp" name="whatsapp" class="google-input" placeholder=" " required>
                                    <label for="whatsapp" class="floating-label">Nomor WhatsApp *</label>
                                </div>
                                
                                <div class="input-group">
                                    <input type="email" id="email" name="email" class="google-input" placeholder=" " required>
                                    <label for="email" class="floating-label">Alamat Gmail *</label>
                                </div>
                                
                                <!-- Honeypot field -->
                                <input type="text" name="honeypot" style="display: none" tabindex="-1" autocomplete="off">

                                <!-- Metode Pembayaran -->
                                <div id="payment-method-selection" class="mt-8"></div>
                                
                                <!-- Rincian Pesanan -->
                                <div id="order-details-in-form" class="mt-8"></div>
                                
                                <button type="button" id="submit-btn" class="google-btn google-btn-primary w-full mt-8 py-4 text-lg">
                                    <i class="fas fa-shopping-cart mr-2"></i>
                                    Beli Sekarang
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Kolom Kanan: Testimoni, FAQ, Kebijakan -->
                    <div class="lg:col-span-1 space-y-8">
                        <div id="testimonials-full"></div>
                        <div class="google-card p-8">
                            <div id="faq-full"></div>
                        </div>
                        <div class="google-card p-8">
                            <div id="policy-full"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer id="footer" class="text-center py-8 text-gray-500 text-sm bg-white border-t border-gray-200">
            <p>Copyright Â© <span id="currentYear">2025</span> InDrive ID. Semua Hak Dilindungi.</p>
        </footer>
    </div>

    <!-- Modal for Info/Confirmation -->
    <div id="infoModal" class="google-modal">
        <div class="google-modal-content">
            <h3 id="modalTitle" class="text-lg font-semibold mb-4"></h3>
            <p id="modalMessage" class="text-gray-600 mb-6"></p>
            <button class="google-btn google-btn-primary" onclick="closeInfoModal()">Mengerti</button>
        </div>
    </div>

    <!-- Modal untuk Zoom Gambar -->
    <div id="imageModal" class="google-modal">
        <span class="modal-nav prev" onclick="showPrevImage()">&#10094;</span>
        <span class="modal-nav next" onclick="showNextImage()">&#10095;</span>
        <div class="modal-image-wrapper">
            <img class="modal-content-image" id="modalImage">
            <button class="google-btn google-btn-outlined mt-4" onclick="closeImageModal()">Tutup</button>
        </div>
    </div>
    
    <!-- Modal for Transaction Details -->
    <div id="detailsModal" class="google-modal">
        <div class="details-modal-content" id="detailsModalContent">
            <!-- Content will be injected by JS -->
        </div>
    </div>

    <!-- Notification Toast -->
    <div class="google-toast" id="notifBox">
        <div class="notif-icon-wrapper"><i class="far fa-check-circle"></i></div>
        <div class="notif-content-area">
             <div class="notif-message">
                 <div><strong class="notif-name">Nama Acak</strong> baru saja membeli!</div>
                 <div class="notif-time">beberapa detik lalu</div>
             </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {

        // --- ELEMENTS ---
        const elements = {
            mainContentContainer: document.getElementById('main-content-container'),
            paymentInstructionContainer: document.getElementById('payment-instruction-container'),
            footer: document.getElementById('footer'),
            currentYear: document.getElementById('currentYear'),
            productInfoFormTop: document.getElementById('product-info-form-top'),
            featuresBeforeForm: document.getElementById('features-before-form'),
            paymentMethodSelection: document.getElementById('payment-method-selection'),
            orderDetailsInForm: document.getElementById('order-details-in-form'),
            testimonialsFull: document.getElementById('testimonials-full'),
            faqFull: document.getElementById('faq-full'),
            policyFull: document.getElementById('policy-full'),
            orderForm: document.getElementById('orderForm'),
            submitBtn: document.getElementById('submit-btn'),
            notifBox: document.getElementById('notifBox'),
            notifName: document.querySelector('#notifBox .notif-name'),
            detailsModal: document.getElementById('detailsModal'),
            detailsModalContent: document.getElementById('detailsModalContent'),
        };

        // --- CONFIGURATION ---
        const uniqueCode = Math.floor(Math.random() * (500 - 100 + 1)) + 100;
        let countdownInterval;
        let expiryTime;
        let currentOrderDetails = {};
        
        // *** TESTIMONIALS COMBINED ***
        const allTestimonials = [
            "https://s6.imgcdn.dev/YIh45V.png",
            "https://s6.imgcdn.dev/YIhuYh.png",
            "https://s6.imgcdn.dev/YIhCOK.png",
            "https://s6.imgcdn.dev/YIhIgo.png",
            "https://s6.imgcdn.dev/YIhQQO.png",
            "https://s6.imgcdn.dev/YIhiSn.png",
            "https://s6.imgcdn.dev/YIhkeg.png",
            "https://s6.imgcdn.dev/YIhscv.png",
            "https://s6.imgcdn.dev/YIhyaN.png",
            "https://s6.imgcdn.dev/YIh5tq.png",
            "https://s6.imgcdn.dev/YIhPYB.png",
            "https://s6.imgcdn.dev/YIhTKu.png"
        ];

        const packages = {
            drive: {
                id: 'drive',
                name: "Google Drive Unlimited",
                price: 165000,
                normalPrice: 399000,
                title: "GOOGLE DRIVE UNLIMITED",
                priceDisplay: `Rp165.000`,
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Google_Drive_icon_%282020%29.svg/330px-Google_Drive_icon_%282020%29.svg.png',
                description: "Penyimpanan cloud tanpa batas untuk semua file Anda.",
                features: [
                    "<strong>Penyimpanan Cloud Tanpa Batas:</strong> Simpan semua file, dokumen, foto, dan video tanpa khawatir kehabisan ruang.",
                    "<strong>Akses File Di Mana Saja:</strong> Buka dan edit file Anda dari komputer, tablet, atau smartphone.",
                    "<strong>Berbagi & Kolaborasi Mudah:</strong> Bagikan file dan folder dengan mudah, serta bekerja bersama secara real-time.",
                    "<strong>Keamanan Kelas Dunia:</strong> File Anda dilindungi oleh infrastruktur keamanan canggih dari Google.",
                    "<strong>Integrasi Penuh:</strong> Terhubung dengan Google Docs, Sheets, Slides, dan aplikasi favorit lainnya.",
                    "<strong>Sekali Bayar Seumur Hidup:</strong> Tanpa biaya langganan bulanan atau tahunan.",
                    "<strong>Gunakan Akun Pribadi Anda:</strong> Upgrade dilakukan langsung pada akun Google yang sudah Anda miliki.",
                    "<strong>100% Aman & Bergaransi:</strong> Produk asli dengan jaminan privasi penuh."
                ],
                testimonials: allTestimonials
            },
            photos: {
                id: 'photos',
                name: "Google Photos Unlimited",
                price: 165000,
                normalPrice: 399000,
                title: "GOOGLE PHOTOS UNLIMITED",
                priceDisplay: `Rp165.000`,
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Google_Photos_icon_%282020%29.svg/240px-Google_Photos_icon_%282020%29.svg.png',
                description: "Simpan semua foto & video kualitas asli tanpa kompresi.",
                features: [
                    "<strong>Penyimpanan Foto & Video Tanpa Batas:</strong> Upload semua kenangan Anda dalam kualitas asli tanpa kompresi.",
                    "<strong>Pencarian Canggih:</strong> Temukan foto berdasarkan orang, tempat, dan objek di dalamnya.",
                    "<strong>Album Otomatis:</strong> Google Photos secara cerdas membuat album dan kolase untuk Anda.",
                    "<strong>Berbagi dengan Mudah:</strong> Buat album bersama dan bagikan foto dengan keluarga dan teman.",
                    "<strong>Tersinkronisasi di Semua Perangkat:</strong> Foto Anda aman dan dapat diakses dari mana saja.",
                    "<strong>Sekali Bayar Seumur Hidup:</strong> Tanpa biaya langganan bulanan atau tahunan.",
                    "<strong>Akun baru:</strong> Anda akan mendapatkan akun Google baru khusus untuk Photos, dan Anda bisa mengganti passwordnya.",
                    "<strong>100% Aman & Privasi Terjamin:</strong> Foto Anda tetap menjadi milik Anda."
                ],
                testimonials: allTestimonials
            },
            bundle: {
                id: 'bundle',
                name: "Paket Lengkap (Drive + Photos)",
                price: 265000,
                normalPrice: 699000,
                title: "DRIVE + PHOTOS UNLIMITED",
                priceDisplay: `Rp265.000`,
                description: "Dapatkan penyimpanan tanpa batas di Google Drive dan Google Photos.",
                features: [
                    "<strong>Semua Fitur Drive Unlimited:</strong> Penyimpanan file tanpa batas, akses di mana saja, kolaborasi, dan keamanan Google.",
                    "<strong>Semua Fitur Photos Unlimited:</strong> Penyimpanan foto & video kualitas asli tanpa batas, pencarian cerdas, dan album otomatis.",
                    "<strong>Solusi Penyimpanan Lengkap:</strong> Satu paket untuk semua kebutuhan file dan media digital Anda.",
                    "<strong>Harga Terbaik:</strong> Lebih hemat dibandingkan membeli paket secara terpisah.",
                    "<strong>Sekali Bayar Seumur Hidup:</strong> Investasi terbaik untuk mengamankan semua data digital Anda.",
                    "<strong>Upgrade Akun Pribadi Anda:</strong> Semua keuntungan diaktifkan pada satu akun Google.",
                    "<strong>Garansi Penuh & Aman:</strong> Jaminan keamanan, privasi, dan kepuasan pelanggan."
                ],
                testimonials: allTestimonials
            }
        };

        let currentPackageId = 'drive'; // Paket default yang dipilih
        
        // --- UPDATED PAYMENT ACCOUNTS ---
        const paymentAccounts = {
            qris: {
                displayName: 'QRIS',
                accountHolder: 'Epay',
                number: '00020101021126610016ID.CO.SHOPEE.WWW01189360091800223157700208223157700303UMI51440014ID.CO.QRIS.WWW0215ID10254270621910303UMI5204481453033605802ID5904Epay6013JAKARTA PUSAT61051061062070703A0163042F15',
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Logo_QRIS.svg/163px-Logo_QRIS.svg.png',
                type: 'qris',
                category: 'QRIS'
            },
            cimb: { 
                displayName: 'Cimb Niaga',
                accountHolder: 'Octo Pay - 6289510639366', 
                number: '6289510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/CIMB_Niaga_logo.svg/330px-CIMB_Niaga_logo.svg.png', 
                type: 'va',
                category: 'Bank Transfer'
            },
            bca_va: { 
                displayName: 'BCA Virtual Account', 
                accountHolder: 'Epayment', 
                number: '39358089510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/330px-Bank_Central_Asia.svg.png', 
                type: 'va',
                category: 'Bank Transfer'
            },
            gopay: { 
                displayName: 'Gopay', 
                accountHolder: 'Gopay 6289510639366', 
                number: '089510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Gopay_logo.svg/320px-Gopay_logo.svg.png', 
                type: 'ewallet',
                category: 'E-Wallet'
            },
            dana: { 
                displayName: 'DANA', 
                accountHolder: 'DNID089510639366', 
                number: '089510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Logo_dana_blue.svg/330px-Logo_dana_blue.svg.png', 
                type: 'ewallet',
                category: 'E-Wallet'
            },
            ovo: { 
                displayName: 'OVO', 
                accountHolder: 'OVO Epayment', 
                number: '089510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Logo_ovo_purple.svg/330px-Logo_ovo_purple.svg.png', 
                type: 'ewallet',
                category: 'E-Wallet'
            }
        };

        // --- TEMPLATE FUNCTIONS ---
        const getProductInfoHTML = (pkg) => {
            let logoHtml = '';
            if (pkg.id === 'bundle') {
                logoHtml = `
                    <div class="flex justify-center items-center gap-4 h-16">
                        <img alt="Logo Google Drive" class="h-12 w-auto" src="${packages.drive.logo}">
                        <i class="fas fa-plus text-2xl text-gray-400"></i>
                        <img alt="Logo Google Photos" class="h-12 w-auto" src="${packages.photos.logo}">
                    </div>
                `;
            } else {
                logoHtml = `<div class="flex justify-center"><img alt="Logo ${pkg.name}" class="h-12 w-auto" src="${pkg.logo}"></div>`;
            }

            return `
            <div class="product-hero">
                <div class="text-center">
                    ${logoHtml}
                    <h1 class="text-3xl font-bold text-gray-900 mt-4 mb-2">${pkg.title}</h1>
                    <p class="text-lg text-gray-600 mb-6">${pkg.description}</p>
                    <div class="price-display">${pkg.priceDisplay}</div>
                    <p class="text-gray-500 text-sm mt-2">Sekali Bayar Seumur Hidup</p>
                </div>
            </div>`;
        }

        const getFeaturesHTML = (pkg) => {
            const colors = ['bg-blue-500', 'bg-green-500', 'bg-yellow-500', 'bg-red-500', 'bg-purple-500', 'bg-pink-500', 'bg-indigo-500', 'bg-orange-500'];
            return `<div class="feature-list">
                <h3 class="section-title text-lg mb-6">Yang Anda Dapatkan:</h3>
                <div class="space-y-4">${pkg.features.map((f, index) => `
                    <div class="feature-item">
                        <div class="feature-icon ${colors[index % colors.length]} text-white">
                            <i class="fas fa-check text-sm"></i>
                        </div>
                        <span class="text-gray-700 leading-relaxed">${f}</span>
                    </div>
                `).join('')}</div>
            </div>`;
        }
        
        const getPaymentMethodsHTML = (accounts) => {
            const groupedAccounts = {};
            for (const key in accounts) {
                const account = accounts[key];
                if (!groupedAccounts[account.category]) {
                    groupedAccounts[account.category] = [];
                }
                groupedAccounts[account.category].push({ key, ...account });
            }

            let html = `<h2 class="section-title text-xl mb-6">3. Pilih Metode Pembayaran</h2>`;
            const categoryOrder = ['QRIS', 'Bank Transfer', 'E-Wallet'];

            for (const category of categoryOrder) {
                if (groupedAccounts[category]) {
                    html += `<h3 class="text-lg font-medium text-gray-700 mb-4">${category}</h3>`;
                    html += `<div class="space-y-2 mb-6">`;

                    groupedAccounts[category].forEach((account, index) => {
                        const isFirst = index === 0 && category === 'QRIS';
                        
                        html += `
                            <div class="payment-option">
                                <input type="radio" id="${account.key}" name="payment-method" value="${account.key}" class="hidden" ${isFirst ? 'checked' : ''}>
                                <label for="${account.key}" class="payment-label">
                                    <img src="${account.logo}" alt="Logo ${account.displayName}" class="h-6 w-auto mr-4">
                                    <span class="font-medium text-gray-800 flex-grow">${account.displayName}</span>
                                    <div class="w-5 h-5 border-2 border-gray-300 rounded-full flex items-center justify-center">
                                        <div class="w-3 h-3 bg-blue-600 rounded-full opacity-0 transition-opacity"></div>
                                    </div>
                                </label>
                            </div>
                        `;
                    });
                    html += `</div>`;
                }
            }

            html += `
                <div class="bg-gray-50 p-4 rounded-lg text-center text-sm text-gray-600 border border-gray-200">
                    <i class="fas fa-shield-alt text-green-500 mr-2"></i>
                    Pembayaran ini diproses oleh Doku
                </div>
            `;

            return html;
        };

        const getOrderDetailsHTML = (pkg, totalPrice) => `
            <div class="google-card p-6 mt-8">
                 <h3 class="section-title text-lg mb-4">Rincian Pesanan</h3>
                 <div class="space-y-4 text-gray-600">
                     <div class="flex justify-between items-center">
                         <span>${pkg.name}</span>
                         <div class="text-right">
                             <span class="font-medium text-gray-800">${formatCurrency(pkg.price)}</span>
                         </div>
                     </div>
                     <div class="flex justify-between">
                         <span>Kode Unik</span>
                         <span class="font-medium text-gray-800">${formatCurrency(uniqueCode)}</span>
                     </div>
                     <hr class="border-gray-200">
                     <div class="flex justify-between font-bold text-lg text-gray-900">
                         <span>Total</span>
                         <span class="price-display text-xl">${formatCurrency(totalPrice)}</span>
                     </div>
                 </div>
            </div>`;

        const getTestimonialsHTML = (pkg) => {
            let imagesHTML = pkg.testimonials.map((url, index) => `
                <div class="testimonial-item" onclick="openImageModal(event, ${index})">
                    <img src="${url}" alt="Testimoni Pelanggan ${index + 1}" class="w-full h-auto object-cover aspect-[3/4]" onerror="this.onerror=null;this.src='https://placehold.co/300x400/e2e8f0/4a5568?text=Gagal\\nMuat';">
                </div>
            `).join('');

            return `
            <div class="google-card p-8">
                <h2 class="section-title text-2xl text-center mb-8">Testimoni Pelanggan Kami</h2>
                <div class="testimonial-grid">
                    ${imagesHTML}
                </div>
            </div>`;
        }

        const getFaqHTML = () => `
             <div>
                 <h3 class="section-title text-2xl text-center mb-8">Pertanyaan Umum (FAQ)</h3>
                 <div class="faq-container">
                     <details class="faq-item">
                         <summary>Apakah ini benar-benar unlimited dan seumur hidup?</summary>
                         <div class="faq-content">Ya, benar. Anda akan mendapatkan penyimpanan tanpa batas untuk paket yang dipilih (Drive, Photos, atau keduanya) dengan sistem pembayaran sekali untuk selamanya. Tidak ada biaya bulanan atau tahunan tersembunyi.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Bagaimana proses upgrade untuk Google Drive?</summary>
                         <div class="faq-content">Untuk Google Drive, kami akan mengundang akun Gmail pribadi Anda untuk bergabung ke dalam "Shared Drive" khusus yang memiliki kapasitas unlimited. Anda tidak perlu memberikan password, cukup alamat email saja. Shared Drive ini akan muncul di akun Drive Anda dan bisa digunakan untuk menyimpan file apa pun.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Bagaimana proses untuk Google Photos?</summary>
                         <div class="faq-content">Untuk Google Photos Unlimited, Anda akan mendapatkan sebuah akun Google baru yang sudah memiliki fitur penyimpanan foto/video kualitas asli tanpa batas. Anda akan menerima email dan password akun baru tersebut, dan Anda bisa langsung mengganti passwordnya demi keamanan. Akun ini terpisah dari akun utama Anda.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Apakah ini aman dan legal?</summary>
                         <div class="faq-content">Tentu saja. Metode yang kami gunakan adalah sah melalui fitur Google Workspace. Kami tidak pernah meminta password Anda (untuk upgrade Drive) dan privasi file Anda 100% terjamin. Anda memiliki kontrol penuh atas data Anda.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Apa bedanya dengan langganan Google One?</summary>
                         <div class="faq-content">Google One adalah layanan langganan resmi dari Google dengan kuota terbatas (misal 2TB) dan biaya bulanan/tahunan. Produk kami memberikan Anda penyimpanan&nbsp;unlimited&nbsp;dengan sistem&nbsp;sekali bayar untuk selamanya, memanfaatkan fitur Shared Drive.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Bisakah saya memindahkan file lama saya?</summary>
                         <div class="faq-content">Tentu bisa. Anda dapat dengan mudah memindahkan file dan folder dari penyimpanan Drive pribadi Anda ke dalam Shared Drive unlimited yang baru. Untuk Google Photos, Anda perlu memindahkan foto secara manual ke akun baru yang kami berikan.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Berapa lama proses aktivasinya?</summary>
                         <div class="faq-content">Prosesnya sangat cepat. Setelah Anda melakukan konfirmasi pembayaran, aktivasi biasanya selesai dalam waktu 5-15 menit, maksimal 1x24 jam.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Apakah ada garansi?</summary>
                         <div class="faq-content">Kami memberikan garansi uang kembali penuh jika proses upgrade gagal karena kesalahan dari pihak kami. Kami juga memberikan garansi layanan seumur hidup. Namun, garansi tidak berlaku jika akun Anda dibatasi oleh Google karena melanggar kebijakan mereka (misalnya menyimpan file ilegal seperti software bajakan, film/musik tanpa lisensi, konten pornografi, menyebarkan virus/malware, dll).</div>
                     </details>
                 </div>
             </div>
        `;
        
        const getPolicyHTML = () => `
            <div>
                <h3 class="section-title text-2xl text-center mb-6">Kebijakan & Ketentuan</h3>
                <div class="space-y-8 text-sm text-gray-600">
                    <div>
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Kebijakan Privasi</h4>
                        <p class="mb-4 leading-relaxed">Informasi yang Anda berikan (alamat email Google) hanya digunakan untuk keperluan upgrade dan komunikasi terkait pesanan. Kami <strong>tidak pernah</strong> meminta atau menyimpan kata sandi Anda. Semua file Anda tetap sepenuhnya pribadi di bawah kendali Anda dan kebijakan Google.</p>
                        <ul class="list-disc list-inside space-y-2 leading-relaxed">
                            <li>Kami hanya butuh email, bukan password.</li>
                            <li>Informasi pembayaran diproses oleh gateway aman.</li>
                            <li>Data Anda tidak dibagikan ke pihak lain.</li>
                            <li>Kami tidak mengakses file di dalam Drive Anda.</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="text-lg font-semibold mb-3 text-gray-800">Syarat & Ketentuan</h4>
                         <p class="mb-4 leading-relaxed">Dengan menggunakan layanan ini, Anda setuju untuk terikat pada S&K kami. Layanan ini adalah pembayaran satu kali untuk manfaat seumur hidup, tunduk pada kebijakan Google yang berlaku.</p>
                        <ul class="list-disc list-inside space-y-2 leading-relaxed">
                            <li>Layanan untuk penggunaan wajar dan tidak melanggar hukum.</li>
                            <li>Garansi penuh jika upgrade gagal karena kesalahan kami.</li>
                            <li>Garansi tidak mencakup pemblokiran akun akibat pelanggaran oleh pengguna.</li>
                            <li>Perubahan kebijakan Google di masa depan berada di luar kendali kami.</li>
                        </ul>
                    </div>
                </div>
            </div>
        `;

        // --- FUNCTIONS ---
        function formatCurrency(value) {
            return `Rp${value.toLocaleString('id-ID', { minimumFractionDigits: 0 })}`;
        }

        function getIndonesianTimezone() {
            const offset = new Date().getTimezoneOffset() / -60;
            if (offset === 7) return 'WIB';
            if (offset === 8) return 'WITA';
            if (offset === 9) return 'WIT';
            const sign = offset > 0 ? '+' : '-';
            const hours = Math.abs(Math.floor(offset));
            return `GMT${sign}${String(hours).padStart(2, '0')}:00`;
        }

        function updateDisplay() {
            const pkg = packages[currentPackageId];
            const totalPrice = pkg.price + uniqueCode;

            const infoContainer = elements.productInfoFormTop;
            const featuresContainer = elements.featuresBeforeForm;

            // 1. Start fade-out
            infoContainer.style.opacity = '0';
            featuresContainer.style.opacity = '0';

            // 2. Wait for fade-out to finish, then update content and fade-in
            setTimeout(() => {
                // Update the HTML for the transitioning parts
                infoContainer.innerHTML = getProductInfoHTML(pkg);
                featuresContainer.innerHTML = getFeaturesHTML(pkg);

                // Update other parts that don't need transition
                elements.paymentMethodSelection.innerHTML = getPaymentMethodsHTML(paymentAccounts);
                elements.orderDetailsInForm.innerHTML = getOrderDetailsHTML(pkg, totalPrice);
                elements.testimonialsFull.innerHTML = getTestimonialsHTML(pkg);
                elements.faqFull.innerHTML = getFaqHTML();
                elements.policyFull.innerHTML = getPolicyHTML();

                // Update payment method radio button styles
                updatePaymentMethodStyles();

                // 3. Start fade-in
                infoContainer.style.opacity = '1';
                featuresContainer.style.opacity = '1';
            }, 300); // Match CSS transition duration
        }

        function updatePaymentMethodStyles() {
            // Add event listeners for payment method radio buttons
            document.querySelectorAll('input[name="payment-method"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    // Update visual state of all payment options
                    document.querySelectorAll('.payment-option').forEach(option => {
                        const input = option.querySelector('input[type="radio"]');
                        const dot = option.querySelector('.payment-label > div > div');
                        
                        if (input.checked) {
                            option.style.borderColor = 'var(--google-blue)';
                            option.querySelector('.payment-label').style.backgroundColor = 'var(--google-blue-light)';
                            dot.style.opacity = '1';
                        } else {
                            option.style.borderColor = 'var(--google-grey-200)';
                            option.querySelector('.payment-label').style.backgroundColor = 'transparent';
                            dot.style.opacity = '0';
                        }
                    });
                });
            });
        }

        function generateWaLink(formData, pkg, totalPrice, paymentMethodName, paymentId) {
            const detailPesanan = `*Email Google:* ${formData.get('email')}\n`;
            const pesanWA = `Halo, saya ingin konfirmasi pembayaran untuk pesanan:\n\n` +
                          `*ID Pembayaran:* ${paymentId}\n` +
                          `*Paket:* ${pkg.name}\n` +
                          `*Metode Pembayaran:* ${paymentMethodName}\n` +
                          `*Nama:* ${formData.get('nama')}\n` +
                          `*No. WhatsApp:* ${formData.get('whatsapp')}\n` +
                          detailPesanan +
                          `*Total Transfer:* ${formatCurrency(totalPrice)}\n\n` +
                          `Saya sudah melakukan transfer. Mohon untuk segera diproses. Terima kasih.`;
            return `https://wa.me/6285602152097?text=${encodeURIComponent(pesanWA)}`;
        }

        function showPaymentInstructions(formData, pkg, totalPrice, paymentAccount, paymentId, paymentMethodKey) {
            window.scrollTo(0, 0); // Scroll to top
            
            // Store details for the modal
            currentOrderDetails = {
                pkg,
                totalPrice,
                paymentId,
                nama: formData.get('nama'),
                whatsapp: formData.get('whatsapp')
            };

            elements.mainContentContainer.parentElement.style.display = 'none';
            elements.footer.style.display = 'none';
            
            const waLink = generateWaLink(formData, pkg, totalPrice, paymentAccount.displayName, paymentId);
            
            let accountLabel = 'Nomor Virtual Account';
            let instructionAccordionHTML = '';
            let paymentDetailsBlock = '';
            let paymentDeadlineFormatted = '';

            // Set expiry time (e.g., 24 hours from now)
            expiryTime = new Date(new Date().getTime() + 24 * 60 * 60 * 1000);
            
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const datePart = expiryTime.toLocaleDateString('id-ID', dateOptions);
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            const timePart = expiryTime.toLocaleTimeString('id-ID', timeOptions).replace(/\./g, ':');
            const timezoneString = `(${getIndonesianTimezone()})`;
            paymentDeadlineFormatted = `${datePart} pukul ${timePart} ${timezoneString}`;

            if (paymentMethodKey === 'qris') {
                paymentDetailsBlock = `
                    <div class="text-center">
                        <div id="qrcodeContainer" class="bg-white p-4 rounded-lg border border-gray-200 w-full max-w-[280px] mx-auto my-6 shadow-sm">
                            <div id="qrcode" class="flex justify-center items-center"></div>
                        </div>
                        <button id="downloadQrisButton" class="google-btn google-btn-primary max-w-xs mx-auto">
                            <i class="fas fa-download mr-2"></i>
                            Unduh QRIS
                        </button>
                        <p class="text-center text-sm text-gray-600 mt-4">Pindai QR Code di atas menggunakan aplikasi perbankan atau e-wallet Anda.</p>
                    </div>
                `;
            } else {
                 paymentDetailsBlock = `
                    <div class="mt-4">
                        <p class="text-sm text-gray-500 mb-2">${accountLabel}</p>
                        <div class="flex justify-between items-center bg-gray-50 p-4 rounded-lg border">
                            <p class="text-xl font-mono font-semibold text-gray-800 tracking-wider">${paymentAccount.number}</p>
                            <button onclick="copyToClipboard('${paymentAccount.number}', '${accountLabel}')" class="google-btn google-btn-outlined text-sm py-2 px-3">
                                <i class="far fa-copy mr-1"></i>
                                Salin
                            </button>
                        </div>
                    </div>
                `;
            }

            // Payment instructions with Google styling
            switch (paymentMethodKey) {
                case 'qris':
                    instructionAccordionHTML = `
                        <details class="faq-item" open><summary>Cara Bayar via QRIS</summary><div class="faq-content"><ol class="space-y-3 list-decimal list-inside">
                            <li>Buka aplikasi perbankan (m-banking) atau e-wallet Anda (GoPay, OVO, DANA, dll).</li>
                            <li>Pilih menu <strong>Bayar</strong>, <strong>Scan QR</strong>, atau <strong>QRIS</strong>.</li>
                            <li>Pindai (scan) kode QR yang ditampilkan di atas.</li>
                            <li>Pastikan nama merchant dan nominal pembayaran sudah sesuai.</li>
                            <li>Masukkan PIN Anda untuk menyelesaikan transaksi.</li>
                            <li>Simpan bukti pembayaran.</li>
                        </ol></div></details>
                    `;
                    break;
                case 'bca_va':
                    instructionAccordionHTML = `
                        <details class="faq-item"><summary>myBCA</summary><div class="faq-content"><ol class="space-y-2 list-decimal list-inside">
                            <li>Buka aplikasi myBCA dan login.</li>
                            <li>Pilih menu <strong>Transfer</strong>, lalu pilih <strong>Virtual Account</strong>.</li>
                            <li>Pilih <strong>Tujuan Baru</strong>.</li>
                            <li>Masukkan nomor Virtual Account: <strong>${paymentAccount.number}</strong>.</li>
                            <li>Pilih sumber dana yang akan digunakan.</li>
                            <li>Masukkan nominal jika diminta.</li>
                            <li>Periksa detail transaksi, lalu tekan <strong>Lanjut</strong>.</li>
                            <li>Masukkan PIN untuk menyelesaikan transaksi.</li>
                        </ol></div></details>
                        <details class="faq-item"><summary>BCA Mobile</summary><div class="faq-content"><ol class="space-y-2 list-decimal list-inside">
                            <li>Buka aplikasi BCA Mobile dan login.</li>
                            <li>Pilih menu <strong>m-Transfer</strong>, lalu pilih <strong>BCA Virtual Account</strong>.</li>
                            <li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li>
                            <li>Masukkan nominal jika diminta.</li>
                            <li>Periksa nama penerima, lalu tekan <strong>OK</strong>.</li>
                            <li>Masukkan PIN m-BCA untuk menyelesaikan transaksi.</li>
                        </ol></div></details>
                        <details class="faq-item"><summary>KlikBCA</summary><div class="faq-content"><ol class="space-y-2 list-decimal list-inside">
                            <li>Buka situs KlikBCA dan login.</li>
                            <li>Pilih menu <strong>Transfer Dana</strong>, lalu pilih <strong>Transfer ke BCA Virtual Account</strong>.</li>
                            <li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li>
                            <li>Masukkan nominal transfer.</li>
                            <li>Tekan <strong>Lanjutkan</strong>, lalu masukkan kode KeyBCA Appli 1.</li>
                            <li>Tekan <strong>Kirim</strong> untuk menyelesaikan transaksi.</li>
                        </ol></div></details>
                        <details class="faq-item"><summary>ATM BCA</summary><div class="faq-content"><ol class="space-y-2 list-decimal list-inside">
                           <li>Masukkan kartu ATM BCA dan PIN.</li>
                           <li>Pilih menu <strong>Transaksi Lainnya</strong>.</li>
                           <li>Pilih <strong>Transfer</strong>.</li>
                           <li>Pilih <strong>Ke Rekening BCA Virtual Account</strong>.</li>
                           <li>Masukkan nomor <strong>${paymentAccount.number}</strong>.</li>
                           <li>Masukkan nominal jika diminta, lalu konfirmasi.</li>
                        </ol></div></details>
                    `;
                    break;
                // ... (other payment methods remain the same)
            }

            const paymentViewHTML = `
                <div class="payment-header">
                    <h2 class="text-xl font-semibold">Selesaikan Pembayaran</h2>
                    <div class="countdown-timer" id="countdown-timer-display"></div>
                </div>
                <div class="max-w-2xl mx-auto p-6">
                    <div class="payment-card">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-bold text-lg">Ringkasan Transaksi</h3>
                            <a href="#" onclick="showDetailsModal(event)" class="font-semibold text-blue-600 hover:text-blue-800">Lihat detail</a>
                        </div>
                        <div class="text-sm text-gray-600 mb-6">
                            <span>Nomor Invoice: ${paymentId}</span>
                        </div>
                        <div class="text-center py-6 bg-gray-50 rounded-lg mb-6">
                            <p class="text-sm text-gray-600 mb-2">Total Pembayaran</p>
                            <div class="flex items-center justify-center gap-3">
                                <p class="price-display text-3xl">${formatCurrency(totalPrice)}</p>
                                <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="google-btn google-btn-outlined text-sm py-2 px-3">
                                    <i class="far fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-card">
                        <div class="flex justify-between items-center mb-4">
                            <div>
                                <h3 class="font-bold text-lg">Silahkan Bayar ke</h3>
                                <p class="text-sm text-gray-500">${paymentAccount.displayName}</p>
                                <p class="font-semibold text-gray-800">${paymentAccount.accountHolder}</p>
                            </div>
                            <img src="${paymentAccount.logo}" alt="Logo ${paymentAccount.displayName}" class="h-10">
                        </div>
                        ${paymentDetailsBlock}
                        <div class="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                            <p class="text-sm text-yellow-800 font-medium">Bayar Sebelum</p>
                            <p class="font-semibold text-yellow-900">${paymentDeadlineFormatted}</p>
                        </div>
                        <a href="${waLink}" target="_blank" class="block mt-6">
                           <button class="google-btn google-btn-primary w-full py-3">
                               <i class="fab fa-whatsapp mr-2"></i>
                               Konfirmasi Pembayaran
                           </button>
                        </a>
                    </div>
                    
                    <div class="payment-card">
                        <h3 class="font-bold text-lg mb-4">Cara Membayar</h3>
                        <div class="faq-container">
                            ${instructionAccordionHTML}
                        </div>
                    </div>
                </div>
            `;
            
            elements.paymentInstructionContainer.innerHTML = paymentViewHTML;
            startCountdown();

            // Generate QR Code if applicable
            if (paymentMethodKey === 'qris') {
                setTimeout(() => {
                    const qrcodeContainer = document.getElementById('qrcode');
                    if(qrcodeContainer) {
                        try {
                            const qrisStatic = paymentAccount.number;
                            const qrisDinamis = createDynamicQrisString(qrisStatic, { nominal: totalPrice });
                            qrcodeContainer.innerHTML = ''; // Clear previous QR
                            QRCode.toCanvas(qrisDinamis, {
                                width: 250, margin: 1, errorCorrectionLevel: 'H'
                            }, (err, canvas) => {
                                if (err) { throw err; }
                                canvas.style.width = "100%";
                                canvas.style.height = "auto";
                                qrcodeContainer.appendChild(canvas);
                                
                                // Add download functionality
                                document.getElementById('downloadQrisButton').addEventListener('click', () => {
                                    const link = document.createElement('a');
                                    link.download = `QRIS-${paymentId}.png`;
                                    link.href = canvas.toDataURL("image/png");
                                    link.click();
                                });
                            });
                        } catch (e) {
                            console.error("QRIS Generation Error:", e.message);
                            qrcodeContainer.innerHTML = `<p class="text-red-500 text-sm">Gagal membuat QR Code dinamis. Silakan coba lagi atau hubungi support.</p>`;
                        }
                    }
                }, 100);
            }
        }

        async function handleFormSubmit() {
            // 1. Validate Form
            const formData = new FormData(elements.orderForm);
            const nama = formData.get('nama').trim();
            const whatsapp = formData.get('whatsapp').trim();
            const email = formData.get('email').trim();
            const paymentMethodKey = formData.get('payment-method');

            if (!nama || !whatsapp || !email || !paymentMethodKey) {
                showInfoModal('Data Belum Lengkap', 'Mohon lengkapi semua data yang diperlukan sebelum melanjutkan.');
                return;
            }

            // 2. Set Loading State
            elements.submitBtn.disabled = true;
            elements.submitBtn.classList.add('loading');
            elements.submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Memproses...';

            // 3. Prepare Data
            const pkg = packages[currentPackageId];
            const totalPrice = pkg.price + uniqueCode;
            const paymentAccount = paymentAccounts[paymentMethodKey];
            const now = new Date();
            const paymentId = `INV-${pkg.id.toUpperCase()}-${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}${String(totalPrice).slice(-3)}`;

            // 4. Submit to Static Forms
            let submissionSuccess = false;
            try {
                // Construct the follow-up message with bolding
                let followUpMessage = `Halo kak ${nama},\n\nTerima kasih telah memesan *${pkg.name}*.\n\nBerikut adalah rincian pembayaran untuk pesanan Anda:\n- Nomor Invoice: ${paymentId}\n- Total Pembayaran: *${formatCurrency(totalPrice)}*\n\nMohon segera selesaikan pembayaran Anda.\n`;

                if (paymentMethodKey === 'qris') {
                    followUpMessage += `*- Metode:* ${paymentAccount.displayName}\nSilakan pindai QRIS yang muncul di halaman pembayaran.\n`;
                } else {
                    followUpMessage += `*- Metode:* ${paymentAccount.displayName}\n*- Nomor:* ${paymentAccount.number}` + (paymentAccount.accountHolder ? `\n*- Atas Nama:* ${paymentAccount.accountHolder}` : ``) + `\n`;
                }

                followUpMessage += `\n*Penting:* Mohon transfer sesuai dengan jumlah total di atas (termasuk kode unik) agar pesanan Anda dapat kami proses secara otomatis.\n\nSetelah transfer, silakan klik tombol konfirmasi di halaman pembayaran atau balas pesan ini.\n\nTerima kasih`;
                
                // Format WhatsApp number
                const formattedWhatsapp = whatsapp.startsWith('0') ? '62' + whatsapp.substring(1) : whatsapp;
                const followUpLink = `https://wa.me/${formattedWhatsapp}?text=${encodeURIComponent(followUpMessage)}`;

                const formDataForStaticForms = {
                    apiKey: 'sf_195b5fj92dge8l9b391mng1g',
                    replyTo: email,
                    honeypot: formData.get('honeypot'),
                    name: nama,
                    email: email,
                    whatsapp: whatsapp,
                    '$Nomor Invoice': paymentId,
                    '$Paket': pkg.name,
                    '$Metode Pembayaran': paymentAccount.displayName,
                    '$Total Transfer': formatCurrency(totalPrice),
                    '$Link Follow Up WA': followUpLink // Add the follow-up link
                };

                const response = await fetch('https://api.staticforms.xyz/submit', {
                    method: 'POST',
                    body: JSON.stringify(formDataForStaticForms),
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (response.ok) {
                    submissionSuccess = true;
                } else {
                    console.error("Static Forms server error:", response.status, await response.text());
                }

            } catch (e) {
                console.error("Network error during form submission:", e);
            }
            
            // 5. Restore Button State
            elements.submitBtn.disabled = false;
            elements.submitBtn.classList.remove('loading');
            elements.submitBtn.innerHTML = '<i class="fas fa-shopping-cart mr-2"></i> Beli Sekarang';

            // 6. Update UI based on submission result
            if (submissionSuccess) {
                showPaymentInstructions(formData, pkg, totalPrice, paymentAccount, paymentId, paymentMethodKey);
            } else {
                showInfoModal('Pengiriman Gagal', 'Maaf, terjadi kesalahan saat mengirim data Anda. Silakan coba lagi.');
            }
        }
        
        // --- Countdown Timer Function ---
        function startCountdown() {
            const countdownElement = document.getElementById('countdown-timer-display');
            if (!countdownElement || !expiryTime) return;

            const interval = setInterval(() => {
                const now = new Date().getTime();
                const distance = expiryTime - now;

                if (distance < 0) {
                    clearInterval(interval);
                    countdownElement.innerHTML = "Waktu Habis";
                    return;
                }

                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                countdownElement.innerHTML = `
                    <div class="countdown-item">
                        <span class="countdown-number">${String(hours).padStart(2, '0')}</span> Jam
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${String(minutes).padStart(2, '0')}</span> Menit
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${String(seconds).padStart(2, '0')}</span> Detik
                    </div>
                `;
            }, 1000);
        }

        // --- NOTIFICATION FUNCTIONS ---
        const FIRST_NAMES = [ "Budi Santoso", "Ayu", "Rahmat", "Citra Dewi Kusuma", "Bayu Pratama", "Lina", "Wulan", "Adi", "Farhan Syahputra", "Hendra Wijaya", "Nana Puspita Dewi", "Joko", "Mega Sari", "Gilang Pramana Putra", "Sari", "Dedi", "Eka Suryani", "Teguh", "Putri Lestari Ayu", "Andi", "Bagus Wijaya", "Ilham Saputra Nugraha", "Rizal", "Mira Astuti", "Puspita", "Hari", "Tri Saputra", "Cahya Pratama", "Surya Darmawan Putra", "Wahyu Ramadhan", "Agus", "Indra Permana", "Linda", "Fajar Mahendra Saputra", "Yusuf", "Pramono Adi Nugroho", "Sinta Dewi", "Bima Pratama", "Dian", "Hasan Basri", "Nurul Aini", "Arif Budiman", "Feri", "Lukman Hakim", "Rangga", "Rini Anggraini Putri", "Tono", "Hadi Prasetyo", "Elisa Purnama", "Anisa Rahma", "Gunawan", "Melati", "Bagus Prasetyo Ramadhan", "Septi Amelia", "Cindy Amelia", "Windi Saputri", "Galih Pratama", "Evi", "Putra", "Slamet Riyadi", "Latif Hidayat", "Gita Puspita", "Darmawan", "Maya", "Erik Saputra Pratama", "Jani", "Jefri Maulana", "Bella Sari", "Maulana", "Novi Andriana Lestari", "Fajar Nugroho", "Taufik Hidayat", "Prasetyo", "Samsul", "Agung", "Endang", "Indah", "Hana Pertiwi", "Mirna", "Yulia", "Panca", "Niken", "Rio", "Adi Putra Ramadhan", "Ganda", "Wahida", "Robby Saputra", "Halim", "Firman Saputra", "Berlian Putra", "Ari", "Joko Setiawan", "Mustika", "Bahar", "Mega", "Erlangga", "Sofyan", "Doni", "Fatimah", "Dian Purnama Sari", "Rama", "Imam Saputra", "Johan", "Gusman", "Lintang", "Nabila", "Beni", "Purnama", "Murni", "Malik", "Nurlan", "Doni Saputra", "Lastri", "Berlinda", "Rasyid", "Tari", "Nia", "Tirta", "Juli Andriani", "Lutfi", "Suci", "Arman", "Yani", "Citra Ayu", "Harto", "Rangga Pratama", "Febrina", "Indra Gunawan Saputra", "Tomi", "Sutrisno", "Risma", "Jihan Ayu Pratiwi", "Lestari", "Dewi Kusuma", "Fahmi", "Rifki", "Wira", "Putra Wijaya", "Beni Setiawan", "Asep", "Gerry", "Prasetia", "Euis", "Latif", "Pajar", "Rahmat Hidayat", "Rudi", "Tika", "Danu", "Hesti", "Syahrul", "Anwar", "Miranti", "Nuraini", "Nurman", "Eman Kurnia", "Nirmala", "Hari Susanto", "Taufan", "Tono Prabowo", "Bayu Saputra Nugroho", "Darma", "Nurlaila", "Hafid", "Mustofa", "Elok", "Gunarto", "Novi", "Lasman", "Jamaludin", "Andi Wijaya Putra", "Herman", "Mila", "Wibowo", "Prayitno", "Adi Saputra", "Jamal", "Irfan", "Iskandar", "Yudha", "Lutris", "Samsul Hidayat", "Heru", "Bagus", "Rudianto", "Nanda Putri", "Laila Rahma", "Frans", "Hilda", "Cahya", "Rudi Pratama", "Setiawan", "Rangga Saputra", "Puspa", "Doni Prasetyo", "Nurul", "Febri", "Mega Sari Lestari", "Suyatno", "Tomiadi", "Fikri", "Lani", "Intan", "Johan Saputra", "Iwan", "Berliano", "Ilham", "Teddy", "Lani Puspita", "Eka Putri Andayani", "Hani", "Adi Wijaya", "Adit", "Dicky", "Gopal", "Pramono", "Gunadi", "Gilang", "Joko Prayitno Adi", "Mira", "Puspita Sari", "Maulana Hakim", "Putri Ayu Lestari", "Malik Prasetyo", "Toriq", "Joni", "Gilang Pratama", "Bagus Wijaya Putra", "Berlian", "Wandi", "Nurman Saputra", "Fajarudin", "Lutfi Pratama", "Citra", "Nanda", "Laras", "Tuti", "Yani Pratiwi", "Gusman Saputra", "Rangga Putra", "Prasetiawan", "Ismail", "Heri", "Adi Nugroho", "Putri", "Prasetyo Adi", "Dona", "Gani", "Jihan", "Puspita Dewi", "Rizal Maulana", "Mahendra", "Ayu Pratiwi", "Rangga Setiawan", "Lina Sari", "Fani", "Adi Wijaya Putra", "Sari Melati", "Andri", "Bima", "Teguh Santoso Adi", "Fajar", "Wulan Dewi", "Rama Pratama", "Nana", "Farhan", "Dion", "Melati Pertiwi", "Adi Putra", "Joko Santoso", "Doni Setiawan", "Lintang Pertiwi", "Septi", "Gopal Pramana", "Tomi Pratama", "Rio Nugraha", "Cindy", "Hafid Saputra", "Hendra", "Niken Lestari", "Rangga Nugroho", "Putri Ayu", "Sofyan Hidayat", "Robby", "Bima Saputra", "Indra", "Adi Kurniawan", "Nanda Saputra", "Gilang Saputra", "Wahyu", "Puspita Ayu", "Rudi Hartono", "Wulan Dewi Pertiwi", "Ayu Pratiwi Lestari", "Tono Adi", "Dedi Kurniawan", "Prasetyo Ramadhan", "Adi Setiawan", "Mira Lestari", "Farhan Syahputra Adi", "Nurul Hidayah", "Sari Anggraini", "Bayu", "Eman", "Putra Adi Nugroho", "Lestari Ayu", "Bambang", "Rangga Hidayat", "Mega Putri", "Adi Nugraha", "Anisa", "Siska", "Wandi Putra", "Fajar Saputra", "Gunawan Pratama", "Heri Setiawan", "Arif", "Ilham Nugroho", "Bagus Pratama", "Erlangga Putra", "Rian", "Pandu", "Tari Ayu", "Hendro", "Risma Ayu", "Adi Pratama", "Septi Ayu", "Bambang Santoso", "Lukman", "Gani Saputra", "Hasan", "Feri Kurniawan", "Tirta", "Bambang Prasetyo", "Pajar Saputra", "Arman Putra", "Murni Ayu", "Hafiz", "Euis Sari", "Bayu Nugroho", "Tomi Saputra", "Gerry Pratama", "Arif Prasetyo", "Johan Putra", "Hafid Nugraha", "Nabila Pertiwi", "Latif Saputra", "Ari Saputra", "Rio Saputra", "Tono Saputra", "Wandi Saputra", "Mahendra Putra", "Ilham Pratama", "Putri Dewi", "Adi Lestari", "Rangga Maulana", "Bayu Hidayat", "Fani Puspita", "Taufik", "Bagus Saputra", "Novi Puspita", "Rahmat Hidayatullah Putra", "Prayitno Saputra", "Adi Ramadhan", "Bayu Wijaya", "Gilang Nugraha", "Rangga Prasetyo", "Putra Purnama", "Wulan Pertiwi", "Adi Wijaya Ramadhan", "Budi", "Rian Pratama", "Samsul Nugroho", "Wahyu Saputra", "Teguh Prasetyo", "Fikri Nugraha", "Rizki Pratama" ];
        
        function getRandomElement(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
        function generateRandomName() { return `${getRandomElement(FIRST_NAMES)}`; }
        
        function showNextNotification() {
            if (!elements.notifBox || !elements.notifName) return;
            elements.notifName.textContent = generateRandomName();
            elements.notifBox.classList.remove('show');
            void elements.notifBox.offsetWidth; // Trigger reflow
            elements.notifBox.classList.add('show');
        }

        function scheduleNextNotification() {
            const randomDelay = Math.floor(Math.random() * 10000) + 8000;
            setTimeout(() => {
                showNextNotification();
                scheduleNextNotification();
            }, randomDelay);
        }

        // --- DETAILS MODAL LOGIC ---
        function getDetailsModalHTML(details) {
            const { pkg, totalPrice, paymentId, nama, whatsapp } = details;
            return `
                <div class="google-modal-content max-w-md">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-semibold">Ringkasan Transaksi</h3>
                        <button class="text-gray-400 hover:text-gray-600 text-2xl" onclick="closeDetailsModal()">&times;</button>
                    </div>
                    <div class="space-y-4">
                        <p class="text-sm text-gray-500">Nomor Invoice: ${paymentId}</p>
                        <div class="text-center py-4 bg-gray-50 rounded-lg">
                            <p class="text-sm text-gray-600 mb-2">Total Pembayaran</p>
                            <div class="flex items-center justify-center gap-2">
                                <p class="price-display text-2xl">${formatCurrency(totalPrice)}</p>
                                <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="google-btn google-btn-outlined text-xs py-1 px-2">
                                    <i class="far fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        <div class="border-t border-b border-gray-200 py-4 space-y-3">
                            <div class="flex justify-between">
                                <span>${pkg.name}</span>
                                <span class="font-medium">${formatCurrency(pkg.price)}</span>
                            </div>
                            <div class="flex justify-between text-sm text-gray-500">
                                <span>Kode Unik</span>
                                <span>${formatCurrency(uniqueCode)}</span>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between font-semibold">
                                <span>Total</span>
                                <span>${formatCurrency(totalPrice)}</span>
                            </div>
                        </div>
                        <div class="border-t border-gray-200 pt-4">
                            <h4 class="font-semibold mb-3">Informasi Pelanggan</h4>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Nama:</span>
                                    <span class="font-medium">${nama}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Telepon:</span>
                                    <span class="font-medium">${whatsapp}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        window.showDetailsModal = function(event) {
            event.preventDefault();
            elements.detailsModalContent.innerHTML = getDetailsModalHTML(currentOrderDetails);
            elements.detailsModal.style.display = 'flex';
        }

        window.closeDetailsModal = function() {
            elements.detailsModal.style.display = 'none';
        }

        // --- INITIALIZATION ---
        elements.currentYear.textContent = new Date().getFullYear();
        elements.submitBtn.addEventListener('click', handleFormSubmit);

        document.querySelectorAll('input[name="package"]').forEach(radio => {
            radio.addEventListener('change', (event) => {
                currentPackageId = event.target.value;
                updateDisplay();
            });
        });

        updateDisplay();
        
        if (elements.notifBox && elements.notifName) {
            setTimeout(scheduleNextNotification, 6000);
        }

    });

    // --- GLOBAL HELPER FUNCTIONS ---
    const infoModal = document.getElementById('infoModal');
    
    function showInfoModal(title, message) {
        if (!infoModal) return;
        infoModal.querySelector('#modalTitle').textContent = title;
        infoModal.querySelector('#modalMessage').textContent = message;
        infoModal.style.display = 'flex';
    }

    function closeInfoModal() {
        if (!infoModal) return;
        infoModal.style.display = 'none';
    }

    window.onclick = function(event) {
        if (event.target == infoModal) { closeInfoModal(); }
        if (event.target == document.getElementById('detailsModal')) { closeDetailsModal(); }
        if (event.target == document.getElementById('imageModal')) { closeImageModal(); }
    }

    function copyToClipboard(text, entityName) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            showInfoModal('Berhasil Disalin!', `${entityName} telah disalin ke clipboard.`);
        } catch (err) {
            showInfoModal('Gagal!', 'Gagal menyalin. Silakan coba secara manual.');
        }
        document.body.removeChild(textArea);
    }

    // --- QRIS LOGIC ---
    function toCRC16(input) {
        let crc = 0xFFFF;
        for (let i = 0; i < input.length; i++) {
            crc ^= input.charCodeAt(i) << 8;
            for (let j = 0; j < 8; j++) {
                crc = crc & 0x8000 ? (crc << 1) ^ 0x1021 : crc << 1;
            }
        }
        return (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
    }

    function createDynamicQrisString(qris, { nominal }) {
        if (!qris) throw new Error('Parameter "qris" (string QRIS statis) dibutuhkan.');
        if (nominal === undefined) throw new Error('Parameter "nominal" dibutuhkan.');

        let qrisModified = qris.slice(0, -4).replace("010211", "010212");
        const nominalStr = String(Math.round(nominal));
        const amountLength = nominalStr.length < 10 ? "0" + nominalStr.length : nominalStr.length.toString();
        const amountPart = "54" + amountLength + nominalStr;
        
        if (!qrisModified.includes("5802ID")) {
            throw new Error("Format string QRIS tidak dikenali (tidak ditemukan '5802ID').");
        }

        let finalQris = qrisModified.replace("5802ID", amountPart + "5802ID");
        const crc = toCRC16(finalQris);

        return finalQris + crc;
    }
    
    // --- Image Modal Functions ---
    const imageModal = document.getElementById('imageModal');
    const modalImg = document.getElementById("modalImage");
    let currentImageIndex;

    window.openImageModal = function(event, index) {
        event.stopPropagation();
        imageModal.style.display = "flex";
        showImage(index);
    }

    window.closeImageModal = function() {
        imageModal.style.display = "none";
    }

    function showImage(index) {
        const testimonialImages = [
            "https://s6.imgcdn.dev/YIh45V.png",
            "https://s6.imgcdn.dev/YIhuYh.png",
            "https://s6.imgcdn.dev/YIhCOK.png",
            "https://s6.imgcdn.dev/YIhIgo.png",
            "https://s6.imgcdn.dev/YIhQQO.png",
            "https://s6.imgcdn.dev/YIhiSn.png",
            "https://s6.imgcdn.dev/YIhkeg.png",
            "https://s6.imgcdn.dev/YIhscv.png",
            "https://s6.imgcdn.dev/YIhyaN.png",
            "https://s6.imgcdn.dev/YIh5tq.png",
            "https://s6.imgcdn.dev/YIhPYB.png",
            "https://s6.imgcdn.dev/YIhTKu.png"
        ];
        if (index >= testimonialImages.length || index < 0) {
            return;
        }
        currentImageIndex = index;
        modalImg.src = testimonialImages[index];

        // Update navigation button visibility
        document.querySelector('.modal-nav.prev').style.display = (index > 0) ? 'block' : 'none';
        document.querySelector('.modal-nav.next').style.display = (index < testimonialImages.length - 1) ? 'block' : 'none';
    }

    window.showNextImage = function() {
        showImage(currentImageIndex + 1);
    }

    window.showPrevImage = function() {
        showImage(currentImageIndex - 1);
    }

    document.addEventListener('keydown', function(event) {
        if (imageModal.style.display === 'flex') {
            if (event.key === 'ArrowRight') {
                showNextImage();
            } else if (event.key === 'ArrowLeft') {
                showPrevImage();
            } else if (event.key === 'Escape') {
                closeImageModal();
            }
        }
    });

    </script>

</body>
</html>
