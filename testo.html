<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jual Akun Netflix Premium 1 Tahun - Harga Spesial!</title>
    <link rel="icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/Netflix_2015_N_logo.svg/250px-Netflix_2015_N_logo.svg.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>

    <!-- === KODE FACEBOOK PIXEL DIMULAI DI SINI === -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '668703605199479');
      fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=668703605199479&ev=PageView&noscript=1"
    /></noscript>
    <!-- === AKHIR DARI KODE FACEBOOK PIXEL === -->

    <style>
        /* Pengaturan Dasar dan Font */
        body {
            font-family: 'Inter', 'Roboto', sans-serif;
            background-color: #000000; /* Latar belakang hitam pekat seperti Netflix */
            color: #ffffff;
        }

        /* Input Form dengan gaya Netflix */
        .form-input {
            border: 1px solid #333;
            transition: all 0.2s ease-in-out;
            border-radius: 4px;
            padding: 0.9rem 1rem;
            width: 100%;
            background-color: #333;
            color: #fff;
        }
        .form-input::placeholder {
            color: #8c8c8c;
        }
        .form-input:focus {
            border-color: #e50914;
            background-color: #444;
            outline: none;
            box-shadow: 0 0 0 2px rgba(229, 9, 20, 0.5);
        }
        
        /* Tombol Aksi (CTA) dengan warna Merah Netflix */
        .cta-button {
            transition: background-color 0.2s ease-in-out;
            border-radius: 4px;
            padding: 0.85rem 2rem;
            font-size: 1.1rem;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            cursor: pointer;
            width: 100%;
            border: none;
            text-transform: uppercase;
        }
        .red-button {
            background-color: #e50914; /* Merah Netflix */
            color: white;
        }
        .red-button:hover {
            background-color: #f40612; /* Merah lebih terang saat hover */
        }
        .cta-button:disabled {
            background-color: #555;
            cursor: not-allowed;
        }

        /* Modal / Message Box Styling */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%;
            overflow: auto; 
            background-color: rgba(0,0,0,0.85);
            justify-content: center; 
            align-items: center;
        }
        #infoModal {
             justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: #222; margin: auto; padding: 24px 32px; width: 90%; max-width: 450px;
            border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); text-align: center; position: relative;
            animation: fadeIn 0.3s ease; border: 1px solid #333;
        }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .modal-content h3 { color: #fff; margin-bottom: 15px; font-size: 1.5rem; font-weight: 700; }
        .modal-content p { color: #ccc; margin-bottom: 20px; line-height: 1.6; }
        .modal-ok-button {
            background-color: #e50914; color: white; padding: 10px 24px; border: none; border-radius: 4px;
            cursor: pointer; font-size: 1rem; font-weight: 500; transition: background-color 0.2s ease;
        }
        .modal-ok-button:hover { background-color: #f40612; }

        /* Testimonial Section */
        .testimonial-image {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            border-radius: 0.5rem;
            width: 100%;
            height: auto;
            object-fit: cover;
            aspect-ratio: 3 / 4;
        }
        .testimonial-image:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        
        /* Modal untuk Zoom Gambar Testimoni */
        .modal-content-image {
            margin: auto;
            display: block;
            width: auto;
            max-width: 90%;
            max-height: 85vh;
            animation: zoomIn 0.3s ease;
        }

        @keyframes zoomIn {
            from {transform: scale(0)}
            to {transform: scale(1)}
        }

        .close-image-modal {
            position: absolute;
            top: 20px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
            z-index: 1001;
        }
        .close-image-modal:hover,
        .close-image-modal:focus {
            color: #bbb;
            text-decoration: none;
        }

        .modal-nav {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            margin-top: -50px;
            color: white;
            font-weight: bold;
            font-size: 24px;
            transition: 0.3s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
            -webkit-user-select: none;
            background-color: rgba(0,0,0,0.3);
            display: none;
        }
        .modal-nav.prev {
            left: 10px;
            border-radius: 3px 0 0 3px;
        }
        .modal-nav.next {
            right: 10px;
            border-radius: 0 3px 3px 0;
        }
        .modal-nav:hover {
            background-color: rgba(0,0,0,0.6);
        }
        
        /* Notifikasi Toast */
        .notif-box {
            position: fixed; top: 24px; left: 50%; transform: translateX(-50%); background-color: #e50914;
            color: #ffffff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            padding: 12px 24px; display: none; align-items: center; gap: 12px; width: auto;
            max-width: 450px; z-index: 1000; opacity: 0;
            transition: opacity 0.4s ease, transform 0.4s ease, top 0.4s ease;
        }
        .notif-box.show { display: flex; opacity: 1; animation: slideInAndOut 5s ease-in-out forwards; }
        @keyframes slideInAndOut {
            0%   { opacity: 0; transform: translateX(-50%) translateY(-30px); }
            10%  { opacity: 1; transform: translateX(-50%) translateY(0); }
            90%  { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-30px); }
        }
        .notif-icon-wrapper { color: #ffffff; font-size: 1.2rem; flex-shrink: 0; }
        .notif-message { font-size: 0.9rem; line-height: 1.2; }
        .notif-message strong { font-weight: 600; }
        .notif-time {
            font-size: 0.75rem;
            color: #e2e8f0;
            margin-top: 2px;
        }
        @media (max-width: 500px) {
            .notif-box { left: 16px; right: 16px; top: 16px; transform: translateX(0); width: calc(100% - 32px); }
            @keyframes slideInAndOut {
                0%   { opacity: 0; transform: translateY(-20px); } 10%  { opacity: 1; transform: translateY(0); }
                90%  { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-20px); }
            }
        }

        /* Bagian FAQ */
        .faq-item { border-bottom: 1px solid #333; }
        .faq-item:last-child { border-bottom: none; }
        .faq-item summary {
            font-weight: 600; font-size: 1.1rem; color: #fff;
            padding: 1.25rem 0.5rem; cursor: pointer; list-style: none;
            display: flex; justify-content: space-between; align-items: center;
            background-color: #303030;
            margin-bottom: 2px;
        }
        .faq-item summary:hover {
            background-color: #404040;
        }
        .faq-item summary::-webkit-details-marker { display: none; }
        .faq-item summary::after {
            content: '\f067'; /* plus */
            font-family: 'Font Awesome 6 Free'; font-weight: 900;
            transition: transform 0.3s ease; color: #fff;
        }
        .faq-item[open] summary::after { transform: rotate(45deg); }
        .faq-content { padding: 1.25rem; color: #ccc; line-height: 1.7; background-color: #303030; margin-top: 2px; }
        .faq-item[open] summary { color: #fff; }

        /* Hapus Segmented Control karena tidak diperlukan */
        .segmented-control { display: none; }

        /* Enhanced Product Info Display & Transitions */
        #product-info-form-top, #features-before-form {
            transition: opacity 0.3s ease-in-out;
        }
        #product-info-form-top {
            min-height: 180px;
        }
        #features-before-form {
            min-height: 380px;
        }
        .product-info-card {
            background-color: #000;
            border: 1px solid #222;
            border-radius: 8px;
            padding: 1.5rem;
        }

        /* === REVISI FINAL: Payment Method Styles === */
        .payment-radio {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        .payment-label {
            display: flex;
            align-items: center;
            padding: 1rem 1rem;
            transition: background-color 0.2s ease-in-out;
            cursor: pointer;
            background-color: #333;
            color: #fff;
        }
        .payment-label:hover {
            background-color: #444;
        }
        .payment-radio:checked + .payment-label {
            background-color: #e50914; /* Warna merah Netflix saat dipilih */
        }
        .payment-group {
            border: 1px solid #444;
        }
        .payment-group > div {
            border-bottom: 1px solid #444;
        }
        .payment-group > div:last-child {
            border-bottom: none;
        }
        .payment-logo-container {
            width: 85px;
            height: 45px;
            background-color: #fff;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            padding: 5px;
            flex-shrink: 0;
        }
        .payment-logo-img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .custom-radio-button {
            height: 20px;
            width: 20px;
            border: 2px solid #888;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease-in-out;
            flex-shrink: 0;
            margin-left: 1rem;
        }
        .custom-radio-button .dot {
            height: 10px;
            width: 10px;
            border-radius: 50%;
            background-color: transparent;
            transition: all 0.2s ease-in-out;
        }
        .payment-radio:checked + .payment-label .custom-radio-button {
            border-color: #fff;
        }
        .payment-radio:checked + .payment-label .custom-radio-button .dot {
            background-color: #fff;
        }

        /* PAYMENT INSTRUCTION LAYOUT STYLES */
        .payment-header {
            background-color: #000;
            color: #fff;
            padding: 1rem;
            text-align: center;
            border-bottom: 2px solid #e50914;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .payment-header h2 {
            font-size: 1.125rem;
        }
        .countdown-timer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        .countdown-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        .countdown-number {
            background-color: #e50914;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .payment-card {
            background-color: #222;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        .copy-button-text {
            background: none;
            border: none;
            color: #e50914;
            font-weight: 600;
            cursor: pointer;
            padding: 0.25rem;
        }
        .copy-button-text:hover {
            text-decoration: underline;
        }
        .payment-accordion {
            border-bottom: 1px solid #333;
        }
        .payment-accordion:last-child {
            border-bottom: none;
        }
        .payment-accordion summary {
            font-weight: 500;
            padding: 1rem 0;
            cursor: pointer;
            list-style: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .payment-accordion summary::-webkit-details-marker { display: none; }
        .payment-accordion summary::after {
            content: '\f078';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            transition: transform 0.2s ease;
            color: #ccc;
        }
        .payment-accordion[open] summary::after {
            transform: rotate(180deg);
        }
        .payment-accordion-content {
            padding-bottom: 1rem;
            color: #ccc;
            line-height: 1.6;
        }
        .payment-accordion-content ol {
            list-style-type: decimal;
            padding-left: 1.25rem;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .payment-header {
                padding: 0.875rem 1rem;
            }
            .payment-header h2 {
                font-size: 1.0625rem;
            }
            .countdown-timer {
                margin-top: 0.25rem;
            }
            .countdown-number {
                font-size: 0.875rem;
                padding: 0.15rem 0.4rem;
            }
            .countdown-item {
                font-size: 0.75rem;
            }
        }

        /* DETAILS MODAL STYLES (BOTTOM SHEET) */
        #detailsModal {
            align-items: flex-end; /* Align to bottom */
        }
        .details-modal-content {
            background-color: #181818;
            width: 100%;
            max-width: 100%; /* Full width */
            border-radius: 16px 16px 0 0; /* Rounded corners only at the top */
            box-shadow: 0 -5px 15px rgba(0,0,0,0.3);
            text-align: left;
            transform: translateY(100%); /* Start off-screen */
        }
        .details-modal-content.is-open {
            animation: slideUp 0.3s ease-out forwards;
        }
        .details-modal-content.is-closing {
            animation: slideDown 0.3s ease-out forwards;
        }
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        @keyframes slideDown {
            from { transform: translateY(0); }
            to { transform: translateY(100%); }
        }

        .details-modal-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .details-modal-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #fff;
        }
        .details-modal-close {
            font-size: 1.5rem;
            font-weight: 400;
            color: #ccc;
            cursor: pointer;
            background: none;
            border: none;
        }
        .details-modal-body {
            padding: 1rem 1.5rem 1.5rem 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        /* General Component Styling */
        .main-card {
            background-color: #141414; /* Warna kartu sedikit lebih terang dari background */
            border: 1px solid #222;
        }
    </style>
</head>
<body class="antialiased">

    <div id="payment-instruction-container">
        <!-- Konten akan di-generate oleh JavaScript -->
    </div>
    <div class="p-4 sm:p-6 lg:p-8">
        <div id="main-content-container">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-x-16 gap-y-8 max-w-7xl mx-auto">
                <!-- Kolom Kiri: Form & Pembayaran -->
                <div class="lg:col-span-1 main-card p-6 md:p-8 rounded-lg shadow-lg">
                    <!-- Header Keamanan -->
                    <div class="grid grid-cols-2 gap-4 text-center border-b border-gray-700 pb-6 mb-6">
                        <div class="flex items-center justify-center gap-3">
                            <i class="fas fa-shield-alt text-green-500 text-xl"></i>
                            <h3 class="font-medium text-sm text-gray-300">TRANSAKSI AMAN</h3>
                        </div>
                        <div class="flex items-center justify-center gap-3">
                            <i class="fas fa-award text-yellow-400 text-xl"></i>
                            <h3 class="font-medium text-sm text-gray-300">100% FULL GARANSI</h3>
                        </div>
                    </div>
                    
                    <!-- Info Produk -->
                    <div id="product-info-form-top" class="mb-6"></div>

                    <!-- Fitur -->
                    <div id="features-before-form" class="mb-6"></div>

                    <!-- Form -->
                    <form id="orderForm">
                        <h2 class="text-xl font-bold mb-5 text-white">1. Lengkapi Data</h2>
                        <div class="space-y-4">
                            <div>
                                <label for="nama" class="block text-sm font-medium mb-1 text-gray-300">Nama Anda <span class="text-red-500">*</span></label>
                                <input type="text" id="nama" name="nama" class="form-input w-full" placeholder="Masukkan nama lengkap Anda">
                            </div>
                            <div>
                                <label for="whatsapp" class="block text-sm font-medium mb-1 text-gray-300">No. WhatsApp Anda <span class="text-red-500">*</span></label>
                                <input type="tel" id="whatsapp" name="whatsapp" class="form-input w-full" placeholder="Contoh: 081234567890">
                            </div>
                            <div>
                                <label for="email" class="block text-sm font-medium mb-1 text-gray-300">Email (untuk pengiriman akun) <span class="text-red-500">*</span></label>
                                <input type="email" id="email" name="email" class="form-input w-full" placeholder="contoh.email@gmail.com">
                            </div>
                        </div>
                        
                        <!-- Honeypot field for anti-spam -->
                        <input type="text" name="honeypot" style="display: none" tabindex="-1" autocomplete="off">

                        <!-- Metode Pembayaran -->
                        <div id="payment-method-selection" class="mt-8"></div>
                        
                        <!-- Rincian Pesanan -->
                        <div id="order-details-in-form" class="mt-8"></div>
                        
                        <button type="button" id="submit-btn" class="cta-button red-button mt-8">
                            Beli Sekarang
                        </button>
                    </form>
                </div>

                <!-- Kolom Kanan: Testimoni, FAQ, Kebijakan -->
                <div class="lg:col-span-1 py-8">
                     <div id="testimonials-container">
                        <h2 class="text-3xl font-extrabold text-center mb-8 text-white">Testimoni Pelanggan Kami</h2>
                        <div id="testimonial-grid" class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                            <!-- Gambar akan dimasukkan di sini oleh JavaScript -->
                        </div>
                    </div>
                     <div class="mt-12">
                         <div id="faq-full"></div>
                     </div>
                     <div class="mt-12 main-card p-8 md:p-10 rounded-lg shadow-lg">
                         <div id="policy-full"></div>
                     </div>
                </div>
            </div>
        </div>
        
        <footer id="footer" class="text-center mt-16 text-gray-500 text-sm">
            <p>Copyright © <span id="currentYear">2025</span> NFX ID. Semua Hak Dilindungi.</p>
        </footer>
    </div>

    <!-- Modal for Info/Confirmation -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle"></h3>
            <p id="modalMessage"></p>
            <button class="modal-ok-button" onclick="closeInfoModal()">OK</button>
        </div>
    </div>

    <!-- Modal untuk Zoom Gambar -->
    <div id="imageModal" class="modal">
        <span class="close-image-modal" onclick="closeImageModal()">&times;</span>
        <span class="modal-nav prev" onclick="showPrevImage()">&#10094;</span>
        <span class="modal-nav next" onclick="showNextImage()">&#10095;</span>
        <img class="modal-content-image" id="modalImage">
    </div>
    
    <!-- NEW: Modal for Transaction Details -->
    <div id="detailsModal" class="modal">
        <div class="details-modal-content" id="detailsModalContent">
            <!-- Content will be injected by JS -->
        </div>
    </div>

    <!-- Notification Popup -->
    <div class="notif-box" id="notifBox">
        <div class="notif-icon-wrapper"><i class="far fa-check-circle"></i></div>
        <div class="notif-content-area">
             <div class="notif-message">
                 <div><strong class="notif-name">Nama Acak</strong> baru saja membeli!</div>
                 <div class="notif-time">beberapa detik lalu</div>
             </div>
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', function() {

        // --- ELEMENTS ---
        const elements = {
            mainContentContainer: document.getElementById('main-content-container'),
            paymentInstructionContainer: document.getElementById('payment-instruction-container'),
            footer: document.getElementById('footer'),
            currentYear: document.getElementById('currentYear'),
            productInfoFormTop: document.getElementById('product-info-form-top'),
            featuresBeforeForm: document.getElementById('features-before-form'),
            paymentMethodSelection: document.getElementById('payment-method-selection'),
            orderDetailsInForm: document.getElementById('order-details-in-form'),
            faqFull: document.getElementById('faq-full'),
            policyFull: document.getElementById('policy-full'),
            orderForm: document.getElementById('orderForm'),
            submitBtn: document.getElementById('submit-btn'),
            notifBox: document.getElementById('notifBox'),
            notifName: document.querySelector('#notifBox .notif-name'),
            detailsModal: document.getElementById('detailsModal'),
            detailsModalContent: document.getElementById('detailsModalContent'),
        };

        // --- CONFIGURATION ---
        const uniqueCode = Math.floor(Math.random() * (500 - 100 + 1)) + 100;
        let countdownInterval;
        let expiryTime;
        let currentOrderDetails = {};
        
        const product = {
            id: 'netflix-premium',
            name: "Netflix Premium 1 Tahun",
            price: 179000,
            normalPrice: 648000,
            title: "NETFLIX PREMIUM",
            priceDisplay: `Rp179.000`,
            logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/1920px-Netflix_2015_logo.svg.png',
            description: "Akun private penuh untuk 1 tahun, nonton tanpa batas.",
            features: [
                "<strong>Akun Private Penuh:</strong> Email dan password bisa diganti sesuai keinginan.",
                "<strong>Garansi Penuh 1 Tahun:</strong> Akun dijamin aman selama masa aktif.",
                "<strong>Kualitas 4K Ultra HD + HDR:</strong> Nikmati resolusi tertinggi dan kualitas gambar terbaik.",
                "<strong>Nonton di 4 Layar Bersamaan:</strong> Cocok untuk dibagi bersama keluarga.",
                "<strong>Bisa untuk Semua Device:</strong> HP, Tablet, Smart TV, Laptop, PS/Xbox.",
                "<strong>Legal & Aman:</strong> Langganan 100% resmi dan aman.",
                "<strong>Tanpa Perpanjang Bulanan:</strong> Sekali bayar untuk hiburan setahun penuh."
            ]
        };
        
        const paymentAccounts = {
             qris: {
                 displayName: 'QRIS',
                 accountHolder: 'Epay',
                 number: '00020101021126610016ID.CO.SHOPEE.WWW01189360091800223157700208223157700303UMI51440014ID.CO.QRIS.WWW0215ID10254270621910303UMI5204481453033605802ID5904Epay6013JAKARTA PUSAT61051061062070703A0163042F15',
                 logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Logo_QRIS.svg/163px-Logo_QRIS.svg.png',
                 type: 'qris',
                 category: 'QRIS'
             },
             cimb: { 
                 displayName: 'CIMB Niaga',
                 accountHolder: 'Octo Pay - 6289510639366', 
                 number: '6289510639366', 
                 logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/CIMB_Niaga_logo.svg/330px-CIMB_Niaga_logo.svg.png', 
                 type: 'bank',
                 category: 'Bank Transfer'
             },
             bca_va: { 
                 displayName: 'BCA Virtual Account', 
                 accountHolder: 'Epayment', 
                 number: '39358089510639366', 
                 logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/330px-Bank_Central_Asia.svg.png', 
                 type: 'va',
                 category: 'Bank Transfer'
             },
             gopay: { 
                 displayName: 'Gopay', 
                 accountHolder: 'Gopay 6289510639366', 
                 number: '089510639366', 
                 logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Gopay_logo.svg/320px-Gopay_logo.svg.png', 
                 type: 'ewallet',
                 category: 'E-Wallet'
             },
             dana: { 
                 displayName: 'DANA', 
                 accountHolder: 'DNID089510639366', 
                 number: '089510639366', 
                 logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Logo_dana_blue.svg/330px-Logo_dana_blue.svg.png', 
                 type: 'ewallet',
                 category: 'E-Wallet'
             },
             ovo: { 
                 displayName: 'OVO', 
                 accountHolder: 'OVO Epayment', 
                 number: '089510639366', 
                 logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Logo_ovo_purple.svg/330px-Logo_ovo_purple.svg.png', 
                 type: 'ewallet',
                 category: 'E-Wallet'
             }
        };

        // --- TEMPLATE FUNCTIONS ---
        const getProductInfoHTML = (pkg) => {
            return `
            <div class="product-info-card">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="text-center mb-4 md:mb-0 flex-grow">
                        <div class="flex justify-center"><img alt="Logo ${pkg.name}" class="h-10 w-auto" src="${pkg.logo}"></div>
                        <h1 class="text-2xl font-bold text-white mt-4">${pkg.title}</h1>
                        <p class="text-md text-gray-400">${pkg.description}</p>
                    </div>
                    <div class="text-center md:text-right mt-4 md:mt-0 md:pl-4">
                        <div class="text-4xl font-extrabold text-red-600">${pkg.priceDisplay}</div>
                        <p class="text-gray-400 text-sm mt-1">
                            <span class="line-through mr-2">${formatCurrency(pkg.normalPrice)}</span>
                            <span>/ 1 Tahun</span>
                        </p>
                    </div>
                </div>
            </div>`;
        }

        const getFeaturesHTML = (pkg) => {
            const colors = ['text-red-500'];
            return `<div class="bg-black/20 p-6 rounded-lg">
                <h3 class="text-lg font-bold mb-4 text-white">Yang Anda Dapatkan:</h3>
                <ul class="space-y-4">${pkg.features.map((f, index) => `<li class="flex items-start"><i class="fas fa-check-circle ${colors[index % colors.length]} mt-1 mr-3"></i><span class="text-gray-300">${f}</span></li>`).join('')}</ul>
            </div>`;
        }
        
        const getPaymentMethodsHTML = (accounts) => {
            const groupedAccounts = {};
            for (const key in accounts) {
                const account = accounts[key];
                if (!groupedAccounts[account.category]) {
                    groupedAccounts[account.category] = [];
                }
                groupedAccounts[account.category].push({ key, ...account });
            }

            let html = `<h2 class="text-xl font-bold mb-5 text-white">2. Pilih Metode Pembayaran</h2>`;
            const categoryOrder = ['QRIS', 'Bank Transfer', 'E-Wallet'];

            for (const category of categoryOrder) {
                if (groupedAccounts[category]) {
                    html += `<h3 class="text-lg font-semibold text-gray-200 mt-6 mb-3">${category}</h3>`;
                    html += `<div class="rounded-lg overflow-hidden payment-group">`;

                    groupedAccounts[category].forEach((account, index) => {
                        const isFirst = index === 0 && category === 'QRIS';
                        
                        html += `
                            <div>
                                <input type="radio" id="${account.key}" name="payment-method" value="${account.key}" class="payment-radio" ${isFirst ? 'checked' : ''}>
                                <label for="${account.key}" class="payment-label">
                                    <div class="payment-logo-container">
                                        <img src="${account.logo}" alt="Logo ${account.displayName}" class="payment-logo-img">
                                    </div>
                                    <span class="font-medium text-white flex-grow">${account.displayName}</span>
                                    <span class="custom-radio-button"><span class="dot"></span></span>
                                </label>
                            </div>
                        `;
                    });
                    html += `</div>`;
                }
            }

            html += `
                <div class="bg-black/30 p-3 mt-4 rounded-lg text-center text-sm text-gray-400">
                    Pembayaran ini diproses oleh Doku
                </div>
            `;

            return html;
        };

        const getOrderDetailsHTML = (pkg, totalPrice) => `
            <div class="mt-8 pt-6 border-t border-gray-700">
                 <h3 class="text-lg font-bold mb-4 text-white">Rincian Pesanan</h3>
                 <div class="bg-black/20 p-4 rounded-lg space-y-3 text-gray-300">
                     <div class="flex justify-between items-center">
                         <span>${pkg.name}</span>
                         <div class="text-right">
                             <span class="font-medium text-white">${formatCurrency(pkg.price)}</span>
                         </div>
                     </div>
                     <div class="flex justify-between">
                         <span>Kode Unik</span>
                         <span class="font-medium text-white">${formatCurrency(uniqueCode)}</span>
                     </div>
                     <hr class="my-2 border-gray-700">
                     <div class="flex justify-between font-bold text-lg text-white">
                         <span>Total</span>
                         <span>${formatCurrency(totalPrice)}</span>
                     </div>
                 </div>
            </div>`;

        const getFaqHTML = () => `
             <div>
                 <h3 class="text-3xl font-extrabold mb-6 text-center text-white">Pertanyaan Umum (FAQ)</h3>
                 <div class="space-y-2">
                     <details class="faq-item">
                         <summary>Apakah akun Netflix ini legal?</summary>
                         <div class="faq-content"><p>Ya, 100% legal. Kami menggunakan metode pembayaran resmi Netflix untuk berlangganan.</p></div>
                     </details>
                     <details class="faq-item">
                         <summary>Bolehkah saya mengganti email atau password?</summary>
                         <div class="faq-content"><p>Tentu saja. Ini adalah akun private dengan kontrol penuh ada di tangan Anda. Anda bebas mengganti email dan password.</p></div>
                     </details>
                     <details class="faq-item">
                         <summary>Berapa lama proses aktivasinya?</summary>
                         <div class="faq-content"><p>Sangat cepat, aktivasi akun biasanya selesai dalam waktu 5-15 menit setelah Anda melakukan konfirmasi pembayaran.</p></div>
                     </details>
                     <details class="faq-item">
                         <summary>Apakah ada garansi?</summary>
                         <div class="faq-content"><p>Ya, kami memberikan garansi penuh selama 1 tahun. Jika terjadi masalah pada akun (misalnya on-hold), kami akan menggantinya dengan akun baru.</p></div>
                     </details>
                     <details class="faq-item">
                         <summary>Bisakah saya menggunakan akun ini di luar negeri?</summary>
                         <div class="faq-content"><p>Ya, akun Netflix bersifat global dan bisa digunakan di negara mana pun yang mendukung layanan Netflix.</p></div>
                     </details>
                     <details class="faq-item">
                         <summary>Apakah saya bisa mendownload film?</summary>
                         <div class="faq-content"><p>Ya, Anda bisa mendownload film dan serial favorit Anda di perangkat seluler (HP/Tablet) dan aplikasi Netflix di Windows.</p></div>
                     </details>
                      <details class="faq-item">
                         <summary>Bagaimana jika saya lupa password?</summary>
                         <div class="faq-content"><p>Karena akun ini sepenuhnya milik Anda, Anda bisa mereset password sendiri melalui fitur "Lupa Password" di situs Netflix, yang akan mengirimkan link reset ke email yang terhubung dengan akun.</p></div>
                     </details>
                      <details class="faq-item">
                         <summary>Bagaimana cara menghubungi support?</summary>
                         <div class="faq-content"><p>Anda dapat menghubungi kami melalui nomor WhatsApp yang sama dengan yang Anda gunakan untuk konfirmasi pembayaran. Tim kami siap membantu.</p></div>
                     </details>
                 </div>
             </div>
        `;
        
        const getPolicyHTML = () => `
            <div>
                <h3 class="text-3xl font-extrabold mb-4 text-center text-white">Kebijakan & Ketentuan</h3>
                <div class="grid md:grid-cols-1 gap-8 text-sm text-gray-300">
                    <div class="mb-6">
                        <h4 class="text-lg font-bold mb-2 text-white">Kebijakan Privasi</h4>
                        <p class="mb-4">Informasi pelanggan (nama, no. WhatsApp, email) yang Anda berikan hanya digunakan untuk keperluan transaksi, pengiriman akun, dan komunikasi terkait pesanan. Kami menjamin data Anda tidak akan dibagikan ke pihak ketiga mana pun.</p>
                    </div>
                    <div>
                        <h4 class="text-lg font-bold mb-2 text-white">Syarat & Ketentuan</h4>
                         <p class="mb-4">Dengan melakukan pembelian, Anda dianggap setuju dengan syarat dan ketentuan kami. Garansi penuh berlaku jika Anda mengikuti aturan penggunaan standar dari Netflix.</p>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Garansi tidak berlaku jika akun terblokir karena kesalahan pengguna (misalnya: membagikan akun melebihi batas layar, aktivitas ilegal).</li>
                            <li>Dilarang menggunakan akun untuk aktivitas yang melanggar hukum.</li>
                            <li>Satu pembelian berlaku untuk satu akun selama periode 1 tahun.</li>
                        </ul>
                    </div>
                </div>
            </div>
        `;

        // --- FUNCTIONS ---
        function formatCurrency(value) {
            return `Rp${value.toLocaleString('id-ID', { minimumFractionDigits: 0 })}`;
        }

        function getIndonesianTimezone() {
            const offset = new Date().getTimezoneOffset() / -60;
            if (offset === 7) return 'WIB';
            if (offset === 8) return 'WITA';
            if (offset === 9) return 'WIT';
            const sign = offset > 0 ? '+' : '-';
            const hours = Math.abs(Math.floor(offset));
            return `GMT${sign}${String(hours).padStart(2, '0')}:00`;
        }

        function updateDisplay() {
            const pkg = product;
            const totalPrice = pkg.price + uniqueCode;

            const infoContainer = elements.productInfoFormTop;
            const featuresContainer = elements.featuresBeforeForm;

            infoContainer.style.opacity = '0';
            featuresContainer.style.opacity = '0';

            setTimeout(() => {
                infoContainer.innerHTML = getProductInfoHTML(pkg);
                featuresContainer.innerHTML = getFeaturesHTML(pkg);
                elements.paymentMethodSelection.innerHTML = getPaymentMethodsHTML(paymentAccounts);
                elements.orderDetailsInForm.innerHTML = getOrderDetailsHTML(pkg, totalPrice);
                elements.faqFull.innerHTML = getFaqHTML();
                elements.policyFull.innerHTML = getPolicyHTML();
                infoContainer.style.opacity = '1';
                featuresContainer.style.opacity = '1';
            }, 300);
        }

        function showPaymentInstructions(formData, pkg, totalPrice, paymentAccount, paymentId, paymentMethodKey) {
            window.scrollTo(0, 0);
            
            currentOrderDetails = {
                pkg,
                totalPrice,
                paymentId,
                nama: formData.get('nama'),
                whatsapp: formData.get('whatsapp')
            };

            elements.mainContentContainer.parentElement.style.display = 'none';
            elements.footer.style.display = 'none';
            
            let accountLabel = paymentAccount.type === 'va' ? 'Nomor Virtual Account' : 'Nomor Rekening';
            let instructionAccordionHTML = '';
            let paymentDetailsBlock = '';
            let paymentDeadlineFormatted = '';

            expiryTime = new Date(new Date().getTime() + 24 * 60 * 60 * 1000);
            
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const datePart = expiryTime.toLocaleDateString('id-ID', dateOptions);
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            const timePart = expiryTime.toLocaleTimeString('id-ID', timeOptions).replace(/\./g, ':');
            const timezoneString = `(${getIndonesianTimezone()})`;
            paymentDeadlineFormatted = `${datePart} pukul ${timePart} ${timezoneString}`;

            if (paymentMethodKey === 'qris') {
                paymentDetailsBlock = `
                    <div class="text-center">
                        <div id="qrcodeContainer" class="bg-white p-2 rounded-lg border border-gray-700 w-full max-w-[250px] h-auto mx-auto my-4">
                            <div id="qrcode" class="flex justify-center items-center"></div>
                        </div>
                        <button id="downloadQrisButton" class="cta-button red-button max-w-xs mx-auto text-sm">
                            Unduh QRIS
                        </button>
                        <p class="text-center text-sm text-gray-400 mt-4">Pindai QR Code di atas menggunakan aplikasi perbankan atau e-wallet Anda.</p>
                    </div>
                `;
            } else {
                 paymentDetailsBlock = `
                    <div class="mt-4">
                        <p class="text-sm text-gray-400">${accountLabel}</p>
                        <div class="flex justify-between items-center">
                            <p class="text-xl font-semibold text-white tracking-wider">${paymentAccount.number}</p>
                            <button onclick="copyToClipboard('${paymentAccount.number}', '${accountLabel}')" class="copy-button-text">Salin</button>
                        </div>
                    </div>
                `;
            }
            
            // Generic instructions for now
            instructionAccordionHTML = `
                <details class="payment-accordion" open><summary>Instruksi Umum Transfer</summary><div class="payment-accordion-content"><ol class="space-y-2">
                    <li>Buka aplikasi perbankan (m-banking/internet banking) atau e-wallet Anda.</li>
                    <li>Pilih menu <strong>Transfer</strong> atau <strong>Pembayaran Virtual Account</strong>.</li>
                    <li>Masukkan detail pembayaran yang tertera di atas (Nomor Rekening/VA).</li>
                    <li>Pastikan nama penerima <strong>(${paymentAccount.accountHolder})</strong> sudah sesuai.</li>
                    <li>Masukkan nominal transfer sesuai dengan <strong>Total Pembayaran</strong> hingga digit terakhir.</li>
                    <li>Selesaikan transaksi dan simpan bukti pembayaran Anda.</li>
                </ol></div></details>
            `;

            const paymentViewHTML = `
                <div class="payment-header">
                    <h2>Selesaikan Pembayaran</h2>
                    <div class="countdown-timer" id="countdown-timer-display"></div>
                </div>
                <div class="max-w-lg mx-auto">
                    <div class="p-4">
                        <div class="payment-card">
                            <h3 class="font-bold text-lg text-white">Ringkasan Transaksi</h3>
                            <div class="flex justify-between items-center mt-2 text-sm text-gray-400">
                                <span>Nomor Invoice: ${paymentId}</span>
                                <a href="#" onclick="showDetailsModal(event)" class="font-semibold text-red-500">Lihat detail</a>
                            </div>
                            <hr class="my-4 border-gray-700">
                            <p class="text-sm text-gray-400">Total Pembayaran</p>
                            <div class="flex items-center">
                                <p class="text-2xl font-bold text-white">${formatCurrency(totalPrice)}</p>
                                <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="copy-button-text"><i class="far fa-copy"></i></button>
                            </div>
                        </div>
                        <div class="payment-card">
                            <h3 class="font-bold text-lg text-white">Silahkan Bayar ke</h3>
                            <div class="flex justify-between items-center mt-4">
                                <div>
                                    <p class="text-sm text-gray-400">${paymentAccount.displayName}</p>
                                    <p class="font-semibold text-white">${paymentAccount.accountHolder}</p>
                                </div>
                                <div class="payment-logo-container">
                                    <img src="${paymentAccount.logo}" alt="Logo ${paymentAccount.displayName}" class="payment-logo-img">
                                </div>
                            </div>
                            ${paymentDetailsBlock}
                            <div class="mt-6">
                                <p class="text-sm text-gray-400">Bayar Sebelum</p>
                                <p class="font-semibold text-white">${paymentDeadlineFormatted}</p>
                            </div>
                            <p class="text-xs text-center text-gray-500 mt-6">
                                Setelah pembayaran berhasil, pesanan Anda akan diproses secara otomatis. Tidak perlu konfirmasi manual.
                            </p>
                        </div>
                        <div class="payment-card">
                            <h3 class="font-bold text-lg text-white">Cara Membayar</h3>
                            <div class="mt-2">
                                ${instructionAccordionHTML}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            elements.paymentInstructionContainer.innerHTML = paymentViewHTML;
            startCountdown();
            
            if (paymentMethodKey === 'qris') {
                setTimeout(() => {
                    const qrcodeContainer = document.getElementById('qrcode');
                    if(qrcodeContainer) {
                        const qrisStatic = paymentAccount.number;
                        const qrisDinamis = createDynamicQrisString(qrisStatic, { nominal: totalPrice });
                        qrcodeContainer.innerHTML = ''; // Clear previous QR
                        QRCode.toCanvas(qrisDinamis, {
                            width: 250, margin: 1, errorCorrectionLevel: 'H'
                        }, (err, canvas) => {
                            if (err) { console.error("QR Code generation error:", err); return; }
                            canvas.style.width = "100%";
                            canvas.style.height = "auto";
                            qrcodeContainer.appendChild(canvas);
                            
                            document.getElementById('downloadQrisButton').addEventListener('click', () => {
                                const link = document.createElement('a');
                                link.download = `qris-${totalPrice}.png`;
                                link.href = canvas.toDataURL("image/png");
                                link.click();
                            });
                        });
                    }
                }, 100);
            }
        }

        async function handleFormSubmit() {
            const formData = new FormData(elements.orderForm);
            const nama = formData.get('nama').trim();
            const whatsapp = formData.get('whatsapp').trim();
            const email = formData.get('email').trim();
            const paymentMethodKey = formData.get('payment-method');

            if (!nama || !whatsapp || !email || !paymentMethodKey) {
                showInfoModal('Data Belum Lengkap', 'Mohon lengkapi semua data yang diperlukan sebelum melanjutkan.');
                return;
            }

            elements.submitBtn.disabled = true;
            elements.submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> MEMPROSES...';

            const pkg = product;
            const totalPrice = pkg.price + uniqueCode;
            const paymentAccount = paymentAccounts[paymentMethodKey];
            const now = new Date();
            const paymentId = `INV-NFX-${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}${String(totalPrice).slice(-4)}`;

            // Simulate form submission
            setTimeout(() => {
                 elements.submitBtn.disabled = false;
                 elements.submitBtn.innerHTML = 'Beli Sekarang';
                 showPaymentInstructions(formData, pkg, totalPrice, paymentAccount, paymentId, paymentMethodKey);
            }, 1500);
        }
        
        function startCountdown() {
            const countdownElement = document.getElementById('countdown-timer-display');
            if (!countdownElement || !expiryTime) return;

            const interval = setInterval(() => {
                const now = new Date().getTime();
                const distance = expiryTime - now;

                if (distance < 0) {
                    clearInterval(interval);
                    countdownElement.innerHTML = "Waktu Habis";
                    return;
                }

                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                countdownElement.innerHTML = `
                    <div class="countdown-item">
                        <span class="countdown-number">${String(hours).padStart(2, '0')}</span> Jam
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${String(minutes).padStart(2, '0')}</span> Menit
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${String(seconds).padStart(2, '0')}</span> Detik
                    </div>
                `;
            }, 1000);
        }

        const FIRST_NAMES = [ "Budi Santoso", "Ayu", "Rahmat", "Citra Dewi Kusuma", "Bayu Pratama", "Lina", "Wulan", "Adi", "Farhan Syahputra", "Hendra Wijaya", "Nana Puspita Dewi", "Joko", "Mega Sari", "Gilang Pramana Putra", "Sari", "Dedi", "Eka Suryani", "Teguh", "Putri Lestari Ayu", "Andi", "Bagus Wijaya", "Ilham Saputra Nugraha", "Rizal", "Mira Astuti", "Puspita", "Hari", "Tri Saputra", "Cahya Pratama", "Surya Darmawan Putra", "Wahyu Ramadhan", "Agus", "Indra Permana", "Linda", "Fajar Mahendra Saputra", "Yusuf", "Pramono Adi Nugroho", "Sinta Dewi", "Bima Pratama", "Dian", "Hasan Basri", "Nurul Aini", "Arif Budiman", "Feri", "Lukman Hakim", "Rangga", "Rini Anggraini Putri", "Tono", "Hadi Prasetyo", "Elisa Purnama", "Anisa Rahma", "Gunawan", "Melati", "Bagus Prasetyo Ramadhan", "Septi Amelia", "Cindy Amelia", "Windi Saputri", "Galih Pratama", "Evi", "Putra", "Slamet Riyadi", "Latif Hidayat", "Gita Puspita", "Darmawan", "Maya", "Erik Saputra Pratama", "Jani", "Jefri Maulana", "Bella Sari", "Maulana", "Novi Andriana Lestari", "Fajar Nugroho", "Taufik Hidayat", "Prasetyo", "Samsul", "Agung", "Endang", "Indah", "Hana Pertiwi", "Mirna", "Yulia", "Panca", "Niken", "Rio", "Adi Putra Ramadhan", "Ganda", "Wahida", "Robby Saputra", "Halim", "Firman Saputra", "Berlian Putra", "Ari", "Joko Setiawan", "Mustika", "Bahar", "Mega", "Erlangga", "Sofyan", "Doni", "Fatimah", "Dian Purnama Sari", "Rama", "Imam Saputra", "Johan", "Gusman", "Lintang", "Nabila", "Beni", "Purnama", "Murni", "Malik", "Nurlan", "Doni Saputra", "Lastri", "Berlinda", "Rasyid", "Tari", "Nia", "Tirta", "Juli Andriani", "Lutfi", "Suci", "Arman", "Yani", "Citra Ayu", "Harto", "Rangga Pratama", "Febrina", "Indra Gunawan Saputra", "Tomi", "Sutrisno", "Risma", "Jihan Ayu Pratiwi", "Lestari", "Dewi Kusuma", "Fahmi", "Rifki", "Wira", "Putra Wijaya", "Beni Setiawan", "Asep", "Gerry", "Prasetia", "Euis", "Latif", "Pajar", "Rahmat Hidayat", "Rudi", "Tika", "Danu", "Hesti", "Syahrul", "Anwar", "Miranti", "Nuraini", "Nurman", "Eman Kurnia", "Nirmala", "Hari Susanto", "Taufan", "Tono Prabowo", "Bayu Saputra Nugroho", "Darma", "Nurlaila", "Hafid", "Mustofa", "Elok", "Gunarto", "Novi", "Lasman", "Jamaludin", "Andi Wijaya Putra", "Herman", "Mila", "Wibowo", "Prayitno", "Adi Saputra", "Jamal", "Irfan", "Iskandar", "Yudha", "Lutris", "Samsul Hidayat", "Heru", "Bagus", "Rudianto", "Nanda Putri", "Laila Rahma", "Frans", "Hilda", "Cahya", "Rudi Pratama", "Setiawan", "Rangga Saputra", "Puspa", "Doni Prasetyo", "Nurul", "Febri", "Mega Sari Lestari", "Suyatno", "Tomiadi", "Fikri", "Lani", "Intan", "Johan Saputra", "Iwan", "Berliano", "Ilham", "Teddy", "Lani Puspita", "Eka Putri Andayani", "Hani", "Adi Wijaya", "Adit", "Dicky", "Gopal", "Pramono", "Gunadi", "Gilang", "Joko Prayitno Adi", "Mira", "Puspita Sari", "Maulana Hakim", "Putri Ayu Lestari", "Malik Prasetyo", "Toriq", "Joni", "Gilang Pratama", "Bagus Wijaya Putra", "Berlian", "Wandi", "Nurman Saputra", "Fajarudin", "Lutfi Pratama", "Citra", "Nanda", "Laras", "Tuti", "Yani Pratiwi", "Gusman Saputra", "Rangga Putra", "Prasetiawan", "Ismail", "Heri", "Adi Nugroho", "Putri", "Prasetyo Adi", "Dona", "Gani", "Jihan", "Puspita Dewi", "Rizal Maulana", "Mahendra", "Ayu Pratiwi", "Rangga Setiawan", "Lina Sari", "Fani", "Adi Wijaya Putra", "Sari Melati", "Andri", "Bima", "Teguh Santoso Adi", "Fajar", "Wulan Dewi", "Rama Pratama", "Nana", "Farhan", "Dion", "Melati Pertiwi", "Adi Putra", "Joko Santoso", "Doni Setiawan", "Lintang Pertiwi", "Septi", "Gopal Pramana", "Tomi Pratama", "Rio Nugraha", "Cindy", "Hafid Saputra", "Hendra", "Niken Lestari", "Rangga Nugroho", "Putri Ayu", "Sofyan Hidayat", "Robby", "Bima Saputra", "Indra", "Adi Kurniawan", "Nanda Saputra", "Gilang Saputra", "Wahyu", "Puspita Ayu", "Rudi Hartono", "Wulan Dewi Pertiwi", "Ayu Pratiwi Lestari", "Tono Adi", "Dedi Kurniawan", "Prasetyo Ramadhan", "Adi Setiawan", "Mira Lestari", "Farhan Syahputra Adi", "Nurul Hidayah", "Sari Anggraini", "Bayu", "Eman", "Putra Adi Nugroho", "Lestari Ayu", "Bambang", "Rangga Hidayat", "Mega Putri", "Adi Nugraha", "Anisa", "Siska", "Wandi Putra", "Fajar Saputra", "Gunawan Pratama", "Heri Setiawan", "Arif", "Ilham Nugroho", "Bagus Pratama", "Erlangga Putra", "Rian", "Pandu", "Tari Ayu", "Hendro", "Risma Ayu", "Adi Pratama", "Septi Ayu", "Bambang Santoso", "Lukman", "Gani Saputra", "Hasan", "Feri Kurniawan", "Tirta", "Bambang Prasetyo", "Pajar Saputra", "Arman Putra", "Murni Ayu", "Hafiz", "Euis Sari", "Bayu Nugroho", "Tomi Saputra", "Gerry Pratama", "Arif Prasetyo", "Johan Putra", "Hafid Nugraha", "Nabila Pertiwi", "Latif Saputra", "Ari Saputra", "Rio Saputra", "Tono Saputra", "Wandi Saputra", "Mahendra Putra", "Ilham Pratama", "Putri Dewi", "Adi Lestari", "Rangga Maulana", "Bayu Hidayat", "Fani Puspita", "Taufik", "Bagus Saputra", "Novi Puspita", "Rahmat Hidayatullah Putra", "Prayitno Saputra", "Adi Ramadhan", "Bayu Wijaya", "Gilang Nugraha", "Rangga Prasetyo", "Putra Purnama", "Wulan Pertiwi", "Adi Wijaya Ramadhan", "Budi", "Rian Pratama", "Samsul Nugroho", "Wahyu Saputra", "Teguh Prasetyo", "Fikri Nugraha", "Rizki Pratama" ];
        
        function getRandomElement(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
        function generateRandomName() { return `${getRandomElement(FIRST_NAMES)}`; }
        
        function showNextNotification() {
            if (!elements.notifBox || !elements.notifName) return;
            elements.notifName.textContent = generateRandomName();
            elements.notifBox.classList.remove('show');
            void elements.notifBox.offsetWidth;
            elements.notifBox.classList.add('show');
        }

        function scheduleNextNotification() {
            const randomDelay = Math.floor(Math.random() * 10000) + 8000;
            setTimeout(() => {
                showNextNotification();
                scheduleNextNotification();
            }, randomDelay);
        }

        elements.currentYear.textContent = new Date().getFullYear();
        elements.submitBtn.addEventListener('click', handleFormSubmit);

        updateDisplay();
        
        if (elements.notifBox && elements.notifName) {
            setTimeout(scheduleNextNotification, 6000);
        }
        
        function getDetailsModalHTML(details) {
            const { pkg, totalPrice, paymentId, nama, whatsapp } = details;
            return `
                <div class="details-modal-header">
                    <h3>Ringkasan Transaksi</h3>
                    <button class="details-modal-close" onclick="closeDetailsModal()">&times;</button>
                </div>
                <div class="details-modal-body text-white">
                    <p class="text-sm text-gray-400 mb-4">Nomor Invoice: ${paymentId}</p>
                    <div class="text-center mb-6">
                        <p class="text-sm text-gray-400">Total Pembayaran</p>
                        <div class="flex items-center justify-center">
                            <p class="text-3xl font-bold text-white">${formatCurrency(totalPrice)}</p>
                            <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="copy-button-text"><i class="far fa-copy"></i></button>
                        </div>
                    </div>
                    <div class="space-y-4 border-t border-b border-gray-700 py-4 mb-4">
                        <div>
                            <div class="flex justify-between text-sm">
                                <span>${pkg.name}</span>
                                <span class="font-medium">${formatCurrency(pkg.price)}</span>
                            </div>
                            <div class="flex justify-between text-sm text-gray-400">
                                <span>1x ${formatCurrency(pkg.price)}</span>
                            </div>
                        </div>
                         <div class="flex justify-between text-sm">
                            <span class="text-gray-400">Kode Unik</span>
                            <span class="font-medium">${formatCurrency(uniqueCode)}</span>
                        </div>
                    </div>
                    <div class="space-y-2 mb-6">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-400">Subtotal</span>
                            <span>${formatCurrency(totalPrice)}</span>
                        </div>
                        <div class="flex justify-between font-bold">
                            <span>Total Pembayaran</span>
                            <span>${formatCurrency(totalPrice)}</span>
                        </div>
                    </div>
                    <div class="border-t border-gray-700 pt-4">
                        <h4 class="font-semibold mb-3 text-sm">Informasi Pelanggan</h4>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <p class="text-gray-400">Nama</p>
                                <p class="font-medium">${nama}</p>
                            </div>
                            <div>
                                <p class="text-gray-400">Nomor Telepon</p>
                                <p class="font-medium">${whatsapp}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        window.showDetailsModal = function(event) {
            event.preventDefault();
            elements.detailsModalContent.innerHTML = getDetailsModalHTML(currentOrderDetails);
            elements.detailsModal.style.display = 'flex';
            elements.detailsModalContent.classList.remove('is-closing');
            elements.detailsModalContent.classList.add('is-open');
        }

        window.closeDetailsModal = function() {
            elements.detailsModalContent.classList.remove('is-open');
            elements.detailsModalContent.classList.add('is-closing');
            setTimeout(() => {
                elements.detailsModal.style.display = 'none';
            }, 300);
        }

        // --- NEW TESTIMONIAL GALLERY SCRIPT ---

        const testimonialImages = [
            "https://down-id.img.susercontent.com/file/20c85b67e572cc2b2510893daf3db0c7.webp",
            "https://down-id.img.susercontent.com/file/9282ad76c267c41e28fc2ad8d4a497b5.webp",
            "https://down-id.img.susercontent.com/file/a777654f3989cf391fb6daecf95edbeb.webp",
            "https://down-id.img.susercontent.com/file/id-11134103-7r98t-llr1ioqle8x780.webp",
            "https://s6.imgcdn.dev/YIZ0DL.jpg",
            "https://s6.imgcdn.dev/YIZatu.jpg",
            "https://s6.imgcdn.dev/YIZ75a.jpg",
            "https://s6.imgcdn.dev/YIZBOw.jpg"
        ];
        
        const imageModal = document.getElementById('imageModal');
        const modalImg = document.getElementById("modalImage");
        const testimonialGrid = document.getElementById('testimonial-grid');
        let currentImageIndex;

        function populateTestimonialGrid() {
            if (!testimonialGrid) return;
            let imagesHTML = testimonialImages.map((url, index) => `
                <img src="${url}" alt="Testimoni Pelanggan ${index + 1}" class="testimonial-image" onclick="openImageModal(event, ${index})">
            `).join('');
            testimonialGrid.innerHTML = imagesHTML;
        }

        function showImage(index) {
            if (index >= testimonialImages.length || index < 0) {
                return;
            }
            currentImageIndex = index;
            modalImg.src = testimonialImages[index];
            document.querySelector('.modal-nav.prev').style.display = (index > 0) ? 'block' : 'none';
            document.querySelector('.modal-nav.next').style.display = (index < testimonialImages.length - 1) ? 'block' : 'none';
        }

        window.openImageModal = function(event, index) {
            event.stopPropagation();
            imageModal.style.display = "flex";
            showImage(index);
        }

        window.closeImageModal = function() {
            imageModal.style.display = "none";
        }

        window.showNextImage = function() {
            showImage(currentImageIndex + 1);
        }
        window.showPrevImage = function() {
            showImage(currentImageIndex + 1);
        }

        window.addEventListener('click', function(event) {
            if (event.target == imageModal) {
                closeImageModal();
            }
        });

        document.addEventListener('keydown', function(event) {
            if (imageModal.style.display === 'flex') {
                if (event.key === 'ArrowRight') {
                    showNextImage();
                } else if (event.key === 'ArrowLeft') {
                    showPrevImage();
                } else if (event.key === 'Escape') {
                    closeImageModal();
                }
            }
        });

        populateTestimonialGrid();
    });

    // --- GLOBAL HELPER FUNCTIONS ---
    const infoModal = document.getElementById('infoModal');
    
    function showInfoModal(title, message) {
        if (!infoModal) return;
        infoModal.querySelector('#modalTitle').textContent = title;
        infoModal.querySelector('#modalMessage').textContent = message;
        infoModal.style.display = 'flex';
    }

    function closeInfoModal() {
        if (!infoModal) return;
        infoModal.style.display = 'none';
    }

    window.onclick = function(event) {
        if (event.target == infoModal) { closeInfoModal(); }
        if (event.target == document.getElementById('detailsModal')) { closeDetailsModal(); }
        // The new event listener handles the image modal click-outside
    }

    function copyToClipboard(text, entityName) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            showInfoModal('Berhasil Disalin!', `${entityName} telah disalin ke clipboard.`);
        } catch (err) {
            showInfoModal('Gagal!', 'Gagal menyalin. Silakan coba secara manual.');
        }
        document.body.removeChild(textArea);
    }
    
    function createDynamicQrisString(qris, { nominal }) {
        if (!qris) throw new Error('Parameter "qris" (string QRIS statis) dibutuhkan.');
        if (nominal === undefined) throw new Error('Parameter "nominal" dibutuhkan.');

        let qrisModified = qris.slice(0, -4).replace("010211", "010212");
        const nominalStr = String(Math.round(nominal)); // Pastikan nominal adalah integer
        const amountLength = nominalStr.length < 10 ? "0" + nominalStr.length : nominalStr.length.toString();
        const amountPart = "54" + amountLength + nominalStr;
        
        if (!qrisModified.includes("5802ID")) {
            throw new Error("Format string QRIS tidak dikenali (tidak ditemukan '5802ID').");
        }
        let finalQris = qrisModified.replace("5802ID", amountPart + "5802ID");
        const crc = toCRC16(finalQris);
        return finalQris + crc;
    }

    function toCRC16(input) {
        let crc = 0xFFFF;
        for (let i = 0; i < input.length; i++) {
            crc ^= input.charCodeAt(i) << 8;
            for (let j = 0; j < 8; j++) {
                crc = crc & 0x8000 ? (crc << 1) ^ 0x1021 : crc << 1;
            }
        }
        return (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
    }

    </script>

</body>
</html>
