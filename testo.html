<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4000+ Preset Lightroom - Penawaran Spesial!</title>
    <link rel="icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b6/Adobe_Photoshop_Lightroom_CC_logo.svg/1200px-Adobe_Photoshop_Lightroom_CC_logo.svg.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>

    <!-- === KODE FACEBOOK PIXEL DIMULAI DI SINI === -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '951715019921316');
      fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=951715019921316&ev=PageView&noscript=1"
    /></noscript>
    <!-- === AKHIR DARI KODE FACEBOOK PIXEL === -->

    <style>
        /* Pengaturan Dasar dan Font */
        body {
            font-family: 'Inter', 'Roboto', sans-serif;
            background-color: #f8f9fa; /* Warna Latar Utama: Putih keabuan */
            color: #3c4043; /* Warna Teks Utama: Abu-abu gelap */
        }
        
        :root {
            --lightroom-blue: #31A8FF;
            --lightroom-blue-darker: #2b90d9;
        }

        /* Input Form dengan gaya Lightroom Light */
        .form-input {
            border: 1px solid #dadce0; /* Warna Border: Abu-abu terang */
            transition: all 0.2s ease-in-out;
            border-radius: 8px;
            padding: 0.9rem 1rem;
            width: 100%;
            background-color: #f1f3f4; /* Warna input: Abu-abu sangat terang */
            color: #3c4043;
        }
        .form-input::placeholder {
            color: #777;
        }
        .form-input:focus {
            border-color: var(--lightroom-blue); /* Warna Primer (Aksen): Biru Terang */
            background-color: #fff;
            outline: none;
            box-shadow: 0 0 0 1px var(--lightroom-blue);
        }
        
        /* Tombol Aksi (CTA) dengan warna Lightroom */
        .cta-button {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 8px;
            padding: 0.85rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            cursor: pointer;
            width: 100%;
            border: none;
        }
        .blue-button {
            background-color: var(--lightroom-blue); /* Warna Primer (Aksen): Biru Terang */
            color: white; 
            box-shadow: 0 4px 14px 0 rgba(49, 168, 255, 0.39);
        }
        .blue-button:hover {
            background-color: var(--lightroom-blue-darker);
            box-shadow: 0 6px 16px 0 rgba(49, 168, 255, 0.45);
        }
        .cta-button:disabled {
            background-color: #9e9e9e;
            color: #ffffff;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Modal / Message Box Styling */
        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%;
            overflow: hidden; background-color: rgba(0,0,0,0.5);  
        }
        #infoModal {
            justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: #fefefe; margin: auto; padding: 24px 32px; width: 90%; max-width: 450px;
            border-radius: 16px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); text-align: center; position: relative;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        .modal-content h3 { color: #202124; margin-bottom: 15px; font-size: 1.5rem; font-weight: 700; }
        .modal-content p { color: #5f6368; margin-bottom: 20px; line-height: 1.6; }
        .modal-ok-button {
            background-color: var(--lightroom-blue); color: white; padding: 10px 24px; border: none; border-radius: 8px;
            cursor: pointer; font-size: 1rem; font-weight: 600; transition: background-color 0.2s ease;
        }
        .modal-ok-button:hover { background-color: var(--lightroom-blue-darker); }

        /* Testimonial Section */
        .testimonial-image {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        .testimonial-image:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        
        /* Modal untuk Zoom Gambar Testimoni */
        #imageModal {
            justify-content: center; align-items: center;
        }
        #imageModal .modal-content-image {
            margin: auto;
            display: block;
            width: auto;
            max-width: 90%;
            max-height: 85vh;
            animation: zoomIn 0.3s ease;
        }
        .close-image-modal {
            position: absolute;
            top: 20px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }
        .close-image-modal:hover,
        .close-image-modal:focus {
            color: #bbb;
            text-decoration: none;
        }
        @keyframes zoomIn {
            from {transform: scale(0)}
            to {transform: scale(1)}
        }
        
        /* Notifikasi Toast */
        .notif-box {
            position: fixed; top: 24px; left: 50%; transform: translateX(-50%); background-color: var(--lightroom-blue);
            color: white; border-radius: 9999px; box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            padding: 12px 24px; display: none; align-items: center; gap: 12px; width: auto;
            max-width: 450px; z-index: 1000; opacity: 0;
            transition: opacity 0.4s ease, transform 0.4s ease, top 0.4s ease;
        }
        .notif-box.show { display: flex; opacity: 1; animation: slideInAndOut 5s ease-in-out forwards; }
        @keyframes slideInAndOut {
            0%   { opacity: 0; transform: translateX(-50%) translateY(-30px); }
            10%  { opacity: 1; transform: translateX(-50%) translateY(0); }
            90%  { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-30px); }
        }
        .notif-icon-wrapper { color: white; font-size: 1.2rem; flex-shrink: 0; }
        .notif-message { font-size: 0.9rem; line-height: 1.2; }
        .notif-message strong { font-weight: 600; }
        .notif-time {
            font-size: 0.75rem;
            color: #e2e8f0;
            margin-top: 2px;
        }
        @media (max-width: 500px) {
            .notif-box { left: 16px; right: 16px; top: 16px; transform: translateX(0); width: calc(100% - 32px); }
            @keyframes slideInAndOut {
                0%   { opacity: 0; transform: translateY(-20px); } 10%  { opacity: 1; transform: translateY(0); }
                90%  { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-20px); }
            }
        }

        /* Bagian FAQ */
        .faq-item { border-bottom: 1px solid #dfe1e6; }
        .faq-item:last-child { border-bottom: none; }
        .faq-item summary {
            font-weight: 600; font-size: 1rem; color: #3c4043;
            padding: 1.25rem 0.5rem; cursor: pointer; list-style: none;
            display: flex; justify-content: space-between; align-items: center;
        }
        .faq-item summary::-webkit-details-marker { display: none; }
        .faq-item summary::after {
            content: '\f078'; /* chevron-down */
            font-family: 'Font Awesome 6 Free'; font-weight: 900;
            transition: transform 0.3s ease; color: #5f6368;
        }
        .faq-item[open] summary::after { transform: rotate(180deg); }
        .faq-content { padding: 0 0.5rem 1.25rem 0.5rem; color: #5f6368; line-height: 1.7; }
        .faq-item[open] summary { color: var(--lightroom-blue); }

        /* Hapus Segmented Control karena hanya 1 produk */
        .segmented-control { display: none; }

        /* Enhanced Product Info Display & Transitions */
        #product-info-form-top, #features-before-form {
            transition: opacity 0.3s ease-in-out;
        }
        #product-info-form-top {
            min-height: 180px; /* Disesuaikan */
        }
        #features-before-form {
            min-height: 350px; /* Disesuaikan */
        }
        .product-info-card {
            background: linear-gradient(135deg, rgba(49, 168, 255, 0.1) 0%, #ffffff 100%);
            border: 1px solid rgba(49, 168, 255, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
        }

        /* Payment Method Styles */
        .payment-radio {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        .payment-label {
            display: flex;
            align-items: center;
            padding: 1rem 1rem;
            transition: background-color 0.2s ease-in-out;
            cursor: pointer;
            background-color: #ffffff;
        }
        .payment-label:hover {
            background-color: #f8f9fa;
        }
        .payment-radio:checked + .payment-label {
            background-color: rgba(49, 168, 255, 0.1); /* Aksen biru terang */
        }
        .payment-group {
            border: 1px solid #dadce0;
        }
        .payment-group > div:first-child > .payment-label {
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
        }
        .payment-group > div:last-child > .payment-label {
            border-bottom-left-radius: 0.5rem;
            border-bottom-right-radius: 0.5rem;
        }
        
        .payment-logo-container {
            width: 68px;
            height: 40px;
            background-color: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 5px;
            margin-right: 1rem;
            flex-shrink: 0;
            border: 1px solid #eee;
        }
        .payment-logo {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .custom-radio-button {
            height: 20px;
            width: 20px;
            border: 2px solid #777;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease-in-out;
            flex-shrink: 0;
            margin-left: 1rem;
        }
        .custom-radio-button .dot {
            height: 10px;
            width: 10px;
            border-radius: 50%;
            background-color: transparent;
            transition: all 0.2s ease-in-out;
        }
        .payment-radio:checked + .payment-label .custom-radio-button {
            border-color: var(--lightroom-blue);
        }
        .payment-radio:checked + .payment-label .custom-radio-button .dot {
            background-color: var(--lightroom-blue);
        }

        /* PAYMENT INSTRUCTION LAYOUT STYLES */
        .payment-header {
            background-color: var(--lightroom-blue);
            color: #fff;
            padding: 1rem;
            text-align: center;
            position: sticky; /* Make header sticky */
            top: 0; /* Stick to the top */
            z-index: 50; /* Ensure it's above other content */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Add a subtle shadow */
        }
        .countdown-timer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        .countdown-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        .countdown-number {
            background-color: rgba(255,255,255,0.2);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .payment-card {
            background-color: #ffffff;
            border: 1px solid #dadce0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        .copy-button-text {
            background: none;
            border: none;
            color: var(--lightroom-blue);
            font-weight: 600;
            cursor: pointer;
            padding: 0.25rem;
        }
        .copy-button-text:hover {
            text-decoration: underline;
        }
        .confirm-button-outlined {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--lightroom-blue);
            color: var(--lightroom-blue);
            background-color: transparent;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .confirm-button-outlined:hover {
            background-color: rgba(49, 168, 255, 0.1);
        }
        .payment-accordion {
            border-bottom: 1px solid #dfe1e6;
        }
        .payment-accordion:last-child {
            border-bottom: none;
        }
        .payment-accordion summary {
            font-weight: 500;
            padding: 1rem 0;
            cursor: pointer;
            list-style: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #3c4043;
        }
        .payment-accordion summary::-webkit-details-marker { display: none; }
        .payment-accordion summary::after {
            content: '\f078';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            transition: transform 0.2s ease;
            color: #5f6368;
        }
        .payment-accordion[open] summary::after {
            transform: rotate(180deg);
        }
        .payment-accordion-content {
            padding-bottom: 1rem;
            color: #5f6368;
            line-height: 1.6;
        }
        .payment-accordion-content ol {
            list-style-type: decimal;
            padding-left: 1.25rem;
            font-size: 0.9rem;
        }

        /* DETAILS MODAL STYLES (BOTTOM SHEET) */
        #detailsModal {
            align-items: flex-end; /* Align to bottom */
        }
        .details-modal-content {
            background-color: #fefefe;
            width: 100%;
            max-width: 100%; /* Full width */
            border-radius: 16px 16px 0 0; /* Rounded corners only at the top */
            box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
            text-align: left;
            transform: translateY(100%); /* Start off-screen */
            border-top: 1px solid #dadce0;
        }
        .details-modal-content.is-open {
            animation: slideUp 0.3s ease-out forwards;
        }
        .details-modal-content.is-closing {
            animation: slideDown 0.3s ease-out forwards;
        }
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        @keyframes slideDown {
            from { transform: translateY(0); }
            to { transform: translateY(100%); }
        }

        .details-modal-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #dadce0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .details-modal-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #202124;
        }
        .details-modal-close {
            font-size: 1.5rem;
            font-weight: 400;
            color: #5f6368;
            cursor: pointer;
            background: none;
            border: none;
        }
        .details-modal-body {
            padding: 1rem 1.5rem 1.5rem 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }
    </style>
</head>
<body class="antialiased">

    <div id="payment-instruction-container">
        <!-- Konten akan di-generate oleh JavaScript -->
    </div>
    <div class="p-4 sm:p-6 lg:p-8">
        <div id="main-content-container">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-x-16 gap-y-8 max-w-7xl mx-auto">
                <!-- Kolom Kiri: Form & Pembayaran -->
                <div class="lg:col-span-1 bg-white p-6 md:p-8 rounded-2xl shadow-sm border border-gray-200">
                    <!-- Header Keamanan -->
                    <div class="grid grid-cols-2 gap-4 text-center border-b border-gray-200 pb-6 mb-6">
                        <div class="flex items-center justify-center gap-3">
                            <i class="fas fa-shield-alt text-xl" style="color: var(--lightroom-blue);"></i>
                            <h3 class="font-medium text-sm text-gray-600">TRANSAKSI AMAN</h3>
                        </div>
                        <div class="flex items-center justify-center gap-3">
                            <i class="fas fa-hand-holding-usd text-xl" style="color: var(--lightroom-blue);"></i>
                            <h3 class="font-medium text-sm text-gray-600">GARANSI BANTUAN</h3>
                        </div>
                    </div>
                    
                    <!-- Judul Pilih Paket (dihilangkan, tapi judulnya tetap ada) -->
                    <h2 class="text-xl font-bold mb-4 text-gray-800">1. Detail Produk</h2>

                    <!-- Info Produk -->
                    <div id="product-info-form-top" class="mb-6"></div>

                    <!-- Fitur -->
                    <div id="features-before-form" class="mb-6"></div>

                    <!-- Form -->
                    <form id="orderForm">
                        <h2 class="text-xl font-bold mb-5 text-gray-800">2. Lengkapi Data</h2>
                        <div class="space-y-4">
                            <div>
                                <label for="nama" class="block text-sm font-medium mb-1 text-gray-700">Nama Anda <span class="text-red-500">*</span></label>
                                <input type="text" id="nama" name="nama" class="form-input w-full" placeholder="Masukkan nama lengkap Anda">
                            </div>
                            <div>
                                <label for="whatsapp" class="block text-sm font-medium mb-1 text-gray-700]">No. WhatsApp Anda <span class="text-red-500">*</span></label>
                                <input type="tel" id="whatsapp" name="whatsapp" class="form-input w-full" placeholder="Contoh: 081234567890">
                            </div>
                            <div>
                                <label for="email" class="block text-sm font-medium mb-1 text-gray-700">Email Anda <span class="text-red-500">*</span></label>
                                <input type="email" id="email" name="email" class="form-input w-full" placeholder="Link download akan dikirim ke email ini">
                            </div>
                        </div>
                        
                        <!-- Honeypot field for anti-spam -->
                        <input type="text" name="honeypot" style="display: none" tabindex="-1" autocomplete="off">

                        <!-- Metode Pembayaran -->
                        <div id="payment-method-selection" class="mt-8"></div>
                        
                        <!-- Rincian Pesanan -->
                        <div id="order-details-in-form" class="mt-8"></div>
                        
                        <button type="button" id="submit-btn" class="cta-button blue-button mt-8">
                            Beli Sekarang
                        </button>
                    </form>
                </div>

                <!-- Kolom Kanan: Testimoni, FAQ, Kebijakan -->
                <div class="lg:col-span-1 py-8">
                     <div id="testimonials-full"></div>
                     <div class="mt-12 bg-white p-8 md:p-10 rounded-2xl shadow-sm border border-gray-200">
                         <div id="faq-full"></div>
                     </div>
                     <div class="mt-12 bg-white p-8 md:p-10 rounded-2xl shadow-sm border border-gray-200">
                         <div id="policy-full"></div>
                     </div>
                </div>
            </div>
        </div>
        
        <footer id="footer" class="text-center mt-16 text-gray-500 text-sm">
            <p>Copyright © <span id="currentYear">2025</span> Preset Pro. Semua Hak Dilindungi.</p>
        </footer>
    </div>

    <!-- Modal for Info/Confirmation -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle"></h3>
            <p id="modalMessage"></p>
            <button class="modal-ok-button" onclick="closeInfoModal()">OK</button>
        </div>
    </div>

    <!-- Modal untuk Zoom Gambar -->
    <div id="imageModal" class="modal">
        <span class="close-image-modal" onclick="closeImageModal()">&times;</span>
        <img class="modal-content-image" id="modalImage">
    </div>
    
    <!-- NEW: Modal for Transaction Details -->
    <div id="detailsModal" class="modal">
        <div class="details-modal-content" id="detailsModalContent">
            <!-- Content will be injected by JS -->
        </div>
    </div>

    <!-- Notification Popup -->
    <div class="notif-box" id="notifBox">
        <div class="notif-icon-wrapper"><i class="far fa-check-circle"></i></div>
        <div class="notif-content-area">
             <div class="notif-message">
                 <div><strong class="notif-name">Nama Acak</strong> baru saja membeli!</div>
                 <div class="notif-time">beberapa detik lalu</div>
             </div>
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', function() {

        // --- ELEMENTS ---
        const elements = {
            mainContentContainer: document.getElementById('main-content-container'),
            paymentInstructionContainer: document.getElementById('payment-instruction-container'),
            footer: document.getElementById('footer'),
            currentYear: document.getElementById('currentYear'),
            productInfoFormTop: document.getElementById('product-info-form-top'),
            featuresBeforeForm: document.getElementById('features-before-form'),
            paymentMethodSelection: document.getElementById('payment-method-selection'),
            orderDetailsInForm: document.getElementById('order-details-in-form'),
            testimonialsFull: document.getElementById('testimonials-full'),
            faqFull: document.getElementById('faq-full'),
            policyFull: document.getElementById('policy-full'),
            orderForm: document.getElementById('orderForm'),
            submitBtn: document.getElementById('submit-btn'),
            notifBox: document.getElementById('notifBox'),
            notifName: document.querySelector('#notifBox .notif-name'),
            detailsModal: document.getElementById('detailsModal'),
            detailsModalContent: document.getElementById('detailsModalContent'),
        };

        // --- CONFIGURATION ---
        const uniqueCode = Math.floor(Math.random() * (500 - 100 + 1)) + 100;
        let countdownInterval;
        let expiryTime;
        let currentOrderDetails = {};
        
        const product = {
            id: 'preset_pack',
            name: "4000+ Preset Lightroom Pack",
            price: 49000,
            normalPrice: 199000, // Contoh harga normal
            title: "4000+ PRESET LIGHTROOM",
            priceDisplay: `Rp49.000`,
            logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b6/Adobe_Photoshop_Lightroom_CC_logo.svg/1200px-Adobe_Photoshop_Lightroom_CC_logo.svg.png',
            description: "Ubah foto biasa jadi luar biasa dengan satu klik.",
            features: [
                "<strong>4000+ Preset Premium:</strong> Siap pakai untuk mengubah foto Anda menjadi karya profesional.",
                "<strong>Untuk Mobile & Desktop:</strong> Kompatibel dengan Lightroom Mobile (Android/iOS) dan Lightroom Classic (PC/Mac).",
                "<strong>Beragam Kategori:</strong> Termasuk preset untuk travel, kuliner, potret, wedding, alam, dan banyak lagi.",
                "<strong>Instalasi Sangat Mudah:</strong> Disertai panduan video langkah demi langkah yang jelas.",
                "<strong>Sekali Bayar Seumur Hidup:</strong> Tidak ada biaya bulanan atau tahunan tersembunyi.",
                "<strong>Update Gratis:</strong> Dapatkan preset baru secara berkala tanpa biaya tambahan.",
                "<strong>Cocok untuk Pemula & Pro:</strong> Ubah foto Anda dengan satu klik, tanpa perlu keahlian editing.",
                "<strong>Dukungan Penuh:</strong> Siap membantu jika Anda mengalami kendala saat instalasi."
            ],
            testimonials: [
                "https://down-id.img.susercontent.com/file/20c85b67e572cc2b2510893daf3db0c7.webp",
                "https://down-id.img.susercontent.com/file/9282ad76c267c41e28fc2ad8d4a497b5.webp",
                "https://down-id.img.susercontent.com/file/a777654f3989cf391fb6daecf95edbeb.webp",
                "https://down-id.img.susercontent.com/file/id-11134103-7r98t-llr1ioqle8x780.webp"
            ]
        };
        
        // --- NEW PAYMENT ACCOUNTS ---
        const paymentAccounts = {
            qris: {
                displayName: 'QRIS',
                accountHolder: 'Epay',
                number: '00020101021126610016ID.CO.SHOPEE.WWW01189360091800223157700208223157700303UMI51440014ID.CO.QRIS.WWW0215ID10254270621910303UMI5204481453033605802ID5904Epay6013JAKARTA PUSAT61051061062070703A0163042F15',
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Logo_QRIS.svg/163px-Logo_QRIS.svg.png',
                type: 'qris',
                category: 'QRIS'
            },
            cimb: { 
                displayName: 'Cimb Niaga',
                accountHolder: 'Octo Pay - 6289510639366', 
                number: '6289510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/CIMB_Niaga_logo.svg/330px-CIMB_Niaga_logo.svg.png', 
                type: 'va',
                category: 'Bank Transfer'
            },
            bca_va: { 
                displayName: 'BCA Virtual Account', 
                accountHolder: 'Epayment', 
                number: '39358089510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/330px-Bank_Central_Asia.svg.png', 
                type: 'va',
                category: 'Bank Transfer'
            },
            gopay: { 
                displayName: 'Gopay', 
                accountHolder: 'Gopay 6289510639366', 
                number: '089510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Gopay_logo.svg/320px-Gopay_logo.svg.png', 
                type: 'ewallet',
                category: 'E-Wallet'
            },
            dana: { 
                displayName: 'DANA', 
                accountHolder: 'DNID089510639366', 
                number: '089510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/Logo_dana_blue.svg/330px-Logo_dana_blue.svg.png', 
                type: 'ewallet',
                category: 'E-Wallet'
            },
            ovo: { 
                displayName: 'OVO', 
                accountHolder: 'OVO Epayment', 
                number: '089510639366', 
                logo: 'https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Logo_ovo_purple.svg/330px-Logo_ovo_purple.svg.png', 
                type: 'ewallet',
                category: 'E-Wallet'
            }
        };

        // --- TEMPLATE FUNCTIONS ---
        const getProductInfoHTML = (pkg) => {
            return `
            <div class="product-info-card">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                    <div class="text-center mb-4 md:mb-0 flex-grow">
                        <div class="flex justify-center"><img alt="Logo ${pkg.name}" class="h-12 w-auto" src="${pkg.logo}"></div>
                        <h1 class="text-2xl font-bold text-gray-800 mt-3">${pkg.title}</h1>
                        <p class="text-md text-gray-600">${pkg.description}</p>
                    </div>
                    <div class="text-center md:text-right mt-4 md:mt-0 md:pl-4">
                        <div class="text-4xl font-bold" style="color: var(--lightroom-blue);">${pkg.priceDisplay}</div>
                        <p class="text-gray-500 text-sm mt-1">Sekali Bayar untuk Akses Selamanya</p>
                    </div>
                </div>
            </div>`;
        }

        const getFeaturesHTML = (pkg) => {
            return `<div class="bg-gray-50 p-6 rounded-xl border border-gray-200">
                <h3 class="text-lg font-bold mb-4 text-gray-800">Yang Anda Dapatkan:</h3>
                <ul class="space-y-4">${pkg.features.map((f, index) => `<li class="flex items-start"><i class="fas fa-check-circle mt-1 mr-3" style="color: var(--lightroom-blue);"></i><span class="text-gray-600">${f}</span></li>`).join('')}</ul>
            </div>`;
        }
        
        const getPaymentMethodsHTML = (accounts) => {
            const groupedAccounts = {};
            for (const key in accounts) {
                const account = accounts[key];
                if (!groupedAccounts[account.category]) {
                    groupedAccounts[account.category] = [];
                }
                groupedAccounts[account.category].push({ key, ...account });
            }

            let html = `<h2 class="text-xl font-bold mb-5 text-gray-800">3. Pilih Metode Pembayaran</h2>`;
            const categoryOrder = ['QRIS', 'Bank Transfer', 'E-Wallet'];

            for (const category of categoryOrder) {
                if (groupedAccounts[category]) {
                    html += `<h3 class="text-lg font-semibold text-gray-700 mt-6 mb-3">${category}</h3>`;
                    html += `<div class="rounded-lg overflow-hidden payment-group">`;

                    groupedAccounts[category].forEach((account, index) => {
                        const isFirst = index === 0 && category === 'QRIS';
                        const isLast = index === groupedAccounts[category].length - 1;
                        
                        html += `
                            <div class="${!isLast ? 'border-b border-gray-200' : ''}">
                                <input type="radio" id="${account.key}" name="payment-method" value="${account.key}" class="payment-radio" ${isFirst ? 'checked' : ''}>
                                <label for="${account.key}" class="payment-label">
                                    <div class="payment-logo-container">
                                        <img src="${account.logo}" alt="Logo ${account.displayName}" class="payment-logo">
                                    </div>
                                    <span class="font-medium text-gray-800 flex-grow">${account.displayName}</span>
                                    <span class="custom-radio-button"><span class="dot"></span></span>
                                </label>
                            </div>
                        `;
                    });
                    html += `</div>`;
                }
            }

            html += `
                <div class="bg-gray-100 p-3 mt-4 rounded-lg text-center text-sm text-gray-600">
                    Pembayaran ini diproses oleh Doku
                </div>
            `;

            return html;
        };

        const getOrderDetailsHTML = (pkg, totalPrice) => `
            <div class="mt-8 pt-6 border-t border-gray-200">
                 <h3 class="text-lg font-bold mb-4 text-gray-800">Rincian Pesanan</h3>
                 <div class="bg-gray-50 p-4 rounded-xl space-y-3 text-gray-600">
                     <div class="flex justify-between items-center">
                         <span>${pkg.name}</span>
                         <div class="text-right">
                             <span class="font-medium text-gray-800">${formatCurrency(pkg.price)}</span>
                         </div>
                     </div>
                     <div class="flex justify-between">
                         <span>Kode Unik</span>
                         <span class="font-medium text-gray-800">${formatCurrency(uniqueCode)}</span>
                     </div>
                     <hr class="my-2 border-gray-200">
                     <div class="flex justify-between font-bold text-lg text-gray-900">
                         <span>Total</span>
                         <span>${formatCurrency(totalPrice)}</span>
                     </div>
                 </div>
            </div>`;

        const getTestimonialsHTML = (pkg) => {
            let imagesHTML = pkg.testimonials.map(url => `
                <img src="${url}" alt="Testimoni Pelanggan" class="testimonial-image rounded-lg w-full h-auto object-cover aspect-[3/4]" onclick="openImageModal(event, this.src)">
            `).join('');

            return `
            <div>
                <h2 class="text-2xl font-bold text-center mb-8 text-gray-800">Testimoni Pelanggan Kami</h2>
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                    ${imagesHTML}
                </div>
            </div>`;
        }

        const getFaqHTML = () => `
             <div>
                 <h3 class="text-2xl font-bold mb-6 text-center text-gray-800">Pertanyaan Umum (FAQ)</h3>
                 <div class="space-y-2">
                     <details class="faq-item">
                         <summary>Apa itu Preset Lightroom?</summary>
                         <div class="faq-content">Preset Lightroom adalah filter siap pakai yang dirancang oleh para profesional untuk mengedit foto Anda secara instan dengan satu klik, memberikan tampilan yang konsisten dan menakjubkan.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Apakah bisa digunakan di HP (Android/iOS)?</summary>
                         <div class="faq-content">Tentu saja! Semua preset kami kompatibel dengan aplikasi Adobe Lightroom Mobile yang bisa diunduh gratis di perangkat Android dan iOS.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Apakah saya perlu langganan Adobe Lightroom?</summary>
                         <div class="faq-content">Tidak perlu. Untuk penggunaan di HP, Anda hanya memerlukan aplikasi Lightroom Mobile gratis. Untuk penggunaan di komputer (Desktop/Mac), Anda memerlukan versi berbayar dari Lightroom Classic atau CC.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Bagaimana cara install-nya?</summary>
                         <div class="faq-content">Sangat mudah! Setelah pembayaran, Anda akan menerima link download beserta video tutorial langkah demi langkah yang jelas untuk menginstal preset di HP maupun komputer.</div>
                     </details>
                     <details class="faq-item">
                         <summary>Apakah ada biaya bulanan atau tahunan?</summary>
                         <div class="faq-content">Tidak ada sama sekali. Ini adalah pembayaran sekali untuk akses selamanya. Anda juga akan mendapatkan update preset baru di masa mendatang secara gratis.</div>
                     </details>
                 </div>
             </div>
        `;
        
        const getPolicyHTML = () => `
            <div>
                <h3 class="text-2xl font-bold mb-4 text-center text-gray-800">Kebijakan & Ketentuan</h3>
                <div class="grid md:grid-cols-1 gap-8 text-sm text-gray-600">
                    <div class="mb-6">
                        <h4 class="text-lg font-bold mb-2 text-gray-800">Kebijakan Pembelian</h4>
                        <p class="mb-4">Produk yang Anda beli adalah produk digital yang akan dikirimkan melalui link download ke email Anda. Karena sifatnya yang digital, produk yang sudah dibeli tidak dapat dikembalikan atau ditukar (non-refundable). Namun, kami memberikan garansi bantuan penuh jika Anda mengalami kendala saat proses instalasi.</p>
                    </div>
                    <div>
                        <h4 class="text-lg font-bold mb-2 text-gray-800">Syarat & Ketentuan</h4>
                        <p class="mb-4">Dengan melakukan pembelian, Anda setuju untuk tidak menjual kembali, mendistribusikan, atau membagikan file preset ini kepada pihak lain. Satu lisensi pembelian berlaku untuk satu pengguna.</p>
                    </div>
                </div>
            </div>
        `;

        // --- FUNCTIONS ---
        function formatCurrency(value) {
            return `Rp${value.toLocaleString('id-ID', { minimumFractionDigits: 0 })}`;
        }

        function getIndonesianTimezone() {
            const offset = new Date().getTimezoneOffset() / -60;
            if (offset === 7) return 'WIB';
            if (offset === 8) return 'WITA';
            if (offset === 9) return 'WIT';
            const sign = offset > 0 ? '+' : '-';
            const hours = Math.abs(Math.floor(offset));
            return `GMT${sign}${String(hours).padStart(2, '0')}:00`;
        }

        function updateDisplay() {
            const pkg = product;
            const totalPrice = pkg.price + uniqueCode;

            const infoContainer = elements.productInfoFormTop;
            const featuresContainer = elements.featuresBeforeForm;

            // 1. Start fade-out
            infoContainer.style.opacity = '0';
            featuresContainer.style.opacity = '0';

            // 2. Wait for fade-out to finish, then update content and fade-in
            setTimeout(() => {
                // Update the HTML for the transitioning parts
                infoContainer.innerHTML = getProductInfoHTML(pkg);
                featuresContainer.innerHTML = getFeaturesHTML(pkg);

                // Update other parts that don't need transition
                elements.paymentMethodSelection.innerHTML = getPaymentMethodsHTML(paymentAccounts);
                elements.orderDetailsInForm.innerHTML = getOrderDetailsHTML(pkg, totalPrice);
                elements.testimonialsFull.innerHTML = getTestimonialsHTML(pkg);
                elements.faqFull.innerHTML = getFaqHTML();
                elements.policyFull.innerHTML = getPolicyHTML();

                // 3. Start fade-in
                infoContainer.style.opacity = '1';
                featuresContainer.style.opacity = '1';
            }, 300); // Match CSS transition duration
        }

        function generateWaLink(formData, pkg, totalPrice, paymentMethodName, paymentId) {
            const pesanWA = `Halo, saya ingin konfirmasi pembayaran untuk pesanan:\n\n` +
                          `*ID Pembayaran:* ${paymentId}\n` +
                          `*Produk:* ${pkg.name}\n` +
                          `*Metode Pembayaran:* ${paymentMethodName}\n` +
                          `*Nama:* ${formData.get('nama')}\n` +
                          `*No. WhatsApp:* ${formData.get('whatsapp')}\n` +
                          `*Email:* ${formData.get('email')}\n` +
                          `*Total Transfer:* ${formatCurrency(totalPrice)}\n\n` +
                          `Saya sudah melakukan transfer. Mohon untuk segera diproses. Terima kasih.`;
            return `https://wa.me/6285602152097?text=${encodeURIComponent(pesanWA)}`;
        }

        function showPaymentInstructions(formData, pkg, totalPrice, paymentAccount, paymentId, paymentMethodKey) {
            window.scrollTo(0, 0); // Scroll to top
            
            // Store details for the modal
            currentOrderDetails = {
                pkg,
                totalPrice,
                paymentId,
                nama: formData.get('nama'),
                whatsapp: formData.get('whatsapp')
            };


            elements.mainContentContainer.parentElement.style.display = 'none';
            elements.footer.style.display = 'none';
            
            const waLink = generateWaLink(formData, pkg, totalPrice, paymentAccount.displayName, paymentId);
            
            let accountLabel = 'Nomor Virtual Account';
            let instructionAccordionHTML = '';
            let paymentDetailsBlock = '';
            let paymentDeadlineFormatted = '';

            // Set expiry time (e.g., 24 hours from now)
            expiryTime = new Date(new Date().getTime() + 24 * 60 * 60 * 1000);
            
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const datePart = expiryTime.toLocaleDateString('id-ID', dateOptions);
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            const timePart = expiryTime.toLocaleTimeString('id-ID', timeOptions).replace(/\./g, ':');
            const timezoneString = `(${getIndonesianTimezone()})`;
            paymentDeadlineFormatted = `${datePart} pukul ${timePart} ${timezoneString}`;


            if (paymentMethodKey === 'qris') {
                paymentDetailsBlock = `
                    <div class="text-center">
                        <div id="qrcodeContainer" class="bg-white p-2 rounded-lg border border-gray-200 w-full max-w-[250px] h-auto mx-auto my-4">
                            <div id="qrcode" class="flex justify-center items-center"></div>
                        </div>
                        <button id="downloadQrisButton" class="cta-button blue-button max-w-xs mx-auto">
                            Unduh QRIS
                        </button>
                        <p class="text-center text-sm text-gray-600 mt-4">Pindai QR Code di atas menggunakan aplikasi perbankan atau e-wallet Anda.</p>
                    </div>
                `;
            } else {
                 paymentDetailsBlock = `
                    <div class="mt-4">
                        <p class="text-sm text-gray-500">${accountLabel}</p>
                        <div class="flex justify-between items-center">
                            <p class="text-xl font-semibold text-gray-800 tracking-wider">${paymentAccount.number}</p>
                            <button onclick="copyToClipboard('${paymentAccount.number}', '${accountLabel}')" class="copy-button-text">Salin</button>
                        </div>
                    </div>
                `;
            }

            // --- REVISED INSTRUCTION LOGIC ---
            switch (paymentMethodKey) {
                case 'qris':
                    instructionAccordionHTML = `
                        <details class="payment-accordion" open><summary>Cara Bayar via QRIS</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi perbankan (m-banking) atau e-wallet Anda (GoPay, OVO, DANA, dll).</li>
                            <li>Pilih menu <strong>Bayar</strong>, <strong>Scan QR</strong>, atau <strong>QRIS</strong>.</li>
                            <li>Pindai (scan) kode QR yang ditampilkan di atas.</li>
                            <li>Pastikan nama merchant dan nominal pembayaran sudah sesuai.</li>
                            <li>Masukkan PIN Anda untuk menyelesaikan transaksi.</li>
                            <li>Simpan bukti pembayaran.</li>
                        </ol></div></details>
                    `;
                    break;
                case 'bca_va':
                    instructionAccordionHTML = `
                        <details class="payment-accordion"><summary>ATM BCA</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Masukkan Kartu ATM BCA & PIN Anda.</li>
                            <li>Pilih menu <strong>Transaksi Lainnya > Transfer > Ke Rekening BCA Virtual Account</strong>.</li>
                            <li>Masukkan nomor virtual account: <strong>${paymentAccount.number}</strong>.</li>
                            <li>Pastikan detail pembayaran (No. VA, Nama, Total Tagihan) sudah sesuai.</li>
                            <li>Masukkan jumlah transfer sesuai Total Tagihan, lalu ikuti instruksi untuk menyelesaikan transaksi.</li>
                            <li>Simpan struk sebagai bukti pembayaran.</li>
                        </ol></div></details>
                        <details class="payment-accordion"><summary>m-BCA (BCA Mobile)</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Login ke aplikasi BCA Mobile dan pilih menu <strong>m-BCA</strong>.</li>
                            <li>Pilih <strong>m-Transfer > BCA Virtual Account</strong>.</li>
                            <li>Masukkan nomor virtual account: <strong>${paymentAccount.number}</strong>.</li>
                            <li>Konfirmasi detail pembayaran dan masukkan PIN m-BCA Anda.</li>
                            <li>Simpan notifikasi yang muncul sebagai bukti pembayaran.</li>
                        </ol></div></details>
                        <details class="payment-accordion"><summary>Internet Banking BCA</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Login ke situs KlikBCA dan pilih menu <strong>Pembayaran Tagihan > Pembayaran > BCA Virtual Account</strong>.</li>
                            <li>Masukkan nomor virtual account pada kolom kode bayar.</li>
                            <li>Pastikan detail pembayaran sudah sesuai, lalu masukkan password dan mToken Anda.</li>
                            <li>Simpan struk pembayaran sebagai bukti.</li>
                        </ol></div></details>
                    `;
                    break;
                default:
                     instructionAccordionHTML = `
                        <details class="payment-accordion" open><summary>Instruksi Umum</summary><div class="payment-accordion-content"><ol class="space-y-2">
                            <li>Buka aplikasi perbankan atau e-wallet Anda.</li>
                            <li>Pilih menu transfer atau pembayaran.</li>
                            <li>Masukkan detail pembayaran yang tertera di atas.</li>
                            <li>Pastikan nominal transfer sesuai dengan total pembayaran hingga digit terakhir.</li>
                            <li>Selesaikan transaksi dan simpan bukti pembayaran Anda.</li>
                        </ol></div></details>
                      `;
            }

            const paymentViewHTML = `
                <div class="payment-header">
                    <h2 class="text-lg font-semibold">Selesaikan Pembayaran</h2>
                    <div class="countdown-timer" id="countdown-timer-display"></div>
                </div>
                <div class="max-w-lg mx-auto">
                    <div class="p-4">
                        <div class="payment-card">
                            <h3 class="font-bold text-lg text-gray-800">Ringkasan Transaksi</h3>
                            <div class="flex justify-between items-center mt-2 text-sm text-gray-600">
                                <span>Nomor Invoice: ${paymentId}</span>
                                <a href="#" onclick="showDetailsModal(event)" class="font-semibold" style="color: var(--lightroom-blue);">Lihat detail</a>
                            </div>
                            <hr class="my-4 border-gray-200">
                            <p class="text-sm text-gray-600">Total Pembayaran</p>
                            <div class="flex items-center">
                                <p class="text-2xl font-bold text-gray-800">${formatCurrency(totalPrice)}</p>
                                <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="copy-button-text"><i class="far fa-copy"></i></button>
                            </div>
                        </div>
                        <div class="payment-card">
                            <h3 class="font-bold text-lg text-gray-800">Silahkan Bayar ke</h3>
                            <div class="flex justify-between items-start mt-4">
                                <div>
                                    <p class="text-sm text-gray-500">${paymentAccount.displayName}</p>
                                    <p class="font-semibold text-gray-800">${paymentAccount.accountHolder}</p>
                                </div>
                                <div class="payment-logo-container">
                                    <img src="${paymentAccount.logo}" alt="Logo ${paymentAccount.displayName}" class="payment-logo">
                                </div>
                            </div>
                            ${paymentDetailsBlock}
                            <div class="mt-6">
                                <p class="text-sm text-gray-500">Bayar Sebelum</p>
                                <p class="font-semibold text-gray-800">${paymentDeadlineFormatted}</p>
                            </div>
                            <a href="${waLink}" target="_blank" class="block mt-6">
                               <button class="confirm-button-outlined">Konfirmasi Pembayaran</button>
                            </a>
                        </div>
                        <div class="payment-card">
                            <h3 class="font-bold text-lg text-gray-800">Cara Membayar</h3>
                            <div class="mt-2">
                                ${instructionAccordionHTML}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            elements.paymentInstructionContainer.innerHTML = paymentViewHTML;
            startCountdown();

            // Generate QR Code if applicable
            if (paymentMethodKey === 'qris') {
                setTimeout(() => {
                    const qrcodeContainer = document.getElementById('qrcode');
                    if(qrcodeContainer) {
                        const qrisStatic = paymentAccount.number;
                        const qrisDinamis = createDynamicQrisString(qrisStatic, { nominal: totalPrice });
                        qrcodeContainer.innerHTML = ''; // Clear previous QR
                        QRCode.toCanvas(qrisDinamis, {
                            width: 250, margin: 1, errorCorrectionLevel: 'H'
                        }, (err, canvas) => {
                            if (err) { console.error("QR Code generation error:", err); return; }
                            canvas.style.width = "100%";
                            canvas.style.height = "auto";
                            qrcodeContainer.appendChild(canvas);
                            
                            // Add download functionality
                            document.getElementById('downloadQrisButton').addEventListener('click', () => {
                                const link = document.createElement('a');
                                link.download = `QRIS-PresetPro-${paymentId}.png`;
                                link.href = canvas.toDataURL("image/png");
                                link.click();
                            });
                        });
                    }
                }, 100);
            }
        }

        async function handleFormSubmit() {
            // 1. Validate Form
            const formData = new FormData(elements.orderForm);
            const nama = formData.get('nama').trim();
            const whatsapp = formData.get('whatsapp').trim();
            const email = formData.get('email').trim();
            const paymentMethodKey = formData.get('payment-method');

            if (!nama || !whatsapp || !email || !paymentMethodKey) {
                showInfoModal('Data Belum Lengkap', 'Mohon lengkapi semua data yang diperlukan sebelum melanjutkan.');
                return;
            }

            // 2. Set Loading State
            elements.submitBtn.disabled = true;
            elements.submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Memproses...';

            // 3. Prepare Data
            const pkg = product;
            const totalPrice = pkg.price + uniqueCode;
            const paymentAccount = paymentAccounts[paymentMethodKey];
            const now = new Date();
            const paymentId = `INV-PRESET-${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}${String(totalPrice).slice(-3)}`;

            // 4. Submit to Static Forms
            let submissionSuccess = false;
            try {
                // Construct the follow-up message with bolding
                let paymentDetailsForWa = `\n*- Metode:* ${paymentAccount.displayName}`;
                // Hapus nomor/data QRIS dari pesan WA
                if (paymentMethodKey !== 'qris') {
                    paymentDetailsForWa += `\n*- Nomor:* ${paymentAccount.number}`;
                }
                paymentDetailsForWa += (paymentAccount.accountHolder ? `\n*- Atas Nama:* ${paymentAccount.accountHolder}` : ``);

                const followUpMessage = `Halo kak ${nama},\n\nTerima kasih telah memesan *${pkg.name}*.\n\nBerikut adalah rincian pembayaran untuk pesanan Anda:\n- Nomor Invoice: ${paymentId}\n- Total Pembayaran: *${formatCurrency(totalPrice)}*\n\nMohon segera selesaikan pembayaran Anda. Rinciannya adalah sebagai berikut:${paymentDetailsForWa}\n\n*Penting:* Mohon transfer sesuai dengan jumlah total di atas (termasuk kode unik) agar pesanan Anda dapat kami proses secara otomatis.\n\nSetelah transfer, silakan balas pesan ini untuk konfirmasi.\n\nTerima kasih`;
                
                // Format WhatsApp number
                const formattedWhatsapp = whatsapp.startsWith('0') ? '62' + whatsapp.substring(1) : whatsapp;
                const followUpLink = `https://wa.me/${formattedWhatsapp}?text=${encodeURIComponent(followUpMessage)}`;

                const formDataForStaticForms = {
                    apiKey: 'sf_195b5fj92dge8l9b391mng1g',
                    replyTo: email,
                    honeypot: formData.get('honeypot'),
                    name: nama,
                    email: email,
                    whatsapp: whatsapp,
                    '$Nomor Invoice': paymentId,
                    '$Produk': pkg.name,
                    '$Metode Pembayaran': paymentAccount.displayName,
                    '$Total Transfer': formatCurrency(totalPrice),
                    '$Link Follow Up WA': followUpLink // Add the follow-up link
                };

                const response = await fetch('https://api.staticforms.xyz/submit', {
                    method: 'POST',
                    body: JSON.stringify(formDataForStaticForms),
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (response.ok) {
                    submissionSuccess = true;
                } else {
                    console.error("Static Forms server error:", response.status, await response.text());
                }

            } catch (e) {
                console.error("Network error during form submission:", e);
            }
            
            // 5. Restore Button State
            elements.submitBtn.disabled = false;
            elements.submitBtn.innerHTML = 'Beli Sekarang';

            // 6. Update UI based on submission result
            if (submissionSuccess) {
                showPaymentInstructions(formData, pkg, totalPrice, paymentAccount, paymentId, paymentMethodKey);
            } else {
                showInfoModal('Pengiriman Gagal', 'Maaf, terjadi kesalahan saat mengirim data Anda. Silakan coba lagi.');
            }
        }
        
        // --- NEW: Countdown Timer Function ---
        function startCountdown() {
            const countdownElement = document.getElementById('countdown-timer-display');
            if (!countdownElement || !expiryTime) return;

            const interval = setInterval(() => {
                const now = new Date().getTime();
                const distance = expiryTime - now;

                if (distance < 0) {
                    clearInterval(interval);
                    countdownElement.innerHTML = "Waktu Habis";
                    return;
                }

                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                countdownElement.innerHTML = `
                    <div class="countdown-item">
                        <span class="countdown-number">${String(hours).padStart(2, '0')}</span> Jam
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${String(minutes).padStart(2, '0')}</span> Menit
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${String(seconds).padStart(2, '0')}</span> Detik
                    </div>
                `;
            }, 1000);
        }

        // --- NOTIFICATION FUNCTIONS ---
        const FIRST_NAMES = [ "Budi Santoso", "Ayu", "Rahmat", "Citra Dewi Kusuma", "Bayu Pratama", "Lina", "Wulan", "Adi", "Farhan Syahputra", "Hendra Wijaya", "Nana Puspita Dewi", "Joko", "Mega Sari", "Gilang Pramana Putra", "Sari", "Dedi", "Eka Suryani", "Teguh", "Putri Lestari Ayu", "Andi", "Bagus Wijaya", "Ilham Saputra Nugraha", "Rizal", "Mira Astuti", "Puspita", "Hari", "Tri Saputra", "Cahya Pratama", "Surya Darmawan Putra", "Wahyu Ramadhan", "Agus", "Indra Permana", "Linda", "Fajar Mahendra Saputra", "Yusuf", "Pramono Adi Nugroho", "Sinta Dewi", "Bima Pratama", "Dian", "Hasan Basri", "Nurul Aini", "Arif Budiman", "Feri", "Lukman Hakim", "Rangga", "Rini Anggraini Putri", "Tono", "Hadi Prasetyo", "Elisa Purnama", "Anisa Rahma", "Gunawan", "Melati", "Bagus Prasetyo Ramadhan", "Septi Amelia", "Cindy Amelia", "Windi Saputri", "Galih Pratama", "Evi", "Putra", "Slamet Riyadi", "Latif Hidayat", "Gita Puspita", "Darmawan", "Maya", "Erik Saputra Pratama", "Jani", "Jefri Maulana", "Bella Sari", "Maulana", "Novi Andriana Lestari", "Fajar Nugroho", "Taufik Hidayat", "Prasetyo", "Samsul", "Agung", "Endang", "Indah", "Hana Pertiwi", "Mirna", "Yulia", "Panca", "Niken", "Rio", "Adi Putra Ramadhan", "Ganda", "Wahida", "Robby Saputra", "Halim", "Firman Saputra", "Berlian Putra", "Ari", "Joko Setiawan", "Mustika", "Bahar", "Mega", "Erlangga", "Sofyan", "Doni", "Fatimah", "Dian Purnama Sari", "Rama", "Imam Saputra", "Johan", "Gusman", "Lintang", "Nabila", "Beni", "Purnama", "Murni", "Malik", "Nurlan", "Doni Saputra", "Lastri", "Berlinda", "Rasyid", "Tari", "Nia", "Tirta", "Juli Andriani", "Lutfi", "Suci", "Arman", "Yani", "Citra Ayu", "Harto", "Rangga Pratama", "Febrina", "Indra Gunawan Saputra", "Tomi", "Sutrisno", "Risma", "Jihan Ayu Pratiwi", "Lestari", "Dewi Kusuma", "Fahmi", "Rifki", "Wira", "Putra Wijaya", "Beni Setiawan", "Asep", "Gerry", "Prasetia", "Euis", "Latif", "Pajar", "Rahmat Hidayat", "Rudi", "Tika", "Danu", "Hesti", "Syahrul", "Anwar", "Miranti", "Nuraini", "Nurman", "Eman Kurnia", "Nirmala", "Hari Susanto", "Taufan", "Tono Prabowo", "Bayu Saputra Nugroho", "Darma", "Nurlaila", "Hafid", "Mustofa", "Elok", "Gunarto", "Novi", "Lasman", "Jamaludin", "Andi Wijaya Putra", "Herman", "Mila", "Wibowo", "Prayitno", "Adi Saputra", "Jamal", "Irfan", "Iskandar", "Yudha", "Lutris", "Samsul Hidayat", "Heru", "Bagus", "Rudianto", "Nanda Putri", "Laila Rahma", "Frans", "Hilda", "Cahya", "Rudi Pratama", "Setiawan", "Rangga Saputra", "Puspa", "Doni Prasetyo", "Nurul", "Febri", "Mega Sari Lestari", "Suyatno", "Tomiadi", "Fikri", "Lani", "Intan", "Johan Saputra", "Iwan", "Berliano", "Ilham", "Teddy", "Lani Puspita", "Eka Putri Andayani", "Hani", "Adi Wijaya", "Adit", "Dicky", "Gopal", "Pramono", "Gunadi", "Gilang", "Joko Prayitno Adi", "Mira", "Puspita Sari", "Maulana Hakim", "Putri Ayu Lestari", "Malik Prasetyo", "Toriq", "Joni", "Gilang Pratama", "Bagus Wijaya Putra", "Berlian", "Wandi", "Nurman Saputra", "Fajarudin", "Lutfi Pratama", "Citra", "Nanda", "Laras", "Tuti", "Yani Pratiwi", "Gusman Saputra", "Rangga Putra", "Prasetiawan", "Ismail", "Heri", "Adi Nugroho", "Putri", "Prasetyo Adi", "Dona", "Gani", "Jihan", "Puspita Dewi", "Rizal Maulana", "Mahendra", "Ayu Pratiwi", "Rangga Setiawan", "Lina Sari", "Fani", "Adi Wijaya Putra", "Sari Melati", "Andri", "Bima", "Teguh Santoso Adi", "Fajar", "Wulan Dewi", "Rama Pratama", "Nana", "Farhan", "Dion", "Melati Pertiwi", "Adi Putra", "Joko Santoso", "Doni Setiawan", "Lintang Pertiwi", "Septi", "Gopal Pramana", "Tomi Pratama", "Rio Nugraha", "Cindy", "Hafid Saputra", "Hendra", "Niken Lestari", "Rangga Nugroho", "Putri Ayu", "Sofyan Hidayat", "Robby", "Bima Saputra", "Indra", "Adi Kurniawan", "Nanda Saputra", "Gilang Saputra", "Wahyu", "Puspita Ayu", "Rudi Hartono", "Wulan Dewi Pertiwi", "Ayu Pratiwi Lestari", "Tono Adi", "Dedi Kurniawan", "Prasetyo Ramadhan", "Adi Setiawan", "Mira Lestari", "Farhan Syahputra Adi", "Nurul Hidayah", "Sari Anggraini", "Bayu", "Eman", "Putra Adi Nugroho", "Lestari Ayu", "Bambang", "Rangga Hidayat", "Mega Putri", "Adi Nugraha", "Anisa", "Siska", "Wandi Putra", "Fajar Saputra", "Gunawan Pratama", "Heri Setiawan", "Arif", "Ilham Nugroho", "Bagus Pratama", "Erlangga Putra", "Rian", "Pandu", "Tari Ayu", "Hendro", "Risma Ayu", "Adi Pratama", "Septi Ayu", "Bambang Santoso", "Lukman", "Gani Saputra", "Hasan", "Feri Kurniawan", "Tirta", "Bambang Prasetyo", "Pajar Saputra", "Arman Putra", "Murni Ayu", "Hafiz", "Euis Sari", "Bayu Nugroho", "Tomi Saputra", "Gerry Pratama", "Arif Prasetyo", "Johan Putra", "Hafid Nugraha", "Nabila Pertiwi", "Latif Saputra", "Ari Saputra", "Rio Saputra", "Tono Saputra", "Wandi Saputra", "Mahendra Putra", "Ilham Pratama", "Putri Dewi", "Adi Lestari", "Rangga Maulana", "Bayu Hidayat", "Fani Puspita", "Taufik", "Bagus Saputra", "Novi Puspita", "Rahmat Hidayatullah Putra", "Prayitno Saputra", "Adi Ramadhan", "Bayu Wijaya", "Gilang Nugraha", "Rangga Prasetyo", "Putra Purnama", "Wulan Pertiwi", "Adi Wijaya Ramadhan", "Budi", "Rian Pratama", "Samsul Nugroho", "Wahyu Saputra", "Teguh Prasetyo", "Fikri Nugraha", "Rizki Pratama" ];
        
        function getRandomElement(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
        function generateRandomName() { return `${getRandomElement(FIRST_NAMES)}`; }
        
        function showNextNotification() {
            if (!elements.notifBox || !elements.notifName) return;
            elements.notifName.textContent = generateRandomName();
            elements.notifBox.classList.remove('show');
            void elements.notifBox.offsetWidth; // Trigger reflow
            elements.notifBox.classList.add('show');
        }

        function scheduleNextNotification() {
            const randomDelay = Math.floor(Math.random() * 10000) + 8000;
            setTimeout(() => {
                showNextNotification();
                scheduleNextNotification();
            }, randomDelay);
        }

        // --- INITIALIZATION ---
        elements.currentYear.textContent = new Date().getFullYear();
        elements.submitBtn.addEventListener('click', handleFormSubmit);

        updateDisplay();
        
        if (elements.notifBox && elements.notifName) {
            setTimeout(scheduleNextNotification, 6000);
        }
        
        // --- REVISED: DETAILS MODAL LOGIC ---
        function getDetailsModalHTML(details) {
            const { pkg, totalPrice, paymentId, nama, whatsapp } = details;
            return `
                <div class="details-modal-header">
                    <h3>Ringkasan Transaksi</h3>
                    <button class="details-modal-close" onclick="closeDetailsModal()">&times;</button>
                </div>
                <div class="details-modal-body">
                    <p class="text-sm text-gray-500 mb-4">Nomor Invoice: ${paymentId}</p>
                    <div class="text-center mb-6">
                        <p class="text-sm text-gray-600">Total Pembayaran</p>
                        <div class="flex items-center justify-center">
                            <p class="text-3xl font-bold text-gray-800">${formatCurrency(totalPrice)}</p>
                            <button onclick="copyToClipboard('${totalPrice}', 'Total Pembayaran')" class="copy-button-text"><i class="far fa-copy"></i></button>
                        </div>
                    </div>
                    <div class="space-y-4 border-t border-b border-gray-200 py-4 mb-4">
                        <div>
                            <div class="flex justify-between text-sm">
                                <span>${pkg.name}</span>
                                <span class="font-medium">${formatCurrency(pkg.price)}</span>
                            </div>
                            <div class="flex justify-between text-sm text-gray-500">
                                <span>1x ${formatCurrency(pkg.price)}</span>
                            </div>
                        </div>
                         <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Kode Unik</span>
                            <span class="font-medium">${formatCurrency(uniqueCode)}</span>
                        </div>
                    </div>
                    <div class="space-y-2 mb-6">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Subtotal</span>
                            <span>${formatCurrency(totalPrice)}</span>
                        </div>
                        <div class="flex justify-between font-bold">
                            <span>Total Pembayaran</span>
                            <span>${formatCurrency(totalPrice)}</span>
                        </div>
                    </div>
                    <div class="border-t border-gray-200 pt-4">
                        <h4 class="font-semibold mb-3 text-sm">Informasi Pelanggan</h4>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <p class="text-gray-500">Nama</p>
                                <p class="font-medium">${nama}</p>
                            </div>
                            <div>
                                <p class="text-gray-500">Nomor Telepon</p>
                                <p class="font-medium">${whatsapp}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        window.showDetailsModal = function(event) {
            event.preventDefault();
            elements.detailsModalContent.innerHTML = getDetailsModalHTML(currentOrderDetails);
            elements.detailsModal.style.display = 'flex';
            elements.detailsModalContent.classList.remove('is-closing');
            elements.detailsModalContent.classList.add('is-open');
        }

        window.closeDetailsModal = function() {
            elements.detailsModalContent.classList.remove('is-open');
            elements.detailsModalContent.classList.add('is-closing');
            setTimeout(() => {
                elements.detailsModal.style.display = 'none';
            }, 300); // Match animation duration
        }


    });

    // --- GLOBAL HELPER FUNCTIONS ---
    const infoModal = document.getElementById('infoModal');
    
    function showInfoModal(title, message) {
        if (!infoModal) return;
        infoModal.querySelector('#modalTitle').textContent = title;
        infoModal.querySelector('#modalMessage').textContent = message;
        infoModal.style.display = 'flex';
    }

    function closeInfoModal() {
        if (!infoModal) return;
        infoModal.style.display = 'none';
    }

    window.onclick = function(event) {
        if (event.target == infoModal) { closeInfoModal(); }
        if (event.target == document.getElementById('detailsModal')) { closeDetailsModal(); }
        if (event.target == document.getElementById('imageModal')) { closeImageModal(); }
    }

    function copyToClipboard(text, entityName) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            showInfoModal('Berhasil Disalin!', `${entityName} telah disalin ke clipboard.`);
        } catch (err) {
            showInfoModal('Gagal!', 'Gagal menyalin. Silakan coba secara manual.');
        }
        document.body.removeChild(textArea);
    }
     function createDynamicQrisString(qris, { nominal }) {
        if (!qris) throw new Error('Parameter "qris" (string QRIS statis) dibutuhkan.');
        if (nominal === undefined) throw new Error('Parameter "nominal" dibutuhkan.');

        let qrisModified = qris.slice(0, -4).replace("010211", "010212");
        const nominalStr = String(Math.round(nominal)); // Pastikan nominal adalah integer
        const amountLength = nominalStr.length < 10 ? "0" + nominalStr.length : nominalStr.length.toString();
        const amountPart = "54" + amountLength + nominalStr;
        
        if (!qrisModified.includes("5802ID")) {
            throw new Error("Format string QRIS tidak dikenali (tidak ditemukan '5802ID').");
        }
        let finalQris = qrisModified.replace("5802ID", amountPart + "5802ID");
        const crc = toCRC16(finalQris);
        return finalQris + crc;
    }

    function toCRC16(input) {
        let crc = 0xFFFF;
        for (let i = 0; i < input.length; i++) {
            crc ^= input.charCodeAt(i) << 8;
            for (let j = 0; j < 8; j++) {
                crc = crc & 0x8000 ? (crc << 1) ^ 0x1021 : crc << 1;
            }
        }
        return (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
    }
    
    // --- Image Modal Functions ---
    const imageModal = document.getElementById('imageModal');
    const modalImg = document.getElementById("modalImage");

    window.openImageModal = function(event, src) {
        event.stopPropagation();
        imageModal.style.display = "flex";
        modalImg.src = src;
    }

    window.closeImageModal = function() {
        imageModal.style.display = "none";
    }

    </script>

</body>
</html>
